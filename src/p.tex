% !TeX root =./x2.tex
% !TeX program = pdfpLaTeX
\frontmatter
\let\originalthesection\thesection
\renewcommand{\thesection}{\alph{section}}

\chapter{数学以前の話}
%\chapter{注意など}
\section{注意}
このメモは随時追記, 修正する.
必ずしも末尾に追記するとは限らない.

講義で解説する順番と必ずしも一致しない.
また, 講義で解説する内容をすべてここにまとめるわけでもなく,
ここでまとめた内容をすべて講義で解説するわけでもない.

忙しくなった場合には,
このメモは
更新しない予定である.

\section{シラバス}
基礎数学A1(理学部数学科2年1学期)の講義ノートがベースになっているが,
必ずしも同一ではない.
基礎数学A1のシラバスに挙げた項目は以下の通り:
\begin{enumerate}
\item
  ベクトル空間，
\item 線形写像，
\item 行列式，
\item 固有値$\cdot$固有ベクトル,
\item 行列の対角化
\end{enumerate}

授業題目は, `本格的な線形代数学 その1'となっており,
基礎数学A1の後には, 基礎数学A2 (2年2学期)が開講される.
基礎数学A1およびそれに続く基礎数学A2を通して,
複素数体上のベクトル空間および線形写像の基礎理論と計算法を講義する.
また, 線形写像の行列による表現やそれによる固有値の計算法や
写像の性質を調べる方法を与える.
基礎数学A1では,
ベクトル空間，線形写像，行列式，固有値・固有ベクトル, 行列の対角化
を取り扱うこととなっており,
基礎数学A2では,
内積, 内積を用いる行列の対角化(正規行列),
ジョルダン標準形
を取り扱うこととなっている.
したがって,
ここでは, 
内積に関わることは,
基本的には扱わない.
例えば, 双対空間$V^\ast$は線形空間の例としては取り上げる可能性があるが,
有限次元ベクトル空間において$(V^\ast)^\ast$と$V$がcanonicalな同型をもつことなどは扱わない.
また, ジョルダン標準形に関すること(最小多項式の求め方など)なども,
基本的には扱わない.


1年生前期に開講される線形代数I
の履修を前提とする.
線形代数Iでは,
行列，連立１次方程式，基本変形，階数，行列式，逆行列，$2$次正方行列の対角化
がキーワードとして挙げられており,
以下が取り扱われている:
\begin{enumerate}
\item 行列：定義と演算（和・スカラ－倍・積），行列の転置
\item 連立１次方程式の理論：消去法, 掃き出し法，基本変形と基本行列
\item 行列の階数：基本変形と計算
\item 逆行列, 掃き出し法
\item 行列式：定義と基本的な性質
\item 余因子行列と余因子展開，クラメ－ルの公式
\item 2 x 2行列の固有値，固有ベクトル，対角化
\end{enumerate}
これらについては,
必要に応じて各自復習をしておくことを勧める.


一方,
1年生後期に開講される線形代数II
の履修は前提としない.
しかし,
1年生後期で開講される線形代数IIでも,
抽象ベクトル空間などが講義され,
内容が重なっている部分が多い.
復習をしておくと,
この講義の理解の助けになると思われる.

本講義のキーワードは以下の通り:
\begin{enumerate}
\item 線形空間
\item 線形写像, 同型写像
\item Ker Img
\item 双対空間, Hom
\item 部分空間
\item (剰余空間と準同型定理)
\item 生成系
\item 一次独立性
\item 基底
\item 次元 (次元の一意性)
\item 基底の延長定理
\item 次元定理
\item 和と共通部分
\item 内部直和, 外部直和
\item 表現行列, 基底の変換行列
\end{enumerate}

\section{参考書}
講義では教科書は特に指定しないが,
参考書を手元においておき,
講義の中での説明と,
参考書の記述を比べながら学習することを勧める.

参考書については,
線形代数学IIと内容が重複していることから,
線形代数学IIで指定されていた教科書等でも構わないし,
この講義に引き続いて後期に行われる
基礎数学A2で指定されている教科書等でも構わない.

%% このノートの末尾に挙げた参考文献のうち,
%% \cite{978-4-7806-0772-7}
%% はシラバスに教科書として挙げたものである.
%% \cite{978-4-7806-0164-0,978-4-535-78682-0}
%% はシラバスに参考書として挙げたものである.


\cite{978-4-535-78682-0}は大学の数学に関する講義全般について解説している本である.
講義を受ける上での注意や,
講義の前提となる集合や論理の知識についても解説がしてある.
本講義とは直接関係はないが,
図書館で借りるなどして一度最初の数章を読んでみることを勧める.

\section{講義で使われる見出し}
数学の講義を受け慣れていない人もいるかと思いますので,
簡単に講義の板書で使われる見出しについて説明します.

講義に出てくる言明には大きく分けて二つあります:
\begin{itemize}
 \item 証明が必要ではないもの
 \item 証明が必要なもの
\end{itemize}
また講義の板書では,
言明に見出しをつけることがしばしばあります.
以下では使われる見出しについて説明します.
\subsection{証明が必要ではない言明}
言葉の持つ意味を決めることが,
`定義'です.
つまり, ルールを決めるということです.
ルールを設定するということですので,
`定義'自身に証明は必要ではありません.

数学書では定義される用語をイタリック/太文字/下線で
書く習慣があります.
重要だからという理由で強調されているわけではありません.

Def/Definition/定義 などの見出しが使われます.

\subsection{証明が必要な言明}
証明をして真である確認する必要がある言明は,
`命題'と呼ばれます.
`主張' や `事実' と呼ぶこともあると思います.

講義では, 
気分や役割により次の様に分類することが多いと思います.
これらのうち, どの見出しを使うかというのは, 
かなり主観的です.
\begin{description}
\item[定理]
重要なもの, まとめ的なもの など 比較的重いものに使われます.

Thm/Theorem/定理  などの見出しを使います.

\item[補題]
他の命題を示すために使うものに使われます.

Lem/Lemma/補題  などの見出しを使います.

\item[系]
他からすぐ示すことができるものに使われます.

Cor/Corollary/系  などの見出しを使います.
\item[その他の命題]

Prop/Porposition/命題  などの見出しを使います.
\end{description}

\subsection{補足}
また見出しとしては次のようなものも使こともあります:
\begin{itemize}
 \item 
実例, 具体例 (`喩え'ではない) を述べる際に,
例/Example/E.g.\   などの見出しを使います.
\item
補足的なことを述べる際に,
注/Rem/Remark   などの見出しを使います.
\item
証明をする際に,
証明/Proof/$\because$などの見出しをつけて書き出すこともあります.
\end{itemize}
\tableofcontents


\renewcommand{\thesection}{\originalthesection}
\mainmatter

\chapter{線形代数以前の話}


\section{集合や論理について}

集合や論理についての基本的なことについては,
既知とする.
もしそれらについて不安な場合は,
高校の教科書の該当箇所や,
\cite{978-4-535-78682-0}
を参考に復習をすること.

記号や用語が異なる可能性があるので,
以下では簡単に基本的な用語などを説明する.

\subsection{集合}
集合とは何かということを説明するときには,
`もの'を集めてきたものを集合といい,
集合$X$に元$x$が属しているとき$x\in X$,
集合$X$に元$x$が属していないとき$x\not\in X$と書く
と説明されれることが多い.
言い換えると,
どんな$x$に対しても$x\in X$が命題であるとき,
$X$は集合であるといい,
$x\in X$の否定を$x\not\in X$と書くということである.
$x\in X$であるとき,
$x$は$X$の元であるとか,
$x$は$X$ の要素であるとか,
$x$は$X$に属するなどという.
代表的な数の集合に関して,
ここでは,
以下の記号を用いる:
\begin{itemize}
\item 複素数全体のなす集合を$\CC$とおく.
\item 実数全体のなす集合を$\RR$とおく.
\item 有理数全体のなす集合を$\QQ$とおく.
\item 整数全体のなす集合を$\ZZ$とおく.
\item 非負整数全体のなす集合を$\NN$とおく.
\end{itemize}
つまり,
`$x\in\CC$'は
`$x$は複素数である'
ということを意味する.
\begin{remark}
この講義では, 虚数単位を表すのに$\sqrt{-1}$という記号を用いる.
$i$は虚数単位ではなく単なる変数として使われる.
\end{remark}

\begin{definition}
$X$と$Y$を集合とする.
次の条件を満たすとき,
$X$は$Y$の部分集合であるといい, $X\subset Y$と書く:
\begin{align*}
a\in X \implies a\in Y.
\end{align*}
以下の条件を満たすとき,
$X$と$Y$は等しいといい$X=Y$と書く:
\begin{enumerate}
\item $X\subset Y$.
\item $Y\subset X$.
\end{enumerate}
$X\subset Y$かつ$X\neq Y$であることを,
$X\subsetneq Y$と書く.
\end{definition}
\begin{remark}
$X$と$Y$を集合とする.
このとき, 以下は同値:
\begin{enumerate}
\item $X=Y$.
\item $a\in X \iff a\in Y$
\end{enumerate}
\end{remark}
$x_1,x_2,\ldots, x_n$が元である集合を表すのに,
\begin{align*}
\Set{x_1,x_2,\ldots,x_n}
\end{align*}
の様に表記する.
つまり, 
\begin{align*}
x\in \Set{x_1,x_2,\ldots,x_n} \iff \text{$x_i=x$となる$i$が存在する}
\end{align*}
と定義する.
また, 条件$P(x)$を満たす元$x\in X$を集めた集合を表すのに,
\begin{align*}
\Set{x\in X|P(x)}
\end{align*}
の様に表記する.
つまり, 
\begin{align*}
x\in \Set{x\in X|P(x)} \iff \text{$x\in X$かつ$P(x)$を満たす}
\end{align*}
と定義する.
\begin{definition}
$X$, $Y$を集合とする.
このとき,
$X\cap Y$を次で定義する:
\begin{align*}
a\in X\cap Y \iff a\in X \text{ かつ } a\in Y.
\end{align*}
$X\cup Y$を次で定義する:
\begin{align*}
a\in X\cup Y \iff a\in X \text{ または } a\in Y.
\end{align*}
\end{definition}

集合$X_1, X_2,\ldots,X_n$を集めた集合を$\XXX$とする.
$\XXX$の各元はそれ自身が集合であるが,
要素が集合であることを強調するために,
このような集合のことを, 
集合族と呼ぶことがある.

集合族に対しても, 和集合や共通部分を考えることもある.
\begin{definition}
$\XXX$を集合族とする.
$\bigcap_{X\in \XXX}X$を
次で定義する:
\begin{align*}
a\in \bigcap_{X\in \XXX}X \iff \text{すべての$X\in \XXX$に対し, $a\in X$.}
\end{align*}
$\bigcup_{X\in \XXX}X$を
次で定義する:
\begin{align*}
a\in \bigcup_{X\in \XXX}X \iff \text{$a\in X$を満たす$X\in \XXX$が存在する.}
\end{align*}
\end{definition}

また, $X\subset Y$であるとき, $X$が$Y$よりも小さいと思い,
一番小さいものを考えたいときがある.
\begin{definition}
$\XXX$を集合族とする.
次の条件を満たすとき, $X$は$\XXX$で最小であるという:
\begin{align*}
A\in \XXX \implies X \subset A.
\end{align*}
次の条件を満たすとき, $X$は$\XXX$で極小であるという:
\begin{align*}
A\in \XXX,  A \subset X\implies A=X.
\end{align*}
\end{definition}
\begin{remark}
$X$は$\XXX$で最小であるというのは,
$X$が他のどの集合$A\in \XXX$よりも小さいということである.
$X$は$\XXX$で極小であるというのは,
$X$より小さな$A\in \XXX$が存在しないということである.
実数の大小と異なり,
集合$X$, $Y$に対しては,
$X\subset Y$も$Y\subset X$もどちらも成り立たないことがあるので,
最小と極小は異なる概念であることに注意する必要がある.
\end{remark}

\begin{definition}
$X_1,\ldots,X_n$が集合であるとき,
\begin{align*}
X_1\times \cdots \times X_n
=\Set{(x_1,\ldots,x_n)|x_1\in X_1,\ldots, x_n\in X_n}
\end{align*}
と定義し, $X_1,\ldots,X_n$の直積と呼ぶ.
\end{definition}

\begin{definition}
$X$を集合とする.
$X$に含まれる元の総数が整数であるとき,
$X$は有限集合であるという.
また, 元の総数を$\numof{X}$で表す.
有限集合ではないとき,
$X$は無限集合であるという.
\end{definition}
\subsection{写像}
$X$, $Y$を集合とする.
このとき写像とは何かを説明するとき,
$X$の元$x$に対して$Y$の元$f(x)$を対応させる`関数'$f$を
$X$から$Y$への写像と呼ぶと説明されることが多い.
言い換えると, $X$から$Y$の写像$f$は以下の条件を満たすことである:
\begin{enumerate}
\item どの$x\in X$に対しても$f(x)$が定まる.
\item どの$x\in X$に対しても, 常に$f(x)\in Y$である.
\item $x, x'\in X$かつ$x=x'$ならば$f(x)=f(x')$である.
\end{enumerate}
また, `$X$から$Y$への写像$f$' ということを表すのに,
`写像$f\colon X\to Y$'と書くこともある.
\begin{definition}
$X$, $Y$, $A$, $B$を集合とする.
以下の条件を満たすとき,
写像$\varphi\colon X\to Y$と写像$\psi\colon Y\colon A\to  B$
は等しいといい, $\varphi=\psi$と書く:
\begin{enumerate}
\item $X=A$.
\item $Y=B$.
\item $x\in X\implies \varphi(x)=\psi(x)$.
\end{enumerate}
\end{definition}

具体的な写像を与えるには,
その対応を書く必要がある.
例えば, $x$に対して$\sqrt{-1}x$を対応させる$\RR$から$\CC$への写像$\varphi$を表すのに.
\begin{align*}
\shazo{\varphi}{\RR}{\CC}
{x}{\sqrt{-1}x}
\end{align*}
の様に書くことが多い.
スペースが限られている場合などには,
\begin{align*}
\varphi\colon \RR \to \CC,\ x\mapsto \sqrt{-1}x
\end{align*}
とか,
\begin{align*}
\varphi\colon \RR\ni x\mapsto \sqrt{-1}x \in CC
\end{align*}
などと書くこともある.

\begin{remark}
$\NN$から$\ZZ$への写像$\varphi$
\begin{align*}
\shazo{\varphi}{\NN}{\ZZ}
{x}{2x-1}
\end{align*}
を考える.
このとき,
$\varphi(0)=1,\varphi(1)=3,\varphi(2)=5,\ldots$, 
つまり$\varphi(x)=2x+1$である.
この対応のそのものことを$\varphi$で表し, $\varphi$のことを写像と呼ぶ.
$\varphi(x)$は$x\in\NN$を代入して得られる$2x+1$という整数を表しており,
$\varphi(x)$は写像ではない.
\end{remark}
\begin{definition}
集合$X$を集合とする.
$x\in X$に対して$x$を対応させる写像を$\id_X$で表し,
$X$上の恒等写像と呼ぶ. つまり,
\begin{align*}
\shazo{\id_X}{X}{X}
{x}{x}
\end{align*}
である.
また, $Y$を$X$の部分集合とするとき,
$x\in Y$に対して$x\in X$を対応させる写像を,
$Y$から$X$への包含写像と呼ぶ.
\end{definition}

$X$, $Y$, $X'$, $Y'$を集合とし,
写像$\varphi\colon X\to Y$, $\psi\colon X\to Y$
について考える.
$x\in X$に対し$\varphi(x)\in Y$であるので,
$Y\subset X'$であるなら,
$\psi$に$f(x)$を代入することができる.
\begin{definition}
$X$, $Y$, $X'$, $Y'$を集合とし,
$Y\subset X'$とする.
写像$\varphi\colon X\to Y$, $\psi\colon X\to Y$に対し,
$\psi\circ\varphi$を次で定義する:
\begin{align*}
\shazo{\psi\circ\varphi}{X}{Y'}
{x}{\psi(\varphi(x))}.
\end{align*}
$\psi\circ\varphi$を$\varphi$と$\psi$の合成と呼ぶ.
\end{definition}
$A$, $B$, $B'$, $C$, $C'$, $D$という集合が
$B\subset B'$, $C\subset C'$を満たしているとき,
写像
$\phi\colon A\to B$,
$\psi\colon B'\to C$,
$\varphi\colon C'\to D$
の合成を考えることができる.
$\varphi\circ (\psi\circ \phi)$
と
$(\varphi\circ \psi)\circ \phi$
を考えることができるが, この2つは等しい.
そこでカッコを省略し
$\varphi \circ \psi \circ \phi$
と書く.
\begin{prop}
$X$から$Y$への写像$\varphi$に対し,
以下が成り立つ:
\begin{align*}
\varphi\circ\id_X&=\varphi.\\
\id_Y\circ\varphi&=\varphi.
\end{align*}
\end{prop}

\begin{definition}
$X$, $Y$を集合とする.
次の条件を満たすとき,
$\varphi\colon Y\to X$を$\psi\colon X\to Y$の逆写像と呼ぶ:
\begin{enumerate}
\item $\varphi\circ\psi =\id_X$.
\item $\psi\circ \varphi =\id_Y$.
\end{enumerate}
$\psi$の逆写像が存在するとき,
$\psi$は全単射であるという.
\end{definition}
$\psi\colon X\to Y$が全単射であるとき, その逆写像はただ一つに定まる.
つまり, $\varphi\colon Y\to X$と$\phi\colon Y\to X$とが,
\begin{align*}
\varphi\circ\psi &=\id_X, &
\psi\circ \varphi &=\id_Y \\
\phi\circ\psi &=\id_X, &
\psi\circ \phi &=\id_Y 
\end{align*}
を満たすなら,
$\varphi=\phi$である.
$\psi\colon X\to Y$が全単射であるとき, その逆写像を$\varphi^{-1}$で表す.
 


\begin{definition}
$X$, $Y$を集合とする.
次の条件を満たすとき,
$\varphi\colon X\to Y$は全射であるという:
\begin{enumerate}
\item $\Set{\varphi(x)|x\in X}=Y$.
\end{enumerate}
次の条件を満たすとき,
$\varphi\colon X\to Y$は単射であるという:
\begin{enumerate}
\item $x,x'\in X$,  $x\neq x'\implies \varphi(x)\neq \varphi(x')$.
\end{enumerate}
\end{definition}
\begin{prop}
写像$\varphi\colon X\to Y$
に対し, 以下は同値:
\begin{enumerate}
\item $\varphi$は全単射.
\item $\varphi$は全射かつ単射.
\end{enumerate}
\end{prop}

$X$を集合とする.
$X\times X$から$X$への写像のことを,
$X$上の$2$項演算と呼ぶことがある.
例えば, 整数の足し算$x+y$は,
\begin{align*}
\shazo{+}{\RR\times \RR}{\RR}
{(x,y)}{x+y}
\end{align*}
という写像である.
ここまでの写像は, 代入する際に$\varphi(x,y)$のように,
写像を表す記号の後ろに代入する元を書いたが,
$2$項演算の場合には, $x+y$の様に写像を表す記号の前後に代入するものを書くことも多い.
このような記法を中置記法と呼ぶ.

$X$, $Y$を集合とする.
$X\times Y$から$Y$への写像のことを,
$X$の$Y$への作用と呼ぶことがある.
この場合にも中置記法を用いることが多い.


\section{体}
$K$を集合とする.
$K$に四則演算(加減乗除)が定まっているとき,
$K$は
\defit{体}\footnote{タイと読む.}
\Defit{field}
であるという.
ただし,
``四則演算が定まっている''
とは, 次を満たしていることとする:
\begin{enumerate}
\item
  $s,t\in K$に対し$s+t$という$K$の元が定まる.
  (この演算を加法と呼ぶ.)
  さらに, $0$という(特別な)元がある.

  $a,b,c\in K$なら, 次が成り立つ:
  \begin{enumerate}
  \item
    $(a+b)+c=a+(b+c)$.
  \item
    $a+b=b+a$.
  \item
    $0+a=a$.
  \item
    $x$に関する方程式
    \begin{align*}
      a+x=0
    \end{align*}
    が($K$の元の)解を持つ.
  \end{enumerate}
\item
  $a+x=0$が解を持つとき,
  その解は,
  $a$が定まればただ一つに定まるので,
  この解を$-a$と書く.

  $b+(-a)$を$b-a$と略記する。
  (この演算を加法と呼ぶ.)

\item
  $s,t\in K$に対し$st$という$K$の元が定まる.
  (この演算を乗法と呼ぶ.)
  さらに, $1$という(特別な)元がある.

  $a,b,c\in K$なら, 次が成り立つ:
  \begin{enumerate}
  \item
    $(ab)c=a(bc)$.
  \item
  \label{def:field:item:comring}
    $ab=ba$.
  \item
    $1a=a1=a$.
  \item
  \label{def:field:item:invertible}
    $a\neq 0$ならば,
    $x$に関する方程式
    \begin{align*}
      ax=1
    \end{align*}
    が($K$の元の)解を持つ.
  \end{enumerate}

\item
  $ax=1$が解を持つとすると,
  その解は,
  $a$が定まればただ一つに定まるので,
  この解を$a^{-1}$とか$\frac{1}{a}$と書く.

  $b(\frac{1}{a})$を$\frac{b}{a}$と略記する。
  (この演算を除法と呼ぶ.)

\item
  $a,b,c\in K$なら, 以下が成り立つ:
  \begin{enumerate}
  \item $a(b+c)=ab+ac$.
  \item $0\neq 1$.
  \end{enumerate}
\end{enumerate}

\begin{remark}
  つまり体とは,
  結合則, 分配則, 可換則などが成り立つ
  (その集合の中で閉じた)四則演算(加減乗除)が備わった数の集合のことである.
\end{remark}
\begin{remark}
\Cref{def:field:item:invertible}
以外をすべて満たすものを可換環と呼ぶ.
つまり,
  結合則, 分配則, 可換則などが成り立つ
  加減乗が備わった数の集合が可換環である.
  また
\Cref{def:field:item:comring,def:field:item:invertible}
以外をすべて満たすものを環と呼ぶ.
\end{remark}

\begin{example}
  $\CC$は体である.
\end{example}
\begin{example}
  $\RR$は体である.
\end{example}
\begin{example}
  $\QQ$は体である.
\end{example}
\begin{remark}
  証明は省略する.
  以後これらは事実として使う.
\end{remark}
\begin{remark}
  掛け算は$ab$または$a\cdot b$のように書き表す.
  ($\times$は本原稿では別の意味で使うので,
  掛け算の意味では用いない)
\end{remark}

\begin{example}
  $2\in\ZZ$ではあるが$\frac{1}{2}\not\in \ZZ$である.
  したがって$2x=1$は$\ZZ$の元の解を持たない.
  $2\neq 0$であるが$2x=1$は$\ZZ$の元の解を持たないので,
  $\ZZ$は体ではない.
\end{example}

\begin{example}
\label{ex:f2}
$K=\Set{0,1}$とし,
$0+0=1+1=0$, $1+0=0+1=1$,
$0\cdot 0=1\cdot 0=0\cdot 1=0$, $1\cdot 1=1$
と定めると$K$は体となる.
このように有限集合である体もある.
\end{example}

$\KK$を体とし,
$I$を有限集合とする.
各$i\in I$に対し$a_i\in \KK$が与えられているとき,
$a_i$達の和を$\sum_{i\in I} a_i$で表す.
また,
$a_i$達の積を$\prod_{i\in I} a_i$で表す.

\begin{remark}
$I$が無限集合であるとき,
$\sum_{i\in I} a_i$や$\prod_{i\in I} a_i$は
$\KK$の演算からは定義できない.
ただし,
$\Set{i \in I |a_i\neq 0}$が有限集合であるときには,
$a_i\neq 0$となる$a_i$達の和を$\sum_{i\in I} a_i$で表す.
また,
$\Set{i \in I |a_i\neq 1}$が有限集合であるときには,
$a_i\neq 1$となる$a_i$達の積を$\sum_{i\in I} a_i$で表す.
\end{remark}

\section{行列や数ベクトル}
以下は,
行列や数ベクトルに関する基礎的な事項である.

\subsection{行列に関する用語と記号}
$\KK$を体とし,
$M=\Set{1,\ldots,m}$,
$N=\Set{1,\ldots,n}$とする.
$(i,j)\in M\times N$に対し$a_{i,j}\in \KK$が定まっているとき,
それらを表のように
\begin{align*}
\begin{pmatrix}
a_{1,1} &a_{1,2} & \cdots & a_{1,n}\\
a_{2,2} &a_{2,2} & \cdots & a_{2,n}\\
\vdots &\vdots &   & \vdots\\
a_{2,2} &a_{2,2} & \cdots & a_{2,n}
\end{pmatrix}
\end{align*}
と並べたものを$(m,n)$-行列と呼んだ.
この表記はスペースを使うので,
この行列を
$(a_{i,j})_{i\in M, j\in N}$
で表すこともある.

$(m,1)$-行列のことを$m$-項列ベクトルと呼ぶこともある.
$(1,n)$-行列のことを$n$-項行ベクトルと呼ぶこともある.
$M=N$であるとき正方行列と呼ぶ.
つまり$(a_{i,j})_{i\in M, j\in M}$のことを
正方行列と呼ぶ.
特に$M=\Set{1,\ldots,m}$であることを強調して,
$m$次正方行列と呼ぶこともある.

行列$A=(a_{i,j})_{i\in M, j\in N}$
に対し,
$a_{i,j}$を$A$の$(i,j)$-成分と呼ぶ.
正方行列$A=(a_{i,j})_{i\in M, j\in M}$に対し,
$a_{i,i}$を対角成分と呼び,
$i\neq j$に対して, $a_{i,j}$を非対角成分と呼ぶ.


\begin{definition}
以下の条件を満たすとき,
行列$(a_{i,j})_{i\in M, j\in N}$と
行列$(b_{k,l})_{k\in M', l\in N'}$は
等しいといい,
$(a_{i,j})_{i\in M, j\in N}=(b_{k,l})_{k\in M', l\in N'}$と書く:
\begin{enumerate}
\item $M=M'$.
\item $N=N'$.
\item $i\in M,j\in N\implies a_{i,j}=b_{i,j}$.
\end{enumerate}
\end{definition}

2つの行列$A$, $B$が等しいとは,
$A$の成分と$B$の成分がきちんと対応しており,
対応する各成分がそれぞれ等しいということである.

\begin{remark}
定義から,
$(a_{i,j})_{i\in M, j\in N}=(a_{k,l})_{k\in M, l\in N}$
である.
$\sum_{k=1}^{10}a_k$を$\sum_{n=1}^{10}a_n$と書いても同じことを表していたことを思い出すと,
$(a_{i,j})_{i\in M, j\in N}$という表記における$i$や$j$は,
$\sum_{k=1}^{10}a_k$における$k$と同じようなものであると思うことができる.
\end{remark}

すべての成分が$0$である行列を零行列と呼ぶ.
$(0)_{i\in \Set{1,\ldots,m}, j\in \Set{1,\ldots,n}}$
を$O_{m,n}$で表す.

非対角成分がすべて0である対角行列を
対角行列と呼ぶ.
対角成分がすべて1である対角行列を単位行列と呼ぶ.
特に, $m$次正方行列である単位行列を$E_m$で表す.

$c$が逆数をもつとき,
$F(i;c)$を$(i,i)$成分は$c$, それ以外の対角成分は$1$, , 他は$0$という正方行列とする.
$i\neq j$であるとき,
$G(i,j;a)$を$(i,j)$成分は$c$, 対角成分は$1$, 他は$0$という正方行列とする.
$i\neq j$であるとき,
$H(i,j;a)$を$(i,i)$成分と$(j,j)$成分は$0$, それ以外の対角成分は$1$,
$(i,j)$成分と$(j,i)$成分は$1$,
他は$0$という正方行列とする.
これらを基本行列と呼ぶ.

\begin{definition}
$M=\Set{1,\ldots,m}$とする.
次の条件を満たす正方行列$(a_{i,j})_{i\in M, j\in M}$を
上半三角行列と呼ぶ:
\begin{align*}
i,j\in M, i>j \implies a_{i,j}=0.
\end{align*}
次の条件を満たす正方行列$(a_{i,j})_{i\in M, j\in M}$を
下半三角行列と呼ぶ:
\begin{align*}
i,j\in M, i<j \implies a_{i,j}=0.
\end{align*}
\end{definition}


\subsection{行列の演算}
行列や数ベクトルに対する演算を紹介する.
\begin{definition}
行列$A=(a_{i,j})_{i\in M, j\in N}$,
$B=(b_{i,j})_{i\in M, j\in N}$に対し,
$A+B=(a_{i,j}+b_{i,j})_{i\in M, j\in N}$
と定義し$A$と$B$の和と呼ぶ.
\end{definition}
\begin{definition}
行列$A=(a_{i,j})_{i\in M, j\in N}$
と$c\in \KK$に対し,
$cA=(ca_{i,j})_{i\in M, j\in N}$
と定義し$c$による$A$のスカラー倍と呼ぶ.
\end{definition}
\begin{definition}
$L=\Set{1,\ldots,l}$とする.
行列$A=(a_{i,j})_{i\in M, j\in L}$,
$B=(a_{i,j})_{i\in L, j\in N}$
に対し,
$AB=(\sum_{k\in L}a_{i,k}b_{k,j})_{i\in M, j\in N}$
と定義し$A$と$B$の積と呼ぶ.
\end{definition}
\begin{remark}
$A=(a_{i,j})_{i\in M, j\in M}$,
$B=(b_{i,j})_{i\in M, j\in M}$
とする.
このとき,
一般には,
$AB\neq BA$である.
$AB=BA$を満たすとき,
$A$と$B$は可換であるという.
$A$も$B$も対角行列なら可換である.
単位行列$E$と$A$も可換である.
\end{remark}

\begin{definition}
行列$A=(a_{i,j})_{i\in M, j\in N}$に対し,
$\transposed{A}=(a_{l,k})_{k\in M, l\in N}$
と定義し$A$の転置と呼ぶ.
\end{definition}
\begin{prop}
$A=(a_{i,j})_{i\in M, j\in M}$,
$B=(b_{i,j})_{i\in M, j\in M}$
とする.
このとき,
\begin{align*}
\transposed{(AB)}&=\transposed{B}\transposed{A}.
\end{align*}
\end{prop}


\begin{definition}
$A$, $B$を$n$次正方行列とする.
$AB=E_n$かつ$BA=E_n$であるとき,
$B$は$A$の逆行列であるという.
$A$の逆行列が存在するとき,
$A$は正則であるといい,
そうでないとき, $A$は非正則であるという.
\end{definition}
\begin{prop}
$A$が正則であるとする.
$B$も$B'$も$A$の逆行列ならば, 
$B=B'$
\end{prop}
\begin{definition}
正則行列$A$の逆行列を$A^{-1}$であらわす.
\end{definition}

\begin{prop}
$n$次正則行列$A, B$に対し, 次が成り立つ:
\begin{enumerate}
\item $AB$も正則で, $(AB)^{-1}=B^{-1}A^{-1}$.
\item $\transposed{A}$も正則で, $(\transposed{A})^{-1}=\transposed{(A^{-1})}$.
\item $A^n$も正則で, $(A^{n})^{-1}=(A^{-1})^n$.
\end{enumerate}
\end{prop}

\subsection{行基本変形と列基本変形}



$M=\Set{1,\ldots,m}$,
$N=\Set{1,\ldots,n}$
とし,
行列
$A=(a_{i,j})_{i\in M, j\in N}$
を考える.
\begin{align*}
\begin{pmatrix}
a_{1,j}\\a_{2,j}\\\vdots \\a_{m,j}
\end{pmatrix}
\end{align*}
を$A$の$j$列目と呼ぶ.
\begin{align*}
\begin{pmatrix}
a_{i,1}& a_{i,2}&\cdots &a_{i,n}
\end{pmatrix}
\end{align*}
を$A$の$j$行目と呼ぶ.


基本行列を左から掛けることを行基本変形と呼ぶ.
つまり, 次の操作を行基本変形と呼ぶ:
\begin{enumerate}
\item $F(i;c)A$. $i$行目を$c$倍する. (ただし, $c$は逆数を持つとする.)
\item $G(i,j;s)A$. $i$行目に$j$行目の$a$倍を加える. (ただし, $i\neq j$.)
\item $H(i,j)A$. $i$行目と$j$行目を入れ替える. (ただし, $i\neq j$.)
\end{enumerate}
基本行列を右から掛けることを行基本変形と呼ぶ.
次の操作を列基本変形と呼ぶ:
\begin{enumerate}
\item $AF(i;c)$. $i$列目を$c$倍する. (ただし, $c$は逆数を持つとする.)
\item $AG(i,j;s)$. $j$列目に$i$列目の$a$倍を加える. (ただし, $i\neq j$.)
\item $AH(i,j)$. $i$列目と$j$列目を入れ替える. (ただし, $i\neq j$.)
\end{enumerate}
基本行列は正則であり,
行基本変形や列基本変形によって$A$の正則性は変わらない.


すべての成分が$0$である行を零行, そうでない行を非零行と一時的によぶことにする.
$A$に行基本変形を行い, なるべく非零行を少ない形に変形する.
このときの非零行の行数を$A$の階数と呼び$\rank(A)$で表す.
$n$次正方行列$A$に対して,
$\rank(A)=n$であることと, $A$が正則であることは同値である.


次の条件を満たす行列$A=(a_{i,j})_{i=1,\ldots,m,j=1,\ldots,n}$を
行被役階段行列と呼ぶ:
\begin{enumerate}
\item 次をみたす$p_1<\cdots <p_r$が存在する, ただし, $r=\rank(A)$:
\begin{enumerate}
\item $i=1,\ldots,r$に対し
\begin{enumerate}
\item $a_{i,p_i}=1$.
\item $j<p_i$ならば, $a_{i,j}=0$.
\end{enumerate}
\item $r+1,r+2,\ldots$行目の成分はすべて$0$
\end{enumerate}
\end{enumerate}
行基本変形を行うことで,
どんな行列$A$も
行被役階段行列に変形できる.
また,
得られる行被役階段行列は$A$のみに依存し,
その変形手順によらない.

次の条件を満たす行列$A=(a_{i,j})_{i=1,\ldots,m,j=1,\ldots,n}$を
列被役階段行列と呼ぶ:
\begin{enumerate}
\item 次をみたす$p_1<\cdots <p_r$が存在する, ただし, $r=\rank(A)$:
\begin{enumerate}
\item $j=1,\ldots,r$に対し
\begin{enumerate}
\item $a_{p_j,j}=1$.
\item $i<p_j$ならば, $a_{i,j}=0$.
\end{enumerate}
\item $r+1,r+2,\ldots$列目の成分はすべて$0$
\end{enumerate}
\end{enumerate}
列基本変形を行うことで,
どんな行列$A$も
列被役階段行列に変形できる.
また,
得られる列被役階段行列は$A$のみに依存し,
その変形手順によらない.



$A$を$(m,n)$行列とし,
$\zzero=O_{m,1}$とする.
未知数$\xx$に関する方程式$A\xx=\zzero$を,
$A$を係数行列とする斉次連立一次方程式と呼ぶ.
$\Set{\vv|A\vv=\zzero}$を
$A\xx=\zzero$の解の空間と呼ぶ.
$A\xx=\zzero$の解の空間は,
$n-\rank(A)$個の変数を使って記述することができるが,
$n-\rank(A)$を解の自由度と呼ぶ.
どんな$A$に対しても,
$\zzero$は斉次連立一次方程式の解の空間の元である.
$A$が正則行列なら, 自由度は$0$であり,
その解の空間は$\Set{\zzero}$である.
具体的な行列$A$に対し,
$A\xx=\zzero$の解の空間を求めるには,
$A$を行基本変形で行被役階段行列に変形すると求めやすい.


\subsection{行列式}
$M_n$を$n$次正方行列をすべて集めた集合とする.
このとき, $M_n$から$\KK$への写像を考える.

$\Set{1,\ldots,n}$から$\Set{1,\ldots,n}$への全単射をすべて集めた集合を$S_n$とおく.
$\sigma\in S_n$に対し,
\begin{align*}
\Inv(\sigma)&=\Set{(i,j)|i<j, \sigma(i)>\sigma(j)}\\
\sgn(\sigma)&=(-1)^{\numof{\Inv(\sigma)}}
\end{align*}
とし, $\sgn(\sigma)$を$\sigma$の符号と呼ぶ.
$n$次正方行列$A=(a_{i,j})_{i,j}\in M_n$に対し,
\begin{align*}
D_n^{(1)}=\sum_{\sigma\in S_n} \sgn(\sigma)a_{1,\sigma(1)}\cdots a_{n,\sigma(n)}
\end{align*}
とおく.

次に, 
$n$次正方行列$A=(a_{i,j})_{i,j}\in M_n$に対し,
$A$の$1$行目と$k$列目を忘れて得られる$(n-1)$次正方行列を$A^{(1,k)}$とし,
\begin{align*}
D_n^{(2)}
&=
\begin{cases}
\sum_{j=1}^{n} (-1)^{1+j}a_{1,j}D_{n-1}^{(2)}(A^{(1,k)}) & (n>1)\\
a_{1,1}&(n=1)
\end{cases}
\end{align*}
とおく.

$D^{(3)}_n\colon M_n \to \KK$は次の条件を満たすとする:
\begin{enumerate}
\item $A$, $A'$, $A''\in M_n$は$i$行目を除いて等しいとする. このとき以下が成り立つ:
\begin{enumerate}
\item $A'$の$i$行目を$c$倍したものが$A$の$i$行目と等しいならば, $D^{(3)}(A)=c D^{(3)}(A')$.
\item $A'$の$i$行目と$A''$の$i$行目を足したものが$A$の$i$行目と等しいならば, $D^{(3)}(A)=D^{(3)}(A')+D^{(3)}(A'')$.
\end{enumerate}
\item $i\neq i'$とする.  $A\in M_n$の$i$行目と$i'$行目が等しいならば$D^{(3)}(A)=0$.
\item $D(E_n)=1$.
\end{enumerate}

このとき, $D^{(1)}_n=D^{(2)}_n=D^{(3)}_n$である.
$D^{()}(A)$を$A$の行列式と呼び, $\det(A)$で表す.
$A\in M_n$に対し,
$\det(A)$が逆数を持つことと, $A$が正則であることは同値である.

\sectionX{章末問題}

\begin{quiz}
  %\solvelater{quiz:0:1}
  $\KK$を体とし, $V$を$\KK$を成分とする$(2,1)$行列の集合とする.
  つまり,
  \begin{align*}
    V=\Set{\begin{pmatrix}a_1\\a_2\end{pmatrix}|a_1,a_2\in \KK}
  \end{align*}
  とする. 通常の和とスカラー倍を考える.  つまり,
  \begin{align*}
    a&=\begin{pmatrix}a_1\\a_2\end{pmatrix}, & b&=\begin{pmatrix}b_1\\b_2\end{pmatrix} \in V
  \end{align*}
  $\alpha\in\KK$に対し,
  \begin{align*}
    a+b&=\begin{pmatrix}a_1+b_1\\a_2+b_2\end{pmatrix}, & \alpha a=\begin{pmatrix}\alpha a_1\\\alpha a_2\end{pmatrix} \in V
  \end{align*}
  とする. また,
  \begin{align*}
  \zzero=
  \begin{pmatrix}
    0\\0
  \end{pmatrix}
  \end{align*}
  とする.
  このとき, $\alpha,\beta\in\KK$, $a,b,c\in V$に対し, 以下を示せ:
  \begin{enumerate}
    \item $a+b=b+a$.
    \item $(a+b)+c=a+(b+c)$.
    \item $a+\zzero=a$.
    \item $a+(-1 a)=\zzero$.
    \item $(\alpha\beta)a=\alpha(\beta a)$.
    \item $1a=a$.
    \item $\alpha(a+b)=\alpha a+\alpha b$.
    \item $(\alpha+\beta)a=\alpha a+\beta a$.
  \end{enumerate}
\end{quiz}

\begin{quiz}
  %\solvelater{quiz:0:1}
  $\KK$を体とし, $V$を$\KK$を成分とする$(2,1)$行列の集合とする.
  $A$を$\KK$を成分とする$(2,2)$行列とし,
  \begin{align*}
    \shazo{\varphi}{V}{V}{x}{Ax}
  \end{align*}
  とする.
  このとき, 以下を示せ:
  \begin{enumerate}
    \item $a,b\in V\implies \varphi(a+b)=\varphi(a)+\varphi(b)$.
    \item $\alpha\in\KK, a\in V\implies \varphi(\alpha a)=\alpha\varphi(a)$.
  \end{enumerate}
\end{quiz}

\begin{quiz}
  $\KK$を体とし, $V$を$\KK$を成分とする$(2,1)$行列の集合とする.
  $A$を$\KK$を成分とする$(2,2)$行列とし,
  \begin{align*}
    \shazo{\varphi}{V}{V}{x}{Ax}
  \end{align*}
  とする. $A$が正則であるとする.
  このとき, 以下の条件を満たす線形写像$\psi\colon V\to V$が存在することを示せ:
  \begin{enumerate}
    \item $\varphi\circ \psi=\id_V$.
    \item $\psi\circ \varphi=\id_V$.
  \end{enumerate}
\end{quiz}

\begin{quiz}
  %\solvelater{quiz:0:1}
  $\KK$を体とし, $a, b\in \KK$とする.
  \begin{align*}
    \shazo{\varphi}{\KK}{\KK}{x}{ax+b}
  \end{align*}
  とする.
  \begin{enumerate}
  \item
  $b=0$なら, 以下がなりたつことを示せ:
  \begin{enumerate}
    \item $x,y\in \KK\implies \varphi(x+y)=\varphi(x)+\varphi(y)$.
    \item $\alpha\in\KK, x\in \KK\implies \varphi(\alpha x)=\alpha\varphi(x)$.
  \end{enumerate}
  \item
  $b\neq 0$なら, 以下がなりたたないことを示せ:
  \begin{enumerate}
    \item $x,y\in \KK\implies \varphi(x+y)=\varphi(x)+\varphi(y)$.
    \item $\alpha\in\KK, x\in \KK\implies \varphi(\alpha x)=\alpha\varphi(x)$.
  \end{enumerate}
  \end{enumerate}
\end{quiz}


\chapter{線形空間と線形写像}
本稿全体を通し,
特に断らなければ,
$(\KK,+,\cdot,0,1)$を体とする.

ここでは, $\KK$線形空間と$\KK$上の線形写像を定義し,
いくつかの例を挙げる.
また, $\KK$線形空間が同型であるということを定義する.

\section{線形空間の定義とその例}

線形空間の定義と例を挙げる.

\begin{definition}
\label{def:vecsp}
  $V$を集合とする.
  $\plus\colon V\times V \to V$を$V$上の二項演算とする.
  $\act \colon \KK\times V \to V$を$\KK$の$V$への作用とする.
  $0_V \in V$とする.

  以下の条件を満たすとき,
  $(V,\plus,\act ,0_V)$は$\KK$上の\defit{ベクトル空間}であるとか
  $\KK$-\defit{線形空間}であるいう:
  \begin{enumerate}
  \item 
    \begin{enumerate}
    \item $u,w \in V\implies  u\plus w=w\plus u$.
    \item
      \label{def:vecsp:item:sum:ass}
      $v,w,u\in V \implies (v\plus w)\plus u=v\plus (w\plus u)$.
    \item $w\in V \implies 0_V\plus w=w$.
    %\item $w\in V\implies $ `$w\plus x=0_V$を満たす$x\in V$が存在する'.
    \item $w\in V\implies w\plus (-1).w=0_V$.%を満たす$x\in V$が存在する'.
    \end{enumerate}
  \item
    \begin{enumerate}
    \item
      \label{def:vecsp:item:prod:ass}
      $\alpha,\beta\in\KK, w\in V \implies \alpha\act (\beta \act w)=(\alpha\cdot \beta)\act w$
    \item $w\in V \implies 1\act w=w$.
    \end{enumerate}
  \item
    \begin{enumerate}
    \item
      \label{def:vecsp:item:dist:r}
$\alpha\in \KK,u,w\in V \implies \alpha\act (u\plus w)=(\alpha\act u)\plus (\alpha\act w)$.
    \item
      \label{def:vecsp:item:dist:l}
$\alpha,b\in\KK, w\in V\implies (\alpha+b)\act w=(\alpha\act w)\plus (b\act w)$.
    \end{enumerate}
  \end{enumerate}
\end{definition}
\begin{remark}
  $(V,\plus,\act ,0_V)$が$\KK$-線形空間
  であるとき,
  $\plus$を加法,
  $\act $をスカラー倍と呼ぶ.
  また, $0_V$を$V$の\defit{零元}と呼ぶ.
  また, 
  $(V,\plus,\act ,0_V)$が$\KK$-線形空間であることを,
  $V$は加法$\plus$とスカラー倍$\act $で$0_V$を零元とする$\KK$-線形空間であるということもある.
  また, $\plus$, $\act $, $0_V$が文脈上明らかなときには,
  単に$V$を$\KK$-線形空間と呼ぶこともある.
\end{remark}
\begin{remark}
  $(V,\plus,\act ,0_V)$が体$\KK$上のベクトル空間
  であるとき,
  $V$の元を\defit{ベクトル}と呼ぶ.
  また, 零元$0_V$のことを, \defit{零ベクトル}と呼ぶこともある.
つまり,
$x$がベクトルであるとは,
何某かのベクトル空間$V$があり$x$は$V$の元であるといっているだけである.
ベクトルは向きと大きさを持ったものと説明されることもあるが,
このメタファーは理解の役に立つこともあるものの,
理解の弊害となることも多い.
このメタファーに囚われない方が良いかもしれない.
\end{remark}

まず, $\KK$-線形空間の例をいくつか挙げる.

\begin{example}
  $n\geq 1$とする. このとき, \begin{align*} \KK^n
  =\Set{\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}|a_1,\ldots,a_n\in \KK} \end{align*}
  とおく. このとき, $a_i,b_i,\alpha\in\KK$に対し,
  \begin{align*} \begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}+\begin{pmatrix}b_1\\\vdots\\b_n\end{pmatrix}
  &=\begin{pmatrix}a_1+b_1\\\vdots\\a_n+b_n\end{pmatrix},\\
  \alpha\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}
  &=\begin{pmatrix}\alpha a_1\\\vdots\\\alpha a_n\end{pmatrix}
  \intertext{とし,}
  \zzero_n&=\begin{pmatrix}0\\\vdots\\0\end{pmatrix} \end{align*}とお
  くと, $\KK^n$はこれらの演算で$\zzero_n$を零元とする$\KK$-線形空間.
  これを$\KK$上の$n$次元\defit{数ベクトル空間}と呼ぶ.
  今後, $i$番目のみ$1$で他
  は$0$である$\KK^n$の元を, $\ee^{(n)}_i$で表す.
  この記号を用いると,
  \begin{align*} \aaa= \begin{pmatrix}
  a_1\\\vdots\\a_n \end{pmatrix}\in\KK^n \end{align*}は,
  $\aaa=a_1\ee^{(n)}_i+\cdots+a_n\ee^{(n)}_n$と書くことができる.
  
  また, 形式的に,
  長さ$0$の列, つまり空列$()$を考え,
  これを$\zzero_0$と書き,
  \begin{align*}
    \KK^0
    =\Set{\zzero_0}
  \end{align*}
  とおく.
  このとき, $\alpha\in\KK$に対し,
  \begin{align*}
    \zzero_0+\zzero_0&=\zzero_0\\
    \alpha \zzero_0&=\zzero_0
  \end{align*}
  とおくと,
  $\KK^0$はこれらの演算で
  $\zzero_0$を零元とする
  $\KK$-線形空間.
  これを$\KK$上の\defit{$0$次元数ベクトル空間}と呼ぶ.
\end{example}

\begin{example}
  $n,m\geq 1$とし,
  $I=\Set{1,\ldots,m}$, $J=\Set{1,\ldots, n}$とする.
  このとき,
  \begin{align*}
    \KK^{m \times n}
    =\Set{(a_{i,j})_{i\in I,j\in J}|a_{i,j}\in \KK}
  \end{align*}
  とおく.
  このとき, $a_{i,j},b_{i,j},\alpha \in\KK$に対し,
  \begin{align*}
    (a_{i,j})_{i\in I,j\in J}
    +(b_{i,j})_{i\in I,j\in J}
      &=(a_{i,j}+b_{i,j})_{i\in I,j\in J},\\
    \alpha (a_{i,j})_{i\in I,j\in J}
    &=(\alpha a_{i,j})_{i\in I,j\in J}
    \intertext{とし,}
    O_{m,n}&=(0)_{i\in I,j\in J}
  \end{align*}
  とおくと,
  $\KK^{m \times n}$は
  これらの演算で
  $O_{m,n}$を零元とする
  $\KK$-線形空間.
\end{example}

\begin{example}
  $\NN$で添字付けられた数列$a_0, a_1,\ldots$を
  $(a_i)_{i\in \NN}$
  で表す.
  \begin{align*}
    \ell(\KK) = \Set{(a_i)_{i\in \NN}|a_i\in \KK}
  \end{align*}
  とおく.
  次の和とスカラー倍で, $(0)_{i\in \NN}$を零元とする$\KK$-線形空間:
  $\alpha \in\KK$, $(a_i)_{i\in \NN},(b_i)_{i\in \NN}\in \ell(\KK)$に対し,
  \begin{align*}
    (a_i)_{i\in \NN}+(b_i)_{i\in \NN} &= (a_i+b_i)_{i\in \NN},\\
    \alpha (a_i)_{i\in \NN} &= (\alpha a_i)_{i\in \NN}.
  \end{align*}
\end{example}

\begin{example}
  $S$を集合とする.
  \begin{align*}
    \KK^S = \Set{f\colon S \to \KK \text{; 写像}}
  \end{align*}
  とする.
  $\alpha \in\KK$, $f,g\in \KK^S$に対し,
  $f+g\in \KK^S$と$\alpha \act f\in\KK^S$を以下で定める:
  $x\in S$に対し,
  \begin{align*}
    (f+g)(x) &= f(x)+g(x),\\
    (\alpha f)(x) &= \alpha (f(x)).
  \end{align*}
  また $\underline{0}\in\KK^S$を以下で定める:
  $x\in S$に対し,
  \begin{align*}
    \underline{0}(x)=0.
  \end{align*}
  このとき, $\KK^S$はこれらの演算で,
  $\underline{0}$を零元とする
  $\KK$-線形空間.
\end{example}

\begin{example}
  $S$を集合とし, $(V,+,\act,0_V)$を$\KK$-線形空間とする.
  \begin{align*}
    V^S = \Set{f\colon S \to V \text{; 写像}}
  \end{align*}
  とする.
  $\alpha\in\KK$, $f,g\in V^S$に対し,
  $f+g\in V^S$と$\alpha f\in V^S$を以下で定める:
  $x\in S$に対し,
  \begin{align*}
    (f+g)(x) &= f(x)+g(x),\\
    (\alpha f)(x) &= \alpha\act (f(x)).
  \end{align*}
  また $\underline{0_V}\in\KK^S$を以下で定める:
  $x\in S$に対し,
  \begin{align*}
    \underline{0_V}(x)=0_V.
  \end{align*}
  このとき,
  $\KK^S$はこれらの演算で
  $\underline{0_V}$を零元とする
  $\KK$-線形空間.
\end{example}

\begin{example}
$\RR$から$\RR$の関数で連続なものをすべて集めた集合を$C^0$とおく.
$\RR$から$\RR$の関数で$1$回微分可能でその導関数が連続なものをすべて集めた集合を$C^1$とおく.
$\RR$から$\RR$の関数で$n$回微分可能でその$n$階導関数が連続なものをすべて集めた集合を$C^n$とおく.
任意有限階の導関数をもつ
$\RR$から$\RR$の関数をすべて集めた集合を$C^\infty$とおく.
これらは, $\RR^\RR$と同じ演算で, $\RR$-線形空間である.
\end{example}

\begin{example}
  %$(\KK,+,\cdot,0)$を体とする.
  体としての和と積で$\KK$は, $\KK$-線形空間.
  つまり, $(\KK,+,\cdot,0)$は, $\KK$-線形空間.
\end{example}

\begin{example}
  $\CC=\Set{a+b\sqrt{-1}|a,b\in \RR}$は,
  通常の和と積で$\CC$-線形空間.
  また,
  $\CC$は,
  通常の和と積で$\RR$-線形空間でもある.
\end{example}

\begin{example}
  \begin{align*}
    V=\Set{a+b\sqrt{2}|a,b\in\QQ}
  \end{align*}
  とすると,
  通常の和と積で$\QQ$-線形空間.
\end{example}

\begin{example}
  $\zeta_n= e^{\frac{2\pi\sqrt{-1}}{n}}=\cos(\frac{2\pi}{n})+\sqrt{-1}\sin(\frac{2\pi}{n})$
  とする.
  \begin{align*}
    V=\Set{\sum_{i=0}^{n}a_i\zeta_n^i|a_i\in\QQ}
  \end{align*}
  とすると,
  通常の和と積で$\QQ$-線形空間.
\end{example}

\begin{example}
  $(V,\plus,\act,0_V)$, $(W,\pplus,\aact,0_W)$を$\KK$-線形空間とする.
\begin{align*}
V\boxplus W = \Set{(v,w)|v\in V, w\in W}
\end{align*}
とし, $(v,w),(v',w')\in V\boxplus W$, $c\in\KK$に対し,
$(v,w)+(v',w')$, $c(v,w)$を以下で定める:
\begin{align*}
(v,w)+(v',w')&=(v\plus v', w\pplus w')\\
c(v,w)&=(c\act v,c\aact w).
\end{align*}
このとき,
$V\boxplus W$は, これらの演算で, $(0_V,0_W)$を零元とする
$\KK$線形空間である.
これを,
$V$と$W$の
\defit{外部直和}%
\addindex{直和!外部---}%
%\Defit{直和}%
と呼ぶ.

$V_1,\ldots, V_n$という$n$個の$\KK$線形空間が与えられたとき,
\begin{align*}
V_1\boxplus \cdots \boxplus V_n = \Set{(v_1,\ldots,v_n)|v_i\in V_i}
\end{align*}
とおくと,
$V\boxplus W$と同様に,
$\KK$線形空間である.
これを, 
$V_1,\ldots, V_n$の外部直和と呼ぶ.
\end{example}
\begin{remark}
外部直和を$\oplus$で表し
直和と呼ぶこともあるが,
本原稿では,
後ほど定義する内部直和分解の記号と区別するため,
外部直和は$\boxplus$で表し区別する.
\end{remark}

$\KK$-線形空間の
表記方法などについてのいくつかコメントする.
\begin{remark}
$(V,\plus,\act,0_V)$を$\KK$-線形空間とする.
\Cref{def:vecsp:item:sum:ass}
があるので, $v\plus w\plus u$を, $(v\plus w)\plus u$と思っても,
$v\plus (w\plus u)$と思っても差し支えない.
そこで, $(v\plus w)\plus u$を$v\plus w\plus u$と略記する.
\end{remark}
\begin{remark}
$(V,\plus,\act,0_V)$を$\KK$線形空間とする.
\Cref{def:vecsp:item:prod:ass}
があるので, $\alpha \beta w$を, $\alpha\act (\beta\act w)$と思っても,
$(\alpha\cdot\beta)\act w$と思っても差し支えない.
そこで, $(\alpha\act \beta)\act w$を$\alpha \beta w$と略記する.
もっと一般に, $n\geq 1$, $\alpha_1,\ldots,\alpha_n\in\KK$, $w\in V$に対し,
$(\alpha_1\cdots \alpha_n)\act w$のことを
$\alpha_1\cdots \alpha_n w$と略記する.
\end{remark}
\begin{remark}
$(V,\plus,\act,0_V)$を$\KK$線形空間とする.
スカラー倍の方が和よりも演算としての優先度が高いものとし,
$(\alpha\act v)+(\beta\act w)$を
$\alpha\act v+\beta\act w$
と略記する.
\end{remark}

\begin{remark}
\Cref{def:vecsp}にある条件の内,
\Cref{def:vecsp:item:dist:r,def:vecsp:item:dist:l}
は分配則と呼ばれることもある.
特に, \Cref{def:vecsp:item:dist:r}
\begin{align*}
\alpha\in \KK,u,w\in V \implies \alpha\act (u\plus w)=(\alpha\act u)\plus (\alpha\act w)
\end{align*}
が成り立つことを, スカラー倍が$V$の和に対して分配的である
と言い表す.
また,  \Cref{def:vecsp:item:dist:l}
\begin{align*}
\alpha,b\in\KK, w\in V\implies (\alpha+b)\act w=(\alpha\act w)\plus (b\act w)
\end{align*}
が成り立つことを, スカラー倍が$\KK$の加法に対して分配的である
と言い表す.
\Cref{def:vecsp:item:dist:r}に
現れる和は線形空間$V$の和$\plus$であり,
 \Cref{def:vecsp:item:dist:l}に
現れる和は$\KK$の和$+$であり,
異なっていることに注意する必要がある.
\end{remark}

\begin{remark}
  $\KK$-線形空間の定義において,
  その条件の中に, $\KK$の割り算は現れない.
  したがって,
  これらの条件を, ある環に対して満たすものという概念を定義することができる.
  環$R$に対して定義された$R$-線形空間を通常は$R$-加群 ($R$-module) と呼ぶ.
\end{remark}

\begin{prop}
  \label{prop:zeroveciszeroscalar}
  $(V,\plus ,\act ,0_V)$を$\KK$-線形空間とする.
  このとき,
  \begin{align*}
    w\in V \implies 0\act w=0_V. 
  \end{align*}
\end{prop}
\begin{proof}
$(V,\plus,\act,0_V)$を$\KK$-線形空間とする.
  このとき,
  \begin{align*}
    0\act w\plus 0\act w&=(0+0)\act w=0\act w\\
    0\act w\plus 0\act w&=0\act w\plus (-0)\act w=0_V.
  \end{align*}
\end{proof}
\begin{prop}
$(V,\plus ,\act ,0_V)$を$\KK$-線形空間とする.
このとき, $\alpha \in\KK$に対し,
\begin{align*}
\alpha \act 0_V = 0_V.
\end{align*}
\end{prop}
\begin{proof}
$\alpha \act 0_V = \alpha \act (0\act 0_V)= (\alpha \cdot 0)\act 0_V=0\act 0_V=0_V$.
\end{proof}


\begin{prop}
  \label{lem:uniq:zero}
  $(V,\plus ,\act ,0_V)$を$\KK$-線形空間とする.
  $o\in V$が, 次の条件を満たすとする:
  \begin{align*}
    w\in V \implies o\plus w=w.
  \end{align*}
  このとき, $o=0_V$.
\end{prop}
\begin{proof}
  $0_V$の満たす条件から$0_V\plus o=o$.
  一方, $o$の満たす条件から$o\plus 0_V=0_V\plus o=0_V$.
  よって, $0_V=0_V\plus o=o$.
\end{proof}
\begin{remark}
\label{rem:altdef:1}
  $(V,\plus,\act,0_V)$を$\KK$線形空間とする.
  \cref{lem:uniq:zero}から,
  零ベクトルの条件を満たす元はただ一つしかないことがわかる.
  したがって, 
  何が$V$の零ベクトルであるかを明示しなくともよい場合は,
  単に$(V,\plus ,\act)$を$\KK$-線形空間と呼ぶこともある.
\end{remark}

\begin{lemma}
  \label{lem:uniq:inv}
  $(V,\plus ,\act ,0_V)$を$\KK$-線形空間とする.
  $w\in V$とする.
  $x,y\in V$が以下を満たすなら$x=y$:
  \begin{align*}
    w\plus x&=0_V\\
    w\plus y&=0_V
  \end{align*}
\end{lemma}
\begin{proof}
  $x$の満たす条件から,
  $y\plus (w\plus x)=y\plus 0_V=y$.
  $y$の満たす条件から,
  $(y\plus w)\plus x=(w\plus y)\plus x=0_V\plus x=x$.
  よって$x=y$.
\end{proof}
\begin{remark}
\label{rem:altdef:2}
$(V,\plus,\act,0_V)$を$\KK$線形空間とすると,
\cref{lem:uniq:inv}から,
各$w\in V$に対し, $w\plus x=0_V$を満たす$x\in V$は
高々一つしかないことがわかる.
\end{remark}
\begin{remark}
  $(-1)\act w$のことを$-w$と略記する.
  また, $u\plus (-w)$のことを$u-w$と略記する.
\end{remark}

\Cref{rem:altdef:1,rem:altdef:2}
を踏まえると$\KK$線形空間は次の様にも定義できる:
\begin{definition}
$V$を集合とする.
$\plus\colon V\times V \to V$を$V$上の二項演算とする.
$\act \colon \KK\times V \to V$を$\KK$の$V$への作用とする.
以下の条件を満たすとき,
$(V,\plus,\act)$は$\KK$上のベクトル空間であるとか
$\KK$-線形空間であるいう:
  \begin{enumerate}
  \item 
    \begin{enumerate}
    \item $u,w \in V\implies  u\plus w=w\plus u$.
    \item
      \label{def:vecsp:item:sum:ass}
      $v,w,u\in V \implies (v\plus w)\plus u=v\plus (w\plus u)$.
    \item
    次の条件を満たす$o\in V$が存在する
    \begin{enumerate}
          \label{def:vecsp:item:sum:zero}
    \item $w\in V \implies o\plus w=w$.
    \end{enumerate}
    \item
    $o\in V$が\Cref{def:vecsp:item:sum:zero}を満たすとする.
    このとき,
    各$w\in V$に対し, 次の条件を満たす$x_w\in V$が存在する:
\begin{enumerate}
\item $w\plus x_w=0_V$.
\end{enumerate}
    \end{enumerate}
  \item
    \begin{enumerate}
    \item
      \label{def:vecsp:item:prod:ass}
      $\alpha ,\beta\in\KK, w\in V \implies \alpha \act (\beta\act w)=(\alpha \cdot \beta)\act w$
    \item $w\in V \implies 1\act w=w$.
    \end{enumerate}
  \item
    \begin{enumerate}
    \item $\alpha \in \KK,u,w\in V \implies \alpha \act (u\plus w)=(\alpha \act u)\plus (\alpha \act w)$.
    \item $\alpha ,\beta\in\KK, w\in V\implies (\alpha +\beta)\act w=(\alpha\act w)\plus (\beta\act w)$.
    \end{enumerate}
  \end{enumerate}
\end{definition}







\section{線形写像の定義とその例}
\begin{definition}
  $(V,\plus,\act)$, $(W,\pplus,\aact)$を$\KK$-線形空間とする.
  $\varphi$を$V$から$W$への写像とする.
  $\varphi$が以下の条件を満たすとき,
  $\varphi$は$(V,\plus,\act)$から$(W,\pplus,\aact)$への$\KK$-\defit{線形写像}であるという:
  \begin{enumerate}
    \item $v,u\in V\implies \varphi(v\plus u)=\varphi(v)\pplus\varphi(u)$.
    \item $\alpha\in \KK, u\in V\implies \varphi(\alpha\act v)=\alpha\aact\varphi(v)$.
  \end{enumerate}
\end{definition}

\begin{remark}
  $V$から$W$への写像$\varphi$が
  $(V,\plus,\act)$から$(W,\pplus,\aact)$への$\KK$-線形写像であることを,
  条件をまとめて,
  \begin{enumerate}
    \item $v,v'\in V, \alpha,\alpha'\in\KK\implies \varphi(\alpha\act v\plus \alpha'\act v')=\alpha\aact \varphi(v)\pplus \alpha'\aact\varphi(u)$
  \end{enumerate}
  を満たすことととして定義することもある.
\end{remark}

\begin{remark}
  $\varphi$は$(V,\plus,\act)$から$(W,\pplus,\aact)$への$\KK$-線形写像であることを,
  写像$\varphi$は$\KK$-線形であるということもある.
\end{remark}

線形写像の定義から次がすぐわかる.
\begin{prop}
  $(V,\plus,\act,0_V)$, $(W,\pplus,\aact,0_W)$を$\KK$-線形空間とし,
  $\varphi\colon V\to W$を$\KK$-線形写像とする.
  このとき,
  \begin{enumerate}
    \item $\varphi(0_V)=0_W$.
    \item $\varphi(-x)=-\varphi(x)$.
  \end{enumerate}
\end{prop}
\begin{proof}
$v\in V$とすると,
$\varphi(0_V)=\varphi(0\act v)=0\aact \varphi(v)=0_W$.
また,
$\varphi(-x)=\varphi(-1\act x)=-1\aact \varphi(x)=-\varphi(x)$.
\end{proof}

線形写像の例をいくつか挙げる.

\begin{example}
  $A\in \KK^{m\times n}$とし,
  $\varphi$を次の写像とする:
  \begin{align*}
    \shazo{\varphi}{\KK^m}{\KK^n}{\aaa}{A\aaa}.
  \end{align*}
  このとき, $\varphi$は$\KK$-線形である.
\end{example}

\begin{example}
  $A\in \KK^{m\times n}$とし,
  $\varphi$を次の写像とする:
  \begin{align*}
    \shazo{\varphi}{\KK^{m\times k}}{\KK^{n\times k}}{X}{AX}.
  \end{align*}
  このとき, $\varphi$は$\KK$-線形である.
\end{example}

\begin{example}
  $\varphi$を次の写像とする:
  \begin{align*}
    \shazo{\varphi}{\KK^{m\times n}}{\KK^{n\times m}}{A}{\transposed{A}}.
  \end{align*}
  このとき, $\varphi$は$\KK$-線形である.
\end{example}

\begin{example}
  $\KK$を体とし,
  $I=\Set{1,2,\ldots, n}$する.
  $\tr$を次の写像とする:
  \begin{align*}
    \shazo{\tr}{\KK^{n\times n}}{\KK}{(a_{i,j})_{i\in I, j\in A}}{\sum_{i\in I}a_{i,i}}.
  \end{align*}
  この写像は$\KK$-線形である.
  $A\in \KK^{n\times n}$に対し,
  $\tr(A)$を$A$の\defit{トレース}と呼ぶ.
\end{example}

\begin{example}
  $a\in\RR$とする.
  $\varphi$を次の写像とする:
  \begin{align*}
    \shazo{\varphi}{\RR}{\RR}{x}{ax}.
  \end{align*}
  これは$\RR$-線形写像である.
  $\psi$を次の写像とする:
  \begin{align*}
    \shazo{\psi}{\RR}{\RR}{x}{ax+1}.
  \end{align*}
  これは$\RR$-線形写像ではない.
  $\phi$を次の写像とする:
  \begin{align*}
    \shazo{\phi}{\RR}{\RR}{x}{x^3}.
  \end{align*}
  これは$\RR$-線形写像ではない.
\end{example}


\begin{example}
  $\varphi$を次の写像とする:
  \begin{align*}
    \shazo{\varphi}{\CC}{\CC}{z}{\overline{z}},
  \end{align*}
  ただし, 
  $x,y\in\RR$に対し$\overline{x+y\sqrt{-1}}=x-y\sqrt{-1}$, つまり,
  $\overline{z}$は$z$の複素共軛とする.
  このとき, $\varphi$は$\RR$-線形である.
  しかし, $\CC$-線形ではない.
\end{example}


\begin{example}
  $\varphi$を次の写像とする:
  \begin{align*}
    \shazo{\varphi}{\ell(\KK)}{\ell(\KK)}
    {(a_i)_{i\in \NN}=(a_0,a_1,a_2,\ldots)}{(a_{i+1})_{i\in \NN}=(a_1,a_2,a_3,\ldots)}.
  \end{align*}
  このとき, $\varphi$は$\KK$-線形である.
  $\psi$を次の写像とする:
  \begin{align*}
    \shazo{\varphi}{\ell(\KK)}{\ell(\KK)}
    {(a_0,a_1,a_2,\ldots)}{(0,a_0,a_1,\ldots)}.
  \end{align*}
  このとき, $\psi$は$\KK$-線形である.
\end{example}

\begin{example}
  $\pi_k$を次の写像とする:
  \begin{align*}
    \shazo{\varphi}{\ell(\KK)}{\KK}
    {(a_0,a_1,a_2,\ldots)}{a_k}.
  \end{align*}
  このとき, $\pi_k$は$\KK$-線形である.
\end{example}


\begin{example}
  $S$を集合,
  $(V,\plus,\act,0_V)$を$\KK$線形空間とし,
  $S$から$V$への写像をすべて集めた集合$V^S$は$\KK$-線形空間であった.
  $a\in S$に対し, $\varepsilon_a$を,
  \begin{align*}
  \shazo{\varepsilon_a}{V^S}{V}
  {f}{f(a)}
  \end{align*}
  は$\KK$-線形写像である.
\end{example}

\begin{example}
$\RR$から$\RR$の関数で$n$回微分可能でその$n$階導関数が連続なものをすべて集めた集合を$C^n$とおく.
$f\in C^n$に対しその導関数$f'$を対応させる写像
  \begin{align*}
  \shazo{\frac{d}{dx}}{C^n}{C^{n-1}}
  {f}{f'}
  \end{align*}  
  は$\RR$-線形写像である.
\end{example}


\begin{example}
  $(V,\plus,\act,0_V)$を$\KK$線形空間とし,
  $w_1,\ldots,w_r\in V$とする.
  $\nu_{(w_1,\ldots,w_r)}$を
    \begin{align*}
      \shazo{\nu_{(w_1,\ldots,w_r)}}{\KK^r}{V}
      {\begin{pmatrix}a_1\\\vdots\\a_r\end{pmatrix}}{a_1\act w_1\plus\cdots\plus a_r\act w_r}
    \end{align*}
    で定義する.
  $\nu_{(w_1,\ldots,w_r)}$は$\KK$-線形写像である.
\end{example}

\begin{example}
  $V$
  $(W,\pplus,\aact,0_W)$
  を$\KK$線形空間とする.
    \begin{align*}
      \shazo{\underline{0_W}}{V}{W}
      {x}{0_W}
    \end{align*}
  は$\KK$-線形写像である.
\end{example}


\begin{example}
  $V$を$\KK$-線形空間とする.
  恒等写像$\id_V$は$\KK$-線形である.
\end{example}



\begin{example}
  $V$, $U$, $W$を$\KK$-線形空間とし,
  $\varphi\colon V\to U$,
  $\psi\colon U\to W$を$\KK$-線形写像とする.
  このとき, $\psi\circ\varphi\colon V\to W$は$\KK$-線形写像である.
\end{example}
\begin{proof}\end{proof}

\begin{example}
  $V$, $W$を$\KK$-線形空間とし,
  $\varphi\colon V\to W$は全単射であるとする.
  $\varphi$が$\KK$-線形なら,
  逆写像$\varphi^{-1}$は
  $W$から
  $V$への$\KK$-線形写像.
\end{example}
\begin{proof}\end{proof}

\begin{example}
  $V$, $(W,\pplus,\aact,0_W)$を$\KK$-線形空間とし,
  $\varphi\colon V\to W$を線形写像とする.
  このとき, $\alpha \in \KK$に対し,
  \begin{align*}
  \shazo{\alpha\varphi}{V}{W}
  {x}{\alpha\aact \varphi(x)}
  \end{align*}
  は$V$から$W$への線形写像.
\end{example}
\begin{proof}\end{proof}

\begin{example}
  $V$, $(W,\pplus,\aact,0_W)$を$\KK$-線形空間とし,
  $\varphi\colon V\to W$,
  $\psi\colon V\to W$
  を線形写像とする.
  このとき, 
  \begin{align*}
  \shazo{\varphi+\psi}{V}{W}
  {x}{\varphi(x) \pplus \psi(x)}
  \end{align*}
  は$V$から$W$への線形写像.
\end{example}
\begin{proof}\end{proof}




数ベクトル空間上の線形写像の性質をいくつか紹介する.
\begin{prop}
\label{prop:linmap:kn:1}
線形写像
$\varphi\colon \KK^n \to \KK^m$,
$\psi\colon \KK^n \to \KK^m$
に対し, 以下は同値:
\begin{enumerate}
\item $\varphi=\psi$
\item すべての$i$に対し, $\varphi(\ee^{(n)}_i)=\psi(\ee^{(n)}_i)$
\end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
\label{prop:linmap:kn:2}
  $\aaa_1,\ldots, \aaa_n \in \KK^m$とし,
  $\aaa_1,\ldots, \aaa_n $を並べて得られる行列を$A\in\KK^{m\times n}$
  とする.
  このとき, $\mu_A$を次の写像とする:
  \begin{align*}
    \shazo{\mu_A}{\KK^m}{\KK^n}{w}{Aw}.
  \end{align*}
  このとき, $\mu_A$は$\KK$-線形であり,
   $\mu_A(\ee^{(n)}_j)=\aaa_j$である.
\end{prop}
\begin{proof}\end{proof}

\begin{remark}
\Cref{prop:linmap:kn:1,prop:linmap:kn:2}
より,
$\KK^n$から$\KK^m$への線形写像は,
行列$A\in\KK^{m\times n}$から得られる
$\mu_A$という線形写像のみ考えればよいことがわかる.
また, $A$の$j$列目を$\aaa_j$とし,
\begin{align*}
\shazo{\nu_{(\aaa_1,\ldots,\aaa_n)}}{\KK^m}{\KK^n}
      {\begin{pmatrix}c_1\\\vdots\\c_r\end{pmatrix}}{c_1\aaa_1+\cdots+c_n\aaa_n}
\end{align*}
という$\KK$線形写像を考えると$\mu_A=\nu_{(\aaa_1,\ldots,\aaa_n)}$である.
\end{remark}

\begin{prop}
$A\in\KK^{m\times n}$とし,
\begin{align*}
\shazo{\mu_A}{\KK^n}{\KK^m}
{\aaa}{A\aaa}
\end{align*}
とする.
\begin{enumerate}
\item $\varphi$は単射ならば$\rank(A)=n$.
\item $\varphi$が全射ならば$\rank(A)=m$.
\end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\section{同型写像}

\begin{definition}
  $V$, $W$を$\KK$-線形空間とする.
  以下の条件を満たす
  $\varphi\colon V\to W$を,
  $V$から$W$への($\KK$-線形空間としての)\defit{同型写像}と呼ぶ:
  \begin{enumerate}
  \item $\varphi\colon V\to W$は$\KK$-線形写像.
  \item 以下の条件を満たす$\KK$-線形写像$\psi\colon W \to V$が存在する:
    \begin{enumerate}
      \item $\varphi\circ \psi=\id_W$.
      \item $\psi\circ \varphi=\id_V$.
    \end{enumerate}
  \end{enumerate}
\end{definition}
\begin{definition}
  $V$, $W$を$\KK$-線形空間とする.
  $V$から$W$への($\KK$-線形空間としての)同型写像が存在するとき,
  $V$と$W$は($\KK$-線形空間として)\defit{同型}であるといい,  
  $V\simeq W$と書く.
\end{definition}

同型写像の例を挙げる:
\begin{example}
  $\KK$-線形写像$\varphi$を以下で定める:
  \begin{align*}
    &\shazo{\varphi}{\KK^{m\times n}}{\KK^{n\times m}}{A}{\transposed{A}}.
  \end{align*}
  このとき,
  $\psi$を
  \begin{align*}
    &\shazo{\psi}{\KK^{n\times m}}{\KK^{m\times n}}{A}{\transposed{A}}
  \end{align*}
  とすると,
  $\psi$は$\KK$-線形であり, $\varphi\circ \psi=\id_{\KK^{n\times m}}$, $\psi\circ\varphi=\id_{\KK^{m\times n}}$である.
  よって, $\varphi$は同型写像である.
  したがって, $\KK^{m\times n}\simeq\KK^{n\times m}$である.
\end{example}


\begin{example}
  $\RR$-線形写像$\varphi$を以下で定める:
  \begin{align*}
    &\shazo{\varphi}{\RR^2}{\CC}{\begin{pmatrix}x\\y\end{pmatrix}}{x+y\sqrt{-1}}.
  \end{align*}
  このとき,
  $\psi$を
  \begin{align*}
    &\shazo{\varphi}{\RR^2}{\CC}{\begin{pmatrix}x\\y\end{pmatrix}}{x+y\sqrt{-1}},\\
   &\shazo{\psi}{\CC}{\RR^2}{x+y\sqrt{-1}}{\begin{pmatrix}x\\y\end{pmatrix}}.
  \end{align*}
  とすると,
  $\RR$-線形であり,
  $\varphi\circ \psi=\id_\CC$,
  $\psi\circ\varphi=\id_{\RR^2}$である.
  よって, 同型写像であり,
  $\RR$-線形空間として$\RR^2\simeq\CC$である.
\end{example}

\begin{example}
  $\varphi$を次の写像とする:
  \begin{align*}
    \shazo{\varphi}{\CC}{\CC}{z}{\overline{z}},
  \end{align*}
  このとき, $\varphi$は$\RR$-線形であり, $\varphi\circ\varphi=\id_{\CC}$である.
  $\varphi$は, $\CC$から$\CC$への$\RR$-線形空間としての同型写像である.
\end{example}


\begin{example}
  $I=\Set{1,\ldots,m}$, $J=\Set{1,\ldots,n}$,
  $\Lambda=\Set{1,\ldots,mn}$とする.
  このとき,
  \begin{align*}
    &\shazo{\lambda}{I\times J}{\Lambda}{(i,j)}{i+(m-1)j}
  \end{align*}
  は全単射である.  $\lambda$の逆写像を$\kappa$とする.
  $\KK$線形写像$\varphi$を以下で定める:
  \begin{align*}
    &\shazo{\varphi}{\KK^{mn}}{\KK^{m\times n}}{\begin{pmatrix}a_1\\\vdots\\a_{mn}\end{pmatrix}}{(a_{\lambda(i,j)})_{i\in I, j\in J}}.
  \end{align*}
  $\psi$を
  \begin{align*}
    &\shazo{\psi}{\KK^{m\times n}}{\KK^{mn}}
    {(a_{i,j})_{i\in I, j\in J}}{\begin{pmatrix}a_{\kappa(1)}\\a_{\kappa(2)}\\\vdots\\a_{\kappa(mn)}\\\end{pmatrix}}
  \end{align*}
  とすると,
  $\KK$-線形であり,
  $\varphi\circ \psi=\id_{\KK^{m\times n}}$,
  $\psi\circ\varphi=\id_{\KK^{mn}}$である.
  よって, 同型写像であり,
  $\KK^{mn}\simeq \KK^{m\times n}$.
\end{example}





\begin{example}
  $I=\Set{1,\dots,n}$とする.
  $\varphi$を以下で定義する:
  \begin{align*}
    \shazo{\varphi}{\KK^I}{\KK^n}{f}{\begin{pmatrix}f(1)\\\vdots\\f(n)\end{pmatrix}}.
  \end{align*}
  $\varphi$は$\KK$-線形写像である.
  逆に,
  \begin{align*}
    \aaa=
    \begin{pmatrix}
      a_1\\\vdots\\a_n
    \end{pmatrix}
  \end{align*}
  に対し,
  $I$から$\KK$への
  写像$f_{\aaa}$を
  \begin{align*}
    \shazo{f_{\aaa}}{I}{\KK}{i}{a_i}
  \end{align*}
  で定める.
  次の写像を考える:
  \begin{align*}
    \shazo{\psi}{\KK^n}{\KK^I}{\aaa}{f_{\aaa}}.
  \end{align*}
  つまり$\psi$以下で定義する.
  \begin{align*}
    \shazo{\psi}{\KK^n}{\KK^I}{\aaa=
    \begin{pmatrix}
      a_1\\\vdots\\a_n
    \end{pmatrix}
  }{\left(\shazo{f_{\aaa}}{I}{\KK}{i}{a_i}\right)}.
  \end{align*}
  このとき$\psi$も$\KK$-線形写像であり,
  $\varphi\circ\psi=\id_{\KK^n}$,
  $\psi\circ\varphi=\id_{\KK^I}$である.
  よって$\varphi$は同型写像であり,
  $\KK^I\simeq \KK^n$.
\end{example}

\begin{example}
  $I=\Set{1,\dots,m}$, $J=\Set{1,\ldots,n}$とする.
  $\varphi$を以下で定義する:
  \begin{align*}
    \shazo{\varphi}{\KK^{I\times J}}{\KK^{m\times n}}{f}{(f(i,j))_{i\in I,j\in J}}.
  \end{align*}
  $\varphi$は$\KK$-線形写像である.
  逆に,
  \begin{align*}
    A=
      (a_{i,j})_{i\in I,j\in J}
  \end{align*}
  に対し,
  $I\times J$から$\KK$への
  写像$f_a$を
  \begin{align*}
    \shazo{f_A}{I\times J}{\KK}{(i,j)}{a_{i,j}}
  \end{align*}
  で定め,
  次の写像を考える:
  \begin{align*}
    \shazo{\psi}{\KK^{m\times n}}{\KK^{I\times J}}{A}{f_A}.
  \end{align*}
  つまり$\psi$以下で定義する.
  \begin{align*}
    \shazo{\psi}{\KK^{m\times n}}{\KK^{I\times J}}
          {A=(a_{i,j})_{i\in I,j\in J}}{\left(\shazo{f_A}{I\times J}{\KK}{(i,j)}{a_{i,j}}\right)}.
  \end{align*}
  このとき$\psi$も$\KK$-線形写像であり,
  $\varphi\circ\psi=\id_{\KK^{m\times n}}$,
  $\psi\circ\varphi=\id_{\KK^{I\times J}}$である.
  よって$\varphi$は同型写像であり,
  $\KK^{I\times J}\simeq \KK^{m\times n}$.
\end{example}

\begin{example}
  $\NN$から$\KK$への写像を集めた集合を$\KK^\NN$,
  $\NN$で添字付された数列を集めた集合を$\ell(\KK)$とする.
  どちらも$\KK$-線形空間であった.
  $\varphi$を以下で定義する:
  \begin{align*}
    \shazo{\varphi}{\KK^\NN}{\ell(\KK)}{f}{(f(i))_{i\in \NN}}.
  \end{align*}
  $\varphi$は$\KK$-線形写像である.
  逆に,
  \begin{align*}
    a=
      (a_{i})_{i\in \NN}
  \end{align*}
  に対し,
  $\NN$から$\KK$への
  写像$f_a$を
  \begin{align*}
    \shazo{f_a}{\NN}{\KK}{i}{a_{i}}
  \end{align*}
  で定め,
  次の写像を考える:
  \begin{align*}
    \shazo{\psi}{\ell(\KK)}{\KK^\NN}{a}{f_a}.
  \end{align*}
  つまり$\psi$以下で定義する.
  \begin{align*}
    \shazo{\psi}{\ell(\KK)}{\KK^\NN}{a=(a_{i})_{i\in \NN}}{\left(\shazo{f_a}{\NN}{\KK}{i}{a_{i}}\right)}.
  \end{align*}
  このとき$\psi$も$\KK$-線形写像であり,
  $\varphi\circ\psi=\id_{\ell(\KK)}$,
  $\psi\circ\varphi=\id_{\KK^\NN}$である.
  よって$\varphi$は同型写像であり,
  $\KK^\NN\simeq \ell(\KK)$.
\end{example}

同型写像などについていくつか補足する.

\begin{remark}
  $V$と$W$を$\KK$-線形空間とする.
  $\varphi\colon V\to W$が$\KK$-線形写像であるとき,
  $V$において和やスカラー倍に関してなりたつことは,
  $\varphi$を通して, $W$における命題に翻訳できる.
  $\varphi\colon V\to W$が同型写像であるなら,
  $\KK$-線形写像$\psi\colon W\to V$で
  $\varphi\circ \psi=\id_W$と
  $\psi\circ \varphi=\id_V$を満たすものが存在する.
  $W$において和やスカラー倍に関してなりたつことは,
  $\psi$を通して, $V$における命題に翻訳できる.
  $\varphi$と$\psi$を使い, 双方を自由に行き来できるので,
  $V$と$W$は$\KK$-線形空間として同一視できる.
\end{remark}

\begin{prop}
  $V$, $W$, $U$を$\KK$-線形空間とする.
  このとき, 以下が成り立つ:
  \begin{enumerate}
  \item $V\simeq V$.
  \item $V\simeq W \implies W\simeq V$.
  \item $V\simeq U, U\simeq W \implies V\simeq W$.
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$, $W$を$\KK$-線形空間とし, $\varphi\colon V\to W$を$\KK$-線形写像とする.
  このとき, 以下は同値:
  \begin{enumerate}
  \item $\varphi$は同型写像.
  \item $\varphi$は全単射.
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{example}
   $m,n\in\NN$に対し以下は同値:
  \begin{enumerate}
  \item $m=n$.
  \item $\KK^m \simeq \KK^n$
  \end{enumerate}
\end{example}
\begin{proof}
  $m=n$のとき, $\KK^n=\KK^m$であるので, 同型である.

  $m\neq n$のとき, $\KK^n$と$\KK^m$は同型ではないことを示す.
  $m>n$とし, $A\in \KK^{m\times n}$で定義される
  \begin{align*}
    \shazo{\mu_A}{\KK^n}{\KK^m}
    {\aaa}{A\aaa}
  \end{align*}
  について考える.
  $\rank(A)\leq n<m$であるので, $\mu_A$は全射ではない.
  したがって,
  どんな$\psi\colon \KK^m\to \KK^n$に対しても
  $\mu_A\circ\psi\neq \id_{\KK^m}$であるので,
  $\mu_A$は同型写像ではない.
  どんな線形写像$\mu_A\colon \KK^n \to \KK^m$も同型写像にはならないので,
  $\KK^n$と$\KK^m$は同型ではない.
\end{proof}

\begin{definition}
次を満たすとき$\KK$線形空間$V$の\defit{次元}は$n$であるといい,
$\dim_\KK(V)=n$と書く:
\begin{enumerate}
\item $\KK^n\simeq V$.
\end{enumerate}
また,
このとき,
$V$は\defit{有限次元}であるともいい, $\dim_\KK(V)<\infty$と書くこともある.
\end{definition}

\begin{definition}
次を満たすとき$\KK$線形空間$V$は\defit{無限次元}であるといい,
$\dim_\KK(V)=\infty$と書く:
\begin{enumerate}
\item $n\in \NN$ならば, 次が成り立つ:
\begin{enumerate}
\item $\KK^n$から$V$への単射線形写像が存在する.
\end{enumerate}
\end{enumerate}
\end{definition}

\begin{example}
$\KK^{m\times n}$と$\KK^{mn}$は同型であった.
したがって,
$\dim_\KK(\KK^{m\times n})=mn$.
\end{example}

\begin{example}
$\CC$と$\RR^{mn}$と$\RR$線形空間として同型であった.
したがって,
$\dim_\RR(\CC)=2$.
また,
$\CC$は,
$\CC$線形空間としては$\CC^1$と同型である.
したがって,
$\dim_\CC(\CC)=1$.
\end{example}

\begin{prop}
  $V$, $W$を有限次元線形空間とする.
  このとき, 以下は同値:
  \begin{enumerate}
  \item $V\simeq W$.
  \item $\dim_\KK(V) = \dim_\KK(W)$.
  \end{enumerate}
\end{prop}

\begin{remark}
次元という用語は,
ベクトル空間に対する用語であり, その元であるベクトルに対する用語ではない.
$\RR^2$は$2$次元であるとは言うが,
例えば,
\begin{align*}
\begin{pmatrix}a\\b\end{pmatrix}
\end{align*}
のことを$2$次元であるとは言わない.
通常$2$つの成分からなる数ベクトルであるということを言い表すのには,
$2$項数ベクトルという用語を用いる.
\end{remark}

\sectionX{章末問題}
\begin{quiz}
  %\solvelater{quiz:1:1}
  $\KK$を体とし,
  $V$を$\KK$を成分とする$(3,1)$行列の集合とし,
  $W$を$\KK$を成分とする$(2,1)$行列の集合とする.
  $A$を$\KK$を成分とする$(2,3)$行列とし,
  $\zzero=O_{2,1}$とする.
  このとき, 以下は$\KK$-線形空間であることを示せ:
  \begin{align*}
    \Set{x\in V|Ax=\zzero}.
  \end{align*}
\end{quiz}

\begin{quiz}
  %\solvelater{quiz:1:1}
  次が通常の和とスカラー倍で$\KK$線形空間となることを示せ:
  \begin{align*}
    \Set{\begin{pmatrix}x\\x\end{pmatrix}|x\in\KK}
  \end{align*}
\end{quiz}

\begin{quiz}
  %\solvelater{quiz:1:1}
  次が通常の和とスカラー倍で$\KK$線形空間とはならないことを示せ:
  \begin{align*}
    \Set{\begin{pmatrix}x\\0\end{pmatrix}|x\in\KK}
    \cup \Set{\begin{pmatrix}0\\x\end{pmatrix}|x\in\KK}
  \end{align*}
\end{quiz}

\chapter{部分空間}
\section{部分空間の定義}
\begin{definition}
  $(U,\plus,\act,0_U)$を$\KK$-線形空間とする.
  以下の条件を満たすとき,
  $V$を$U$の\defit{部分空間} (部分$\KK$-線形空間)と呼ぶ:
  \begin{enumerate}
  \item $V\subset U$.
  \item $(V,\plus,\act,0_U)$が$\KK$-線形空間.
  \end{enumerate}
\end{definition}
\begin{remark}
  $(U,\plus,\act,0_U)$を$\KK$-線形空間とし, $V\subset U$とする.
このとき, $v,w,u\in U$に対して,
\begin{align*}
  v\plus w&=w\plus v\\
  (v\plus w)\plus u&=v\plus (w\plus u)\\
  0_U\plus w&=w\\
  w\plus (-1)\act w&=0_U
\end{align*}
が成り立っているので,
$v,w,u\in V\subset U$に対しても,
\begin{align*}
  v\plus w&=w\plus v\\
  (v\plus w)\plus u&=v\plus (w\plus u)\\
  0_U\plus w&=w\\
  w\plus (-1)\act w&=0_U
\end{align*}
は成り立つ.
同様の理由で,
$\alpha,\beta\in \KK$, $v,w\in V$に対して,
\begin{align*}
  1\act v&=v\\
  (\alpha\beta)\act v&=\alpha\act(\beta\act v)\\
  (\alpha+\beta)\act v&=\alpha\act v\plus \beta\act v\\
  \alpha\act(v\plus w)&=\alpha\act v\plus \alpha\act w
\end{align*}
が成り立つ.
$(V,\plus ,\act,0_U)$が$\KK$-線形空間であるための条件で非自明なのは,
これらではなく, $\plus $などが$V$上の演算であるかということである.
つまり, 以下の$3$条件が重要である.
\begin{enumerate}
  \item $0_U\in V$.
  \item $v,w\in V \implies v\plus w\in V$.
  \item $\alpha\in\KK$, $v\in V \implies \alpha\act v\in V$.
\end{enumerate}
\end{remark}
\begin{lemma}
  $(U,\plus ,\act,0_U)$を$\KK$-線形空間とし, $V\subset U$とする.
  このとき以下は同値:
  \begin{enumerate}
  \item $V$が$U$の部分空間.
  \item 以下の$3$条件を満たす:
    \begin{enumerate}
  \item $0_U\in V$.
  \item $v,w\in V \implies v\plus w\in V$.
  \item $\alpha\in\KK$, $v\in V \implies \alpha\act v\in V$.
    \end{enumerate}
  \item 以下の$2$条件を満たす:
    \begin{enumerate}
  \item $0_U\in V$.
  \item $v,w\in V, \alpha,\beta\in\KK \implies \alpha\act v\plus \beta\act w\in V$.
    \end{enumerate}
  \item 以下の$3$条件を満たす:
    \begin{enumerate}
  \item $V\neq \emptyset$.
  \item $v,w\in W \implies v\plus w\in V$.
  \item $\alpha\in\KK$, $v\in V \implies \alpha\act v\in V$.
    \end{enumerate}
  \item 以下の$2$条件を満たす:
    \begin{enumerate}
  \item $V\neq \emptyset$.
  \item $v,w\in V, \alpha,\beta\in\KK \implies \alpha\act v\plus \beta\act w\in V$.
    \end{enumerate}
  \end{enumerate}
\end{lemma}

\section{部分空間の例}
\subsection{部分空間の具体例}
\begin{example}
  $(U,\plus ,\act,0_U)$を$\KK$-線形空間とする.
  $U$は$U$の部分空間である.
  $\Set{0_U}$は$U$の部分空間である.
  この2つを$U$の\defit{自明な部分空間}と呼ぶ.
\end{example}

\begin{example}
  $a\in \KK^2\setminus\Set{\zzero_2}$とする.
  このとき, $\Set{ta|t\in \KK}$は原点と$a$を通る直線である.
  これは, $\KK^2$の非自明な部分空間である.
\end{example}
\begin{proof}\end{proof}


\begin{example}
  \begin{align*}
    V=\Set{\begin{pmatrix}a_1\\\vdots\\a_n\\0\end{pmatrix}|a_1,\ldots,a_n\in\KK}
  \end{align*}
  は$\KK^{n+1}$の非自明な部分空間である.
\end{example}
\begin{proof}\end{proof}

\begin{example}
  \label{subsp:example:fiber}
  $A\in \KK^{m\times n}$とする.
  つまり$A$を成分が$\KK$の元である$(m,n)$-行列とする.
  \begin{align*}
    \KKK=\Set{\aaa\in \KK^n|A\aaa=\zzero_m}
  \end{align*}
  とおく. $\KKK$は$\KK^n$の部分空間である.
  (\Cref{subsp:nonexample:fiber}も見よ.)
\end{example}
\begin{proof}\end{proof}

\begin{example}
  \label{subsp:example:cc}
  $\CC$は$\RR$-線形空間であった.
  $\RR$は, $\CC$の部分$\RR$-線形空間である.
  (\Cref{subsp:nonexample:cc}も見よ.)
\end{example}
\begin{proof}\end{proof}


\begin{example}
  ここでは,
  $\KK$を$\CC$または$\RR$とする.
  $\KK$が$\CC$や$\RR$のときには,
  数列の極限を考えることができる.  
  数列をすべて集めた集合$\ell(\KK)$は$\KK$線形空間であった.
  $p>0$に対し,
  \begin{align*}
    \ell^p(\KK)=\Set{(a_i)_{i\in\NN}\in \ell(\KK)|\sum_i |a_i|^p < \infty}
  \end{align*}
  とおくと, $\ell^p(\KK)$は$\ell(\KK)$の部分空間.
  \begin{align*}
    \ell^\infty(\KK)=\Set{(a_i)_{i\in\NN}\in \ell(\KK)|\sup \Set{\left|a_i\right||i\in \NN} < \infty}
  \end{align*}
  とおくと, $\ell^\infty(\KK)$は$\ell(\KK)$の部分空間.
  \begin{align*}
    c(\KK)&=\Set{(a_i)_{i\in\NN} \in \ell(\KK)| \lim_{i\to\infty} a_i \in\KK}\\
    c_0(\KK)&=\Set{(a_i)_{i\in\NN} \in \ell(\KK)| \lim_{i\to\infty} a_i =0}\\
  \end{align*}
  とおくと, $c$, $c_0$は$\ell(\KK)$の部分空間.
  %$c_0$は$c$の部分空間でもある.
\end{example}
\begin{proof}\end{proof}

\begin{example}
  数列をすべて集めた集合$\ell(\KK)$は$\KK$線形空間であった.
  \begin{align*}
    c_{00}(\KK)&=\Set{(a_i)_{i\in\NN} \in \ell(\KK) | \#\Set{i| a_i \neq 0} < 0}
  \end{align*}
  とおくと, $c_{00}$は$\ell(\KK)$の部分空間である.
  
  文字$x$を用いて各$i\in\NN$に対し形式的な記号$x^i$を用意し,
  数列$(a_i)_{i\in\NN} \in \ell(\KK)$を
  $\sum_{i\in \NN} a_ix^i$
  と書くことにする.
  $\sum_{i\in \NN} a_ix^i$は,
  不定元$x$に関する\defit{形式的冪級数}とよばれる.
  不定元$x$に関する形式的冪級数をすべて集めた集合を,
  $\KK[[x]]$と書く.
  $i>n$ならば$a_i=0$となるような数列$(a_i)_{i\in\NN} \in \ell(\KK)$
  に対しては,
  $\sum_{i=0}^{n} a_ix^i$
  とか
  $a_0x^0+a_1x_1+\cdots+a_nx^n$
  とか
  $a_0+a_1x_1+\cdots+a_nx^n$
  の様に書くこともあり,
  不定元$x$に関する\defit{多項式}とよばれる.
  不定元$x$に関する多項式をすべて集めた集合を,
  $\KK[x]$と書く.
  $\KK[[x]]$は\defit{形式的冪級数環},
  $\KK[x]$は\defit{多項式環}と呼ばれる.
\end{example}
\begin{proof}\end{proof}
\begin{remark}
  多項式や形式的冪級数に現れる不定元$x$は単なる文字であって,
  代入を目的とした変数ではない.
  $x^i$は数列における位置を表すための記号であり,
  $\KK[[x]]$の元と$\ell(\KK)$の元は表記が違うだけで同じものである.
  $x^i$は$(\underbrace{0,\ldots,0}_{i},1,0,0,\ldots)$という数列を表しており,
  $j\neq i$なら$x^i$と$x^j$は区別される.
  したがって,
  $\KK[[x]]$や$\KK[x]$には無限個の元が含まれている.

  多項式と混同しやすいものに多項式関数がある.
  $a_0,\ldots, a_n\in \KK$としたとき,
  \begin{align*}
  \shazo{f}{\KK}{\KK}
  {x}{a_0+a_1x+\cdots+a_nx^n}
  \end{align*}
  という写像を考えることができる.
  このような写像を$n$次の\defit{多項式関数}と呼ぶ.
  多項式関数すべてを集めた集合を$V$と置くと,
  $V$は$\KK^\KK$の部分空間である.
  例えば$\KK$が有限集合なら,
  $\KK^\KK$も有限集合であるから,
  $V$も有限集合である.
  \begin{align*}
  &\shazo{f}{\KK}{\KK}
  {x}{a_0+a_1x+\cdots+a_nx^n}
  \\
  &\shazo{g}{\KK}{\KK}
  {x}{b_0+b_1x+\cdots+b_mx^m}
  \end{align*}
  という
  2つの多項式関数があったとき,
  $(a_0,\ldots,a_n)\neq (b_0,\ldots,b_m)$
  であっても, $f\neq g$とは限らないことに注意が必要である.

  たとえば,
  \cref{ex:f2}
  で挙げた体の例を$\KK$とおくと,
  そこでは, $0^2=0$, $1^2=1$である.
  したがって, $f$と$g$を
  \begin{align*}
  &\shazo{f}{\KK}{\KK}
  {x}{x}
  \\
  &\shazo{g}{\KK}{\KK}
  {x}{x^2}
  \end{align*}
  で定義される多項式関数とすると$f=g$である.
  一方, 多項式$x\in\KK[x]$は数列$(0,1,0,\ldots)\in\ell(\KK)$であり,
  多項式$x^2\in\KK[x]$は数列$(0,0,1,0,\ldots)\in\ell(\KK)$であるので,
  この2つは区別され, $x\neq x^2$である.
\end{remark}

\begin{example}
$\RR$から$\RR$への関数全体$\RR^\RR$は$\RR$-線形空間であった.
また, 連続関数全体$C^0$, $n$回連続微分可能な関数全体$C^n$,
任意の有限回微分可能な関数全体$C^\infty$も$\RR$-線形空間であった.
これらはどれも$\RR^\RR$の部分空間である.
また$n,m\in \NN$に対し, $C^\infty$は$C^n$の部分空間であり,
$n<m$なら$C^m$は$C^n$の部分空間である.
\end{example}

\begin{example}
  $V$を$\KK$-線形空間とする.
  $V$から$\KK$への写像をすべて集めた集合
  $\KK^V$は$\KK$線形空間であった.
  \begin{align*}
    V^\ast =\Set{f\colon V\to \KK\text{: 線形写像} }
  \end{align*}
  とおく. これは$\KK^V$の部分空間.
  $V^\ast$を$\KK$-線形空間$V$の\defit{双対空間}と呼ぶ.
\end{example}
\begin{proof}\end{proof}

\begin{example}
  $V$, $W$を$\KK$-線形空間とする.
  $V$から$W$への写像をすべて集めた集合
  $W^V$は$\KK$線形空間であった.
  \begin{align*}
    \Hom_\KK(V,W) =\Set{f\colon V\to W\text{: $\KK$-線形写像} }
  \end{align*}
  とおく. これは$W^V$の部分空間.
\end{example}
\begin{proof}\end{proof}


\subsection{部分空間から得られる部分空間}

\begin{example}
  \begin{align*}
    V&=\Set{\begin{pmatrix}a\\b\\0\end{pmatrix}|a,b\in\KK}\\
    W&=\Set{\begin{pmatrix}0\\a\\b\end{pmatrix}|a,b\in\KK}
  \end{align*}
  とする.
  このとき, $V$も$W$も$\KK^3$の部分空間である.
  \begin{align*}
    V\cap W&=\Set{\begin{pmatrix}0\\a\\0\end{pmatrix}|a\in\KK}\\
  \end{align*}
  となっており, $V\cap W$も$\KK^3$の部分空間である.
\end{example}
\begin{proof}\end{proof}

\begin{example}
  $U$を$\KK$-線形空間とする.
  $V, W$を$U$の部分空間とする.
  このとき, $V\cap W$は$U$の部分空間.
\end{example}
\begin{proof}\end{proof}


\begin{example}
  $U$を$\KK$-線形空間とする.
  $I$を集合とし,
  $i\in I$に対し, $V_i$を$U$の部分空間とする.
  このとき, $\bigcap_{i\in I}V_i$は$U$の部分空間である.
\end{example}
\begin{proof}\end{proof}


\begin{example}
  \label{subspace:nonexample:cup}
  \begin{align*}
    V&=\Set{\begin{pmatrix}a\\0\end{pmatrix}|a\in\KK}\\
    W&=\Set{\begin{pmatrix}0\\a\end{pmatrix}|a\in\KK}
  \end{align*}
  とする.
  このとき, $V$も$W$も$\KK^2$の部分空間である.
  \begin{align*}
    \begin{pmatrix}1\\0\end{pmatrix},
    \begin{pmatrix}0\\1\end{pmatrix}\in V\cup W
  \end{align*}
  であるが,
  \begin{align*}
    \begin{pmatrix}1\\0\end{pmatrix}+
    \begin{pmatrix}0\\1\end{pmatrix}=\begin{pmatrix}1\\1\end{pmatrix}\not\in V\cup W
  \end{align*}
  となっており, $V\cup W$は$U$の部分空間ではない.
\end{example}
\begin{proof}\end{proof}

\begin{example}
  $U$を$\KK$-線形空間とする.
  $V, W$を$U$の部分空間とする.
  \begin{enumerate}
    \item $V\subset W$なら$V\cup W=W$であるので, $V\cup W$は$U$の部分空間.
    \item $W\subset V$なら$V\cup W=V$であるので, $V\cup W$は$U$の部分空間.
    \item $V$と$W$に包含関係がないとき, $V\cup W$は$U$の部分空間ではない. 
  \end{enumerate}
\end{example}
\begin{proof}
  $V$と$W$に包含関係が無いとする.
  $v\in V\setminus W$, $w\in W\setminus V$
  とし, $u=v+w$とおく.
  $u\in V$とすると, $v\in V$であるから, $u-v\in V$となるが,
  $u-v=w\not\in V$に矛盾する.
  $u\in W$とすると, $w\in W$であるから, $u-w\in W$となるが,
  $u-w=v\not\in W$に矛盾する.
  よって, $u\not\in V\cup W$となるので, $V\cup W$は部分空間ではない.
\end{proof}



\begin{example}
  \begin{align*}
    V&=\Set{\begin{pmatrix}a\\0\\0\end{pmatrix}|a\in\KK}\\
    W&=\Set{\begin{pmatrix}0\\a\\0\end{pmatrix}|a\in\KK}
  \end{align*}
  とする.
  このとき, $V$も$W$も$\KK^3$の部分空間である.
  \begin{align*}
    U=\Set{v+w|v\in V, w\in W}
  \end{align*}
  とすると,
  \begin{align*}
    U&=\Set{\begin{pmatrix}a\\b\\0\end{pmatrix}|a,b\in\KK}\\
  \end{align*}
  となっており, $U$も$\KK^3$の部分空間である.
\end{example}
\begin{proof}\end{proof}

\begin{example}
  $(U,\plus ,\act,0_V)$を$\KK$-線形空間とする.
  $V, W$を$U$の部分空間とする.
  このとき,
  \begin{align*}
    V+W=\Set{v\plus w|v\in V,w\in W}
  \end{align*}
  とおく.
  このとき, $V+W$は$U$の部分空間.
  $V+W$を$V$と$W$の和空間と呼ぶことがある.
\end{example}
\begin{proof}\end{proof}
\begin{prop}
  $(U,\plus ,\act,0_V)$を$\KK$-線形空間とし,
  $V, W$を$U$の部分空間とする.
  \begin{align*}
    \SSS=\Set{U'|\text{$U'$は$U$の部分空間,} V\cup W \subset U'}
  \end{align*}
  とおく.  
  \begin{align*}
    U_0 = \bigcap_{U'\in\SSS} U'
  \end{align*}
  とする.  また, $\SSS$の中で包含関係で極小なものを$U_1$とする.
  このとき,
  \begin{align*}
    U_0=U_1=V+W.
  \end{align*}
\end{prop}
\begin{proof}
\end{proof}
\begin{remark}
  $V, W$を$U$の部分空間とするとき,
  $V+W$は$V$と$W$の両方を含む最小の部分空間である.
  また$V\cap W$は$V$と$W$の両方に含まれる最大の部分空間である.
\end{remark}


\begin{definition}
  $U$を$\KK$-線形空間とし,
  $V$, $W$を$U$の部分空間とする.
  次の条件を満たすとき,
  $U$は$V$と$W$の(内部)直和に分解できるという.
  \begin{enumerate}
  \item $U=V+W$.
  \item $V\cap W=\Set{0_U}$.
  \end{enumerate}
  $U$が$V$と$W$の(内部)直和に分解できることを,
  $U=V\oplus W$と書き表す.
  また$V$や$W$のことを$U$の直和因子と呼ぶことがある.
\end{definition}
\begin{example}
  $U=\KK^3$とし,
  \begin{align*}
    V&=\Set{\begin{pmatrix}x\\y\\0\end{pmatrix}|x,y\in\KK}&
    W&=\Set{\begin{pmatrix}0\\0\\z\end{pmatrix}|z\in\KK}&
    W'&=\Set{\begin{pmatrix}0\\y\\z\end{pmatrix}|y,z\in\KK}
  \end{align*}
  とする.
  $U=V+W$であり, $U=V+W'$でもある.
  $V\cap W=\Set{\zzero_3}$であるので,
  $U$は$V$と$W$の(内部)直和に分解できる.
  つまり, $U=V\oplus W$である.
  一方$V\cap W'\neq \Set{\zzero_3}$であるので,
  $V$と$W'$には(内部)直和に分解できない.
\end{example}

\begin{prop}
  $U=V\oplus W$であるとき,
  $v,v'\in V$,
  $w,w'\in W$に対し, 以下は同値:
  \begin{enumerate}
  \item $v\plus w=v'\plus w'$.
  \item $v=v'$, $w=w'$.
  \end{enumerate}
\end{prop}
\begin{proof}
  \paragraph{$v\plus w=v'\plus w'\implies v=v', w=w'$}
  $v\plus w=v'\plus w'$であるので,
  $-v'\plus v=-w\plus w'$.
  左辺は$V$の元, 右辺は$W$の元であるから,
  これらは, $V\cap W$の元.
  よって, $0_U$である.
  $-v'\plus v=0_U$であるので, $v=v'$.
  $-w'\plus w=0_U$であるので, $w=w'$.
  
  \paragraph{$v=v', w=w'\implies v\plus w=v'\plus w'$}
  明らか.
\end{proof}


$U$が$U=V_1\oplus W_1$と内部直和に分解され,
$W_1$が$V_2\oplus W_2$と内部直和に分解され,
$W_2$が$V_3\oplus W_3$と内部直和に分解され,
ということが繰り返された状況を考える.
つまり,
$U=V_1\oplus (V_2\oplus \cdots \oplus(V_{l-1}\oplus V_l))$
と分解されていることを考える.
\begin{definition}
$U=V_1\oplus (V_2\oplus \cdots \oplus(V_{l-1}\oplus V_l))$
と内部直和に分解されているとき,
$U$は$U=V_1\oplus V_2\oplus \cdots \oplus V_l$
と(内部)直和に分解されると言う.
\end{definition}
\begin{prop}
  $(U,\plus,\ast,0_U)$を$\KK$-線形空間とし, $V_i\subset U$を$U$の部分空間とし,
  $U=V_1+\cdots+ V_l$を満たすとする.
  このとき, 以下は同値である:
  \begin{enumerate}
  \item $U=V_1\oplus \cdots \oplus V_l$と内部直和に分解される.
  \item 全ての$i$に対して,
    \begin{align*}
      V_i \cap (V_1+\cdots+ V_{i-1}+V_{i+1}+\cdots+ V_{l})=\Set{0_U}.
    \end{align*}
  \end{enumerate}
\end{prop}

\subsection{線形写像から得られる部分空間}

\begin{definition}
  $(V,\plus,\act,0_V)$,
  $(W,\pplus,\aact,0_W)$を
  $\KK$-線形写像とし,
  $\varphi\colon V\to W$を線形写像とする.
  このとき,
  \begin{align*}
    \Ker(\varphi)&=\Set{x\in V|\varphi(x)=0_V  },\\
    \Img(\varphi)&=\Set{\varphi(x)|x\in V}
  \end{align*}
  とおく. $\Ker(\varphi)$を$\varphi$のKernel,
  $\Img(\varphi)$を$\varphi$のImageと呼ぶ.
\end{definition}
\begin{prop}
  $(V,\plus,\act,0_V)$,
  $(W,\pplus,\aact,0_W)$を
  $\KK$-線形写像とし,
  $\varphi\colon V\to W$を線形写像とする.
このとき, 以下が成り立つ:
\begin{enumerate}
  \item $\Ker(\varphi)$は$V$の部分空間.
  \item $\Img(\varphi)$は$W$の部分空間.
\end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{definition}
  $(V,\plus,\act,0_V)$を$\KK$線形空間とし,
  $w_1,\ldots,w_r\in V$とする.
  線形写像
    \begin{align*}
      \shazo{\nu_{(w_1,\ldots,w_r)}}{\KK^r}{V}
      {\begin{pmatrix}a_1\\\vdots\\a_r\end{pmatrix}}{a_1\act w_1+\cdots+a_r\act w_r}
    \end{align*}
  の像$\Img(\nu_{(w_1,\ldots,w_r)})$を,
  $(w_1,\ldots,w_r)$で生成される$V$の部分空間と呼び,
  $\Braket{w_1,\ldots,w_r}_{\KK}$
  で表す.  
\end{definition}
\begin{remark}
  $(V,\plus,\act,0_V)$を$\KK$線形空間とし,
  $w_1,\ldots,w_r\in V$とする.
  このとき,
  $\Braket{w_1,\ldots,w_r}_{\KK}$
  は,
  $w_1,\ldots,w_r$を含む最小の$V$の部分空間である.
\end{remark}
\begin{proof}\end{proof}

\begin{example}
  $A\in \KK^{m\times n}$とし,
  \begin{align*}
    \shazo{\mu_A}{\KK^{n}}{\KK^{m}}
    {\aaa}{A\aaa}
  \end{align*}
  とすると, $\mu_A$
  は$\KK$線形写像.
  \begin{align*}
    \Ker(\mu_A)=\Set{\aaa\in\KK^n|A\aaa=\zzero_m}
  \end{align*}
  であり, これは斉次連立一次方程式の解空間である.
  また, $A=(\aaa_1|\cdots|\aaa_n)$と列ベクトル表示すると
  \begin{align*}
    \Img(\mu_A)=\Set{x_1\aaa_1+\cdots+x_n\aaa_n|x_1,\ldots,x_n\in \KK}
  \end{align*}
  である.
  %これは, $\Set{\aaa_1,\ldots,\aaa_n}$を含む最小の部分空間である.
\end{example}
\begin{proof}\end{proof}

\begin{example}
$\KK$を体とし,  
  \begin{align*}
    \shazo{\varphi}{\KK^{n\times n}}{\KK}
    {A}{\tr A}
  \end{align*}
  とすると, $\varphi$
  は線形写像.
  $\Ker(\varphi)$は, $I=\Set{1,\dots,n}$とすると,
  \begin{align*}
    \Ker(\varphi)=
    \Set{(a_{i,j})_{i\in I,j\in I} \in\KK^{n\times n}|\sum_{i\in I}a_{i,i}=0}
  \end{align*}
  である. 特に, $n=2$のときは,
  \begin{align*}
    \Ker(\varphi)=
    \Set{\begin{pmatrix}a&b\\c&-a\end{pmatrix}|a,b,c}
  \end{align*}
  である.
\end{example}

\begin{prop}
  \label{subspace:prop:img:inverseimage}
  $(V,\plus,\act,0_V)$,
  $(W,\pplus,\aact,0_W)$を
  $\KK$-線形写像とし,
  $\varphi\colon V\to W$を線形写像とする.
  \begin{enumerate}
  \item
    $V$の部分空間$V'$に対し,
    \begin{align*}
      \Set{\varphi(x)|x\in V'}
    \end{align*}
    は, $W$の部分空間である.
  \item
    $W$の部分空間$W'$に対し,
    \begin{align*}
      \Set{x\in V|\varphi(x)\in W'}
    \end{align*}
    は, $V$の部分空間である.
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}
\begin{remark}
  \Cref{subspace:prop:img:inverseimage}の
  $W'$として自明な部分空間$\Set{0_W}$を考えたものが,
  $\Ker(\varphi)$である.
  \Cref{subspace:prop:img:inverseimage}の
  $V'$として自明な部分空間$V$を考えたものが,
  $\Ker(\varphi)$である.
\end{remark}

\begin{prop}
  $(V,\plus,\act,0_V)$,
  $(W,\pplus,\aact,0_W)$を
  $\KK$-線形写像とし,
  $\varphi\colon V\to W$を線形写像とする.
  次は同値:
  \begin{enumerate}
  \item $\varphi$は単射.
  \item $\Ker(\varphi)=\Set{0_V}$
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $(V,\plus,\act,0_V)$,
  $(W,\pplus,\aact,0_W)$を
  $\KK$-線形写像とし,
  $\varphi\colon V\to W$を線形写像とする.
  次は同値:
  \begin{enumerate}
  \item $\varphi$は全射.
  \item $\Img(\varphi)=W$
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $(V,\plus,\act,0_V)$,
  $(W,\pplus,\aact,0_W)$を
  $\KK$-線形写像とし,
  $\varphi\colon V\to W$を線形写像とする.
  次は同値:
  \begin{enumerate}
  \item $\varphi$は$\underline{0_W}$.
  \item $\Ker(\varphi)=V$
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $(V,\plus,\act,0_V)$,
  $(W,\pplus,\aact,0_W)$を
  $\KK$-線形写像とし,
  $\varphi\colon V\to W$を線形写像とする.
  次は同値:
  \begin{enumerate}
  \item $\varphi$は$\underline{0_W}$.
  \item $\Img(\varphi)=\Set{0_W}$.
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$を$U$の部分空間とする.
  このとき,
  \begin{align*}
    \shazo{\iota}{V}{U}
    {v}{v}
  \end{align*}
  は, 単射な線形写像.
  特に, $V\simeq \Img(\iota)$.
\end{prop}
\begin{proof}\end{proof}


\section{部分空間ではない例}

\begin{example}
  \Cref{subspace:nonexample:cup}では,
  \begin{align*}
    V&=\Set{\begin{pmatrix}a\\0\end{pmatrix}|a\in\KK}\\
    W&=\Set{\begin{pmatrix}0\\a\end{pmatrix}|a\in\KK}
  \end{align*}
  とすると, $V\cup W$は$U$の部分空間ではないことを見た.
  この場合, 和が閉じておらず, $V\cup W$は$\KK$-線形空間ではないので,
  部分空間ではない.
\end{example}

\begin{example}
  \label{subsp:nonexample:fiber}
  $A\in \KK^{m\times n}$とする.
  つまり$A$を成分が$\KK$の元である$(m,n)$-行列とする.
  $\bbb\in \KK^m$とし,
  \begin{align*}
    \FFF_{\bbb}=\Set{\aaa\in \KK^n|A\aaa=\bbb}
  \end{align*}
  とおく.
  $\bbb\neq \zzero_m$なら,
  $\FFF_{\bbb}$は$\KK^n$の部分空間ではない.
  $\bbb= \zzero_m$なら,
  \Cref{subsp:example:fiber}で挙げたものである.
\end{example}
\begin{proof}\end{proof}



\begin{example}
  \label{subsp:nonexample:cc}
  $\CC$は$\CC$-線形空間である.
  $\RR$は$\RR$-線形空間である.
  どちらも同じ演算で線形空間であり
  $\RR\subset \CC$ではあるが,
  `$\KK$'が異なるので,
  $\RR$-線形空間$\RR$は$\CC$-線形空間の部分空間であるとは言わない.

  \Cref{subsp:example:cc}も見よ.
\end{example}
\begin{proof}\end{proof}

\begin{example}
  $\RR_{>0}=\Set{x\in\RR|x>0}$について考える.
  $\pplus$と$\aact$を次で定める:
  $x,y\in\RR_{>0}$に対し,
  \begin{align*}
    x\pplus y =x\cdot y.
  \end{align*}
  $a\in\RR$, $x\in\RR_{>0}$に対し,
  \begin{align*}
    a\aact x=x^a.
  \end{align*}
  このとき, $(\RR_{>0},\pplus,\aact,1)$は, $\RR$線形空間である.
  また, $\RR$は通常の和$+$と積$\cdot$で$\RR$線形空間である.
  $\RR_{>0}\subset \RR$であり, $\RR_{>0}$, $\RR$はどちらも, $\RR$-線形空間であるが, 演算が異なる.
  つまり, $\RR_{>0}$の演算は$\RR$の演算をそのまま流用したものではないので,
  $\RR_{>0}$は$\RR$の部分空間ではない.
\end{example}
\begin{proof}\end{proof}

\sectionX{章末問題}
\begin{quiz}
  列ベクトル表示された
  $(m,n)$行列
  $A=(\aaa_1|\cdots|\aaa_n)$
  を考える.
  このとき, 以下を(連立方程式の解の自由度に帰着させることで)示せ:
  \begin{enumerate}
  \item
    $\rank(A)\geq m$ならば,
   が成り立つ:
   \begin{enumerate}
   \item $\xx\in\KK^m$とする.
     このとき, $\xx=c_1\aaa_1+\cdots+c_n\aaa_n$を満たす
     $c_1,\ldots,c_n\in\KK$が存在する.
   \end{enumerate}
  \item
    $\rank(A)< n$ならば,
   が成り立つ:
   \begin{enumerate}
   \item 
     このとき, $\xx=c_1\aaa_1+\cdots+c_n\aaa_n=\zzero$かつ
     $(c_1,\ldots,c_n)\neq (0,\ldots,0)$を満たす
     $c_1,\ldots,c_n\in\KK$が存在する.
   \end{enumerate}
  \end{enumerate}
\end{quiz}


\chapter{基底}
\section{数ベクトル空間と標準基底}
$\KK$を体とする.
このとき$\KK^n$は$\KK$-線形空間であり,
数ベクトル空間と呼んだ.
第$i$成分のみ$1$で他は$0$である$\KK^n$の元
\begin{align*}
  \begin{pmatrix}0\\\vdots\\0\\1\\0\\\vdots\\0\end{pmatrix}
\end{align*}
を$\ee^{(n)}_i$で表し,
第$i$基本ベクトルと呼ぶ.
これらの組 $(\ee^{(n)}_1,\ee^{(n)}_2,\ldots,\ee^{(n)}_n)$を
$\KK^n$の標準基底と呼ぶ.
次のことが定義からわかる:
\begin{enumerate}
  \item
    $\sum_{i=1}^na_i\ee^{(n)}_i=\zzero$ならば, $a_1=\cdots=a_n=0$.
\item
    \begin{align*}
      \aaa=\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}\in\KK^n
    \end{align*}
    に対し, $\aaa=\sum_{i=1}^na_i\ee^{(n)}_i$.
\end{enumerate}


\section{有限次元線形空間の基底}
\subsection{定義}


\begin{definition}
  $(V,\plus,\act,0_V)$を$\KK$線形空間とし,
  $v_1,\ldots,v_r\in V$とする.
  次の条件を満たすとき,
  組$(v_1,\ldots,v_r)$が$\KK$上一次独立であるという:
  \begin{enumerate}
  \item $\alpha_1\act v_1\plus\cdots\plus \alpha_r\act v_r=0_V \implies \alpha_1=\cdots=\alpha_r=0$.
  \end{enumerate}
  $(v_1,\ldots,v_r)$が$\KK$上一次独立でないとき,
  $(v_1,\ldots,v_r)$が$\KK$上一次従属であるという.
\end{definition}

\begin{prop}
  $(V,\plus,\act,0_V)$を$\KK$線形空間とし,
  $v_1,\ldots,v_r\in V$とする.
  このとき以下は同値:
  \begin{enumerate}
  \item $(v_1,\ldots,v_r)$は$\KK$上一次独立.
  \item 線形写像
    \begin{align*}
      \shazo{\nu_{(v_1,\ldots,v_r)}}{\KK^r}{V}
      {\begin{pmatrix}a_1\\\vdots\\a_r\end{pmatrix}}{a_1\act v_1\plus\cdots\plus a_r\act v_r}
    \end{align*}
    が単射.
  \end{enumerate}
\end{prop}

\begin{remark}
  $D=(v_1,\ldots,v_r)$が一次独立であるとすると,
  $\mu_D$は単射線形写像であり,
  $D=(\mu_D(\ee^{(r)}_1)),\ldots,\mu_D(\ee^{(r)}_r)))$である.
  逆に, 単射線形写像$\varphi\colon \KK^r\to V$が与えられたとき,
  $D=(\varphi(\ee^{(r)}_1),\ldots,\varphi(\ee^{(r)}_r))$は一次独立である.
  したがって,
  一次独立な元の組を与えることと
  単射線形写像$\varphi\colon \KK^r\to V$を与えること
  は同じことである.
\end{remark}

\begin{prop}
  $(V,\plus,\act,0_V)$を$\KK$線形空間とし,
  $v_1,\ldots,v_r\in V$とする.
  このとき以下は同値:
  \begin{enumerate}
  \item $(v_1,\ldots,v_r)$は$\KK$上一次独立.
  \item $\alpha_1\act w_1\plus\cdots\plus \alpha_r\act v_r=\alpha'_1\act v_1\plus\cdots\plus \alpha'_r\act v_r \implies \alpha_1=\alpha'_1,\ldots,\alpha_r=\alpha'_r$.
  \end{enumerate}
\end{prop}
\begin{proof}
\begin{align*}
v&=\nu_{(v_1,\ldots,v_r)}(\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}), &
v'&=\nu_{(v_1,\ldots,v_r)}(\begin{pmatrix}a'_1\\\vdots\\a'_n\end{pmatrix}) 
\end{align*}
である. $\nu_{(v_1,\ldots,v_r)}$が単射であることから, すぐわかる.
\end{proof}

\begin{definition}
  $(V,\plus,\act,0_V)$を$\KK$線形空間とし,
  $v_1,\ldots,v_r\in V$とする.
  次の条件を満たすとき,
  組$(v_1,\ldots,v_r)$は$V$の生成系であるという.
  \begin{enumerate}
  \item
    すべての$v\in V$に対して次が成り立つ:
    \begin{enumerate}
    \item
    $\alpha_1\act v_1\plus \cdots \alpha_r\act v_r=v$
    を満たす$\alpha_1,\ldots,\alpha_r\in\KK$ が存在する.
    \end{enumerate}
  \end{enumerate}
\end{definition}
\begin{prop}
  $(V,\plus,\act,0_V)$を$\KK$線形空間とし,
  $v_1,\ldots,v_r\in V$とする.
  このとき以下は同値:
  \begin{enumerate}
  \item $(v_1,\ldots,v_r)$は$V$の生成系である.
  \item $V=\Braket{v_1,\ldots,v_r}_\KK$.
  \item 線形写像 $\nu_{(v_1,\ldots,v_r)}\colon \KK^r \to V$
    が全射.
  \end{enumerate}
\end{prop}
\begin{remark}
  $D=(v_1,\ldots,v_r)$が$V$の生成系であるとすると,
  $\mu_D$は全射線形写像であり,
  $D=(\mu_D(\ee^{(r)}_1)),\ldots,\mu_D(\ee^{(r)}_r)))$である.
  逆に, 全射線形写像$\varphi\colon \KK^r\to V$が与えられたとき,
  $D=(\varphi(\ee^{(r)}_1),\ldots,\varphi(\ee^{(r)}_r))$は$V$の生成系である.
  したがって,
  $V$の生成系を与えることと
  全射線形写像$\varphi\colon \KK^r\to V$を与えること
  は同じことである.
\end{remark}

\begin{prop}
  $V, U$を$\KK$線形空間とし,
  $(v_1,\ldots,v_r)$は$V$の生成系であるとする.
  線形写像$\varphi\colon V\to U$,
  $\psi\colon V\to U$に対し,
  以下は同値:
  \begin{enumerate}
  \item $\psi=\varphi$.
  \item すべての$i$に対し,  $\psi(v_i)=\varphi(v_i)$.
  \end{enumerate}
\end{prop}



\begin{definition}
  $V$を$\KK$線形空間とし,
  $v_1,\ldots,v_r\in V$とする.
  次の条件を満たすとき,
  組$(v_1,\ldots,v_r)$は$V$の基底であるという.
  \begin{enumerate}
  \item $(v_1,\ldots,v_r)$は一次独立.
  \item $(v_1,\ldots,v_r)$は$V$の生成系.
  \end{enumerate}
\end{definition}
\begin{prop}
  $V$を$\KK$線形空間とし,
  $v_1,\ldots,v_r\in V$とする.
  このとき以下は同値:
  \begin{enumerate}
  \item $(v_1,\ldots,v_r)$は$V$の基底である.
  \item 線形写像 $\nu_{(v_1,\ldots,v_r)}\colon \KK^r\to V$
    が同型写像.
  \end{enumerate}
\end{prop}
\begin{remark}
  $D=(e_1,\ldots,e_r)$が$V$の基底であるとすると,
  $\mu_D$は同型写像であり,
  $D=(\mu_D(\ee^{(r)}_1)),\ldots,\mu_D(\ee^{(r)}_r)))$である.
  逆に, 同型線形写像$\varphi\colon \KK^r\to V$が与えられたとき,
  $D=(\varphi(\ee^{(r)}_1),\ldots,\varphi(\ee^{(r)}_r))$は$V$の基底である.
  したがって,
  $V$の基底を与えることと
  同型写像$\varphi\colon \KK^r\to V$を与えること
  は同じことである.
\end{remark}

\begin{prop}
  $(e_1,\ldots,e_r)$を$V$の基底とする.
  $v\in V$とするとき,
  $v$は$e_1,\ldots,e_r$の線型結合として一意に書き表せる.
  つまり,
  $v=\alpha_1\act e_1\plus \ldots\plus \alpha_r\act e_r$
  を満たす$\alpha_1,\ldots, \alpha_r\in\KK$がただ一組存在する.
\end{prop}


\begin{lemma}
  $V$を$\KK$線形空間とし, $n>0$とする.
  次は同値である:
  \begin{enumerate}
  \item $\dim_\KK(V)=n$
  \item $(e_1,\ldots,e_n)$が$V$の基底となるような$e_1,\ldots,e_n\in V$が取れる.
  \end{enumerate}
\end{lemma}

\begin{cor}
  $V$を$\KK$線形空間とし,
  $(e_1,\ldots,e_r)$も
  $(e'_1,\ldots,e'_{r'})$も
  は$V$の基底であるとする.
  このとき, $r=r'=\dim_{\KK}(V)$.
\end{cor}



\subsection{例}
\begin{example}
  $\KK^n$の標準基底$(\ee^{(n)}_1,\ldots,\ee^{(n)}_n)$は,
  $\KK^n$の基底である.
\end{example}

\begin{example}
$\KK$を体とし,
  $\aaa_1,\ldots,\aaa_n\in \KK^m$とする.
  縦ベクトル$\aaa_1,\ldots,\aaa_n$を並べて得られる行列を$A$とする.
  このとき,
  \begin{enumerate}
  \item 次は同値:
    \begin{enumerate}
      \item $(\aaa_1,\ldots,\aaa_n)$は$\KK^m$の生成系.
      \item $\rank(A)=m$
    \end{enumerate}
  \item 次は同値:
    \begin{enumerate}
      \item $(\aaa_1,\ldots,\aaa_n)$は$\KK$上一次独立.
      \item $\rank(A)=n$.
    \end{enumerate}
  \item 次は同値:
    \begin{enumerate}
      \item $(\aaa_1,\ldots,\aaa_n)$は$\KK^m$の基底.
      \item $\rank(A)=m=n$.
      \item $A$は正則.
    \end{enumerate}
  \end{enumerate}
したがって,
$\KK^m$の基底は$m$次正則行列の分だけ選び方がある.
\end{example}
\begin{remark}
BasisとBasis elementの違い.
\end{remark}


\begin{example}
  $(k,l)$成分は$1$でそれ以外の成分は$0$である
  $\KK^{m\times n}$の元を$B_{k,l}$で表す.
  $B_{k,l}$のことを行列単位\footnote{単位行列と用語が紛らわしいが混同しないこと}と呼ぶこともある.
  このとき,
  $B_{k,l}$を全て集めた
  $(B_{1,1},\ldots,B_{1,n},B_{2,1},\ldots,B_{2,n},\ldots,B_{m,1},\ldots,B_{1,n})$は$\KK^{m\times n}$の基底である.
\end{example}

\begin{example}
  $\CC$は$\RR$線形空間であった.
  $(1,\sqrt{-1})$は$\CC$の基底である.
  したがって$\dim_\RR(\CC) = 2$である.
  また,
  $\CC$は$\CC$線形空間でもあった.
  $(1)$は$\CC$の基底である.
  したがって$\dim_\CC(\CC) = 1$である.
\end{example}


\begin{example}
  $V$を1次元$\KK$-線形空間であるとする.
  $v\in V\setminus \Set{0_V}$とすると,
  $(v)$は$V$の基底.
\end{example}

\begin{example}
双対基底.  $\Hom$の基底.
\end{example}

\subsection{生成系や一次独立な組の性質}
\begin{prop}
  $V$を$\KK$線形空間とする.
  $(0_V)$は一次従属.
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $\KK$を体とする.
  $V$を$\KK$ベクトル空間とする.
  $v\in V\setminus\Set{0_V}$に対し,
  $(v)$は一次独立.
  $\dim_\KK(V)=1$ならば, $(v)$は$V$の基底でもある.
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$を$\KK$線形空間とする.
  $\sigma\in S_n$とし,
  $B=(v_1,\ldots,v_n)$,
  $B'=(v_{\sigma(1)},\ldots,v_{\sigma(n)})$
  とする.
  このとき,
  \begin{enumerate}
  \item $B$が$\KK$上一次独立であることと, $B'$が$\KK$上一次独立であることは同値.
  \item $B$が$V$の生成系であることと,  $B'$が$V$の生成系であることは同値.
  \item $B$が$V$の基底であることと,  $B'$が$V$の基底であることは同値.  
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$を$\KK$線形空間とする.
  $v_i\in V$とし,
  $(v_1,\ldots, v_r)$が$\KK$上一次独立であるとする.
  このとき,
  $(v_{1},\ldots, v_{k})$は$\KK$上一次独立.
\end{prop}
\begin{proof}\end{proof}
\begin{prop}
  $V$を$\KK$線形空間とする.
  $v_i\in V$とし,
  $(v_1,\ldots, v_r)$が$V$の生成系であるとする.
  このとき,
  $w_1,\ldots,w_l\in V$に対し,
  $(v_{1},\ldots, v_{r},w_1,\ldots,w_l)$は$V$の生成系.
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $\KK$を体とし,
  $V$を$\KK$ベクトル空間とする.
  $v_1,\ldots, v_r\in V$が次の条件を満たすとする:
  \begin{enumerate}
  \item $(v_1,\ldots, v_r)$は$\KK$上一次独立.
  \item $v\in V\implies (v_1,\ldots, v_r,v)$は$\KK$上一次従属.
  \end{enumerate}
  このとき,
  $(v_1,\ldots, v_r)$は$V$の基底.
\end{prop}
\begin{proof}\end{proof}



\begin{prop}
  $\KK$を体とし,
  $V$を$\KK$ベクトル空間とする.
  $v_1,\ldots, v_r\in V$が次の条件を満たすとする:
  \begin{enumerate}
  \item $(v_1,\ldots, v_r)$は$V$の生成系.
  \item $i\in \Set{1,\ldots,r}\implies (v_1,\ldots, v_{i-1},v_{i+1},\ldots,v_r)$は$V$の生成系ではない.
  \end{enumerate}
  このとき,
  $(v_1,\ldots, v_r)$は$V$の基底.
\end{prop}
\begin{proof}\end{proof}
\begin{cor}
  $\KK$を体とし,
  $V$を有限次元$\KK$ベクトル空間とする.
  \begin{align*}
  \dim_\KK(V)
  &=\max\Set{r|\text{$(v_1,\ldots,v_r)$は$\KK$上一次独立}}\\
  &=\min\Set{r|\text{$(v_1,\ldots,v_r)$は$V$の生成系}}.
  \end{align*}
\end{cor}
\begin{proof}\end{proof}

%% \begin{prop}
%%   $V$を$\KK$線形空間とする.
%%   次は同値:
%%   \begin{enumerate}
%%   \item $\dim_{\KK}(V)=n$.
%%   \item $\max\Set{r|(v_1,\ldots,v_r)\text{は一次独立}}=n$.
%%   \item $(v_1,\ldots, v_r)$が極大な一次独立な組なら$n=r$.
%%   \item $\min\Set{r|(v_1,\ldots,v_r)\text{は$V$の生成系}}=n$.
%%   \item $(v_1,\ldots, v_r)$が極小な$V$の生成系なら$n=r$.
%%   \end{enumerate}
%% \end{prop}


\begin{prop}
$\KK$を体とし,
  $V$を$\KK$ベクトル空間とする.
  $(v_1,\ldots, v_r)$は$\KK$上一次独立であるとする.  
  $V\neq\Braket{v_1,\ldots, v_r}_\KK\neq \emptyset$とする.
  このとき, $w\in V\setminus\Braket{v_1,\ldots, v_r}_\KK$に対し,
  $(v_1,\ldots,v_{r},w)$は$\KK$上一次独立.
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
$\KK$を体とし,
  $V$を$\KK$ベクトル空間とする.
  $(v_1,\ldots, v_r)$,
  $(w_1,\ldots, w_n)$はどちらも,
  $\KK$上一次独立であるとする.  
$r<n$とする.
このとき, 次を満たす$i$が存在する.
\begin{enumerate}
\item $(v_1,\ldots,v_{r},w_{i})$が$V$の基底.
\end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $\KK$を体とし,
  $V$を$\KK$ベクトル空間とする.
  $(e_1,\ldots, e_n)$,
  $(e'_1,\ldots, e'_n)$が
  $V$の基底であるとする.
$\Set{e_1,\ldots, e_n}\neq \Set{e'_1,\ldots, e'_n}$
とする.
このとき, 次を満たす$i$, $j$が存在する.
\begin{enumerate}
\item $e'_i \not\in \Set{e_1,\ldots,e_n}$.
\item $(e_1,\ldots,e_{i-1},e'_{j},e_{i+1},\ldots,e_n)$が$V$の基底.
\end{enumerate}
\end{prop}
\begin{proof}\end{proof}


%%%%%%%%%%%%% Matroid property
\section{線形写像と生成系, 一次独立性}
\begin{prop}
  $V$, $W$を$\KK$-線形空間とし,
  $\varphi\colon V\to W$を線形写像とする.
  このとき以下は同値:
  \begin{enumerate}
  \item $\varphi$が単射.
  \item $n\in \NN$, $v_1,\ldots,v_n\in V$,
    $(v_1,\ldots,v_n)$が$\KK$上一次独立
    $\implies (\varphi(v_1),\ldots,\varphi(v_n))$は$\KK$上一次独立.
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$, $W$を$\KK$-線形空間とし,
  $\varphi\colon V\to W$を線形写像とする.
  このとき以下は同値:
  \begin{enumerate}
  \item $\varphi$が全射.
  \item $n\in \NN$, $v_1,\ldots,v_n\in V$,
    $(v_1,\ldots,v_n)$が$V$の生成系
    $\implies (\varphi(v_1),\ldots,\varphi(v_n))$は$W$の生成系.
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$, $W$を$\KK$-線形空間とし,
  $(v_1,\ldots,v_n)$を$V$の生成系とする.
  $\varphi\colon V\to W$,
  $\psi\colon V\to W$,
  を線形写像とする.
  \begin{enumerate}
  \item $\varphi=\psi$.
  \item $\varphi(v_1)=\psi(v_1)$,\ldots,$\varphi(v_n)=\psi(v_n)$.
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{cor}
  $V$, $W$を$\KK$-線形空間とし,
  $(e_1,\ldots,e_n)$を$V$の基底とする.
  $\varphi\colon V\to W$,
  $\psi\colon V\to W$,
  を線形写像とする.
  \begin{enumerate}
  \item $\varphi=\psi$.
  \item $\varphi(e_1)=\psi(e_1),\ldots,\varphi(e_n)=\psi(e_n)$.
  \end{enumerate}
\end{cor}
\begin{proof}\end{proof}

\begin{cor}
  $V$, $W$を$\KK$-線形空間とし,
  $(e_1,\ldots,e_n)$を$V$の基底とする.
  $w_i\in W$とする.
  このとき,
  $\KK$線形写像$\varphi\colon V\to W$
  次の条件を満たすものがただ一つ存在する:
  \begin{enumerate}
  \item $\varphi(e_1)=w_1,\ldots,\varphi(e_n)=w_n$.
  \end{enumerate}
\end{cor}
\begin{proof}\end{proof}


\section{基底の延長}
\begin{prop}
  $U$を$\KK$-線形空間とし,
  $V$を$U$の部分空間とする.
  このとき,  $\dim_\KK(V) \leq \dim_\KK(U)$.
\end{prop}
\begin{proof}\end{proof}


\begin{prop}
\label{prop:basis:ext}
  $\KK$を体とし,
  $U$をベクトル空間とし,
  $V$を$U$の部分空間とする.
  $(e_1,\ldots,e_n)$を$V$の基底とする.
  このとき,
  $m\in \NN$,
  $w_1,\ldots,w_m\in U$で,
  $(e_1,\ldots,e_n,w_1,\ldots,w_m)$が$U$の基底となるものが
  存在する.  
\end{prop}
\begin{proof}\end{proof}
\begin{remark}
\Cref{prop:basis:ext}で得られる$U$の基底
  $(e_1,\ldots,e_n,w_1,\ldots,w_m)$
  を,
  $V$の基底$(e_1,\ldots,e_n)$を延長して得られる$U$の基底と呼ぶことがある.
\end{remark}

\begin{cor}
$\KK$を体とし,
  $U$をベクトル空間とし,
  $V$を$U$の部分空間とする.
  このとき, 以下は同値:
  \begin{enumerate}
   \item $V = U$.
   \item $\dim_\KK(V) = \dim_\KK(U)$.
  \end{enumerate}
\end{cor}
\begin{proof}\end{proof}

\begin{prop}
$\KK$を体とする.
  $U$をベクトル空間とし, $V$を$U$の部分空間とする.
  このとき, $U$の部分空間$W$で,
  $U=V\oplus W$と内部直和に$U$を分解するものがある.
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $U$を$\KK$-線形空間とし,
  $V, W$を$U$の部分空間とする.
  $(e_1,\ldots,e_n)$を$V$の基底,
  $(w_1,\ldots,w_m)$を$W$の基底とする.
  $U=V\oplus W$と内部直和に分解されるとき,
  $(e_1,\ldots,e_n,w_1,\ldots,w_m)$
  は$U$の基底である.
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$, $W$を有限次元ベクトル空間とする.
  $\varphi\colon V\to W$を線形写像とする.
  $\dim_\KK(V)=\dim_\KK(W)$のとき, 以下は同値:
  \begin{enumerate}
  \item $\varphi$は同型写像.
  \item $\varphi$は全単射.
  \item $\varphi$は全射.
  \item $\varphi$は単射.
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}





\sectionX{章末問題}
\begin{quiz}
  %\solvelater{quiz:1:1}
\end{quiz}

\chapter{商空間}
\section{商空間}
$(U,\plus,\act)$を$\KK$線形空間とし,
$V$を$U$の部分空間とする.
$u\in U$に対し,
\begin{align*}
  [u]_V=\Set{u\plus v|v\in V}
\end{align*}
とする.
\begin{example}
$U=\RR^2$, $V=\Set{\begin{pmatrix}t\\t\end{pmatrix}|t\in\RR}$
  とする. $V$は$U$の部分空間であり,
  $\begin{pmatrix}1\\1\end{pmatrix}$と原点を通る直線である.
  $\aaa=\begin{pmatrix}a_1\\a_2\end{pmatrix}$
  とすると,
  $[\aaa]_V$は$\aaa$を通り$V$に平行な直線である.
  たとえば,
  \begin{align*}
    \aaa=\begin{pmatrix}a\\0\end{pmatrix}\\
    \aaa'=\begin{pmatrix}0\\-a\end{pmatrix}
  \end{align*}
  とすると,
  \begin{align*}
    [\aaa]_V=[\aaa']_V=\Set{\begin{pmatrix}a+t\\t\end{pmatrix}|t\in\RR}
  \end{align*}
  である.
  \begin{figure}\caption{}\end{figure}
\end{example}
\begin{lemma}
$v\in V$ならば, $[v]_V=V$.
とくに,  $[0_U]_V=V$.
\end{lemma}
\begin{proof}
定義から明白.
\end{proof}
\begin{lemma}
$u,v\in U$に対し, 以下は同値:
\begin{enumerate}
\item $[u]_V=[v]_V$.
\item $u-v \in V$.
\end{enumerate}
\end{lemma}
\begin{proof}\end{proof}

\begin{lemma}
\label{lem:quotientspace:well:def}
  $u,u',w,w'\in U$, $\alpha \in \KK$に対し, 以下が成り立つ:  
  \begin{enumerate}
  \item $[u]_V=[u']_V, [w]_V=[w']_V \implies [u\plus w]_V=[u'\plus w']_V$.
  \item $[u]_V=[u']_V \implies [\alpha\act u]_V=[\alpha\act u']_V$.
  \end{enumerate}
\end{lemma}
\begin{proof}\end{proof}

\begin{align*}
  U/V=\Set{[u]_V|u\in U}
\end{align*}
とおく.
\Cref{lem:quotientspace:well:def}
より,
$[u]_V,[w]_V\in U/V$, $\alpha\in\KK$に対し
\begin{align*}
[u]_V\pplus [w]_V &= [u\plus w]_V\\
\alpha\aact [u]_V &= [\alpha\act u]_V
\end{align*}
とすると,
$\pplus$, $\aact$は
$U/V$上の演算として定義できる.
\begin{lemma}
  $(U/V,\pplus,\aact,[0_U]_V)$
  は$\KK$線形空間.
\end{lemma}
\begin{proof}\end{proof}
\begin{definition}
  $\KK$線形空間
  $(U/V,\pplus,\aact,[0_U]_V)$
  を$U$の$V$による剰余空間, 商空間と呼ぶ.
\end{definition}

\begin{remark}
  ここでは,
  議論をはっきりさせるため,
  剰余空間の演算を
  $\pplus,\aact$という記号で書いたが,
  通常は,
  剰余空間の演算を
  もとの空間と同じ記号を用いる.
  つまり,
  \begin{align*}
    [u]_V\plus [w]_V&=[u \plus w]_V=\Set{u \plus w \plus v|v\in V}, \\
    \alpha \act [u]_V&=[\alpha \act u]_V=\Set{\alpha\act u|v\in V}
  \end{align*}
  とする.
\end{remark}

\begin{prop}
$U$を$\KK$線形空間とし,
$V$を$U$の部分空間とする.
このとき,
\begin{align*}
\shazo{\varpi}{U}{U/V}
{u}{[u]_V}
\end{align*}
は全射$\KK$線形写像であり,
$\Ker(\varpi)=V$である.
\end{prop}
\begin{proof}\end{proof}

\begin{theorem}
  \label{thm:dim:quotient}
  $V$を$U$の部分空間とする.
  $e_1,\ldots, e_n,w_1,\ldots,w_m\in U$とし,
  $(e_1,\ldots, e_n)$は$V$の基底,
  $(e_1,\ldots, e_n,w_1,\ldots, w_m)$は$U$の基底であるとする.
  このとき,
  \begin{align*}
    ([w_1]_V,\ldots, [w_m]_V)
  \end{align*}
  は$U/V$の基底.
  とくに, $\dim_\KK(U/V)=\dim_\KK(U)-\dim_\KK(V)$.
\end{theorem}
\begin{proof}
  \begin{align*}
    \shazo{\varphi}{\KK^m}{U/V}
          {\begin{pmatrix}a_1\\\vdots\\a_m\end{pmatrix}}
          {a_1\act [w_1]_V\plus \cdots \plus a_m\act [w_m]_V}
  \end{align*}
  は線形写像である.
  これが同型写像であることを示す.
  \paragraph{全射性}
  $[u]_V\in U/V$とする.
  $(e_1,\ldots, e_n,w_1,\ldots, w_m)$は$U$の基底であるので,
  $u=\sum_{i}a_i\act e_i\plus\sum_{i}b_i \act w_i$
  とかける.
  そこで,
  $w=\sum_{i}b_i \act w_i$
  とおく.
  このとき$v=u-w$とおくと$v\in V$である.
  したがって, $[u]_V=[w]_V$である.
  よって,
  \begin{align*}
    [u]_V
    &=[w]_V\\
    &=[\sum_{i}b_i \act w_i]_V\\
    &=\sum_{i}b_i \act[ w_i]_V\\
    &=\varphi(\begin{pmatrix}b_1\\\vdots\\b_m\end{pmatrix})\\
  \end{align*}
  \paragraph{単射性}
  $\Ker(\varphi)\subset\Set{\zzero_m}$を示す.
  $\varphi(\begin{pmatrix}b_1\\\vdots\\b_m\end{pmatrix})=[0_U]_V$
  とする.
  このとき,
  $[\sum_{i}b_i \act w_i]_V=[0_U]_V$
  であるので, $\sum_{i}b_i \act w_i\in V$である.
  $(e_1,\ldots, e_n)$は$V$の基底であるから,
  $\sum_{i}b_i \act w_i=\sum_{i}a_i\act v_i$
  となる$a_i\in \KK$が存在するが,
  移項すると,
  $-\sum_{i}a_i\act e_i\plus\sum_{i}b_i \act w_i=0_U$
  となる.
  $(v_1,\ldots, v_n,w_1,\ldots, w_m)$は一次独立であるので,
  $a_1=\cdots=a_n=b_1=\cdots=b_m=0$.
  よって
  $\begin{pmatrix}b_1\\\vdots\\b_m\end{pmatrix}=\zzero_m$.
\end{proof}

\section{次元定理}
\begin{theorem}
  \label{thm:fund:hom}
  $\varphi\colon U \to W$を$\KK$-線形写像とする.
  このとき,
  $U/\Ker(\varphi)\simeq \Img(\varphi)$.
\end{theorem}
\begin{proof}
  $V=\Ker(\varphi)$とする.
  
  $[u]_V=[u']_V$とすると, $u-u'\in V=\Ker(\varphi)$であるので,
  $\varphi(u-u')=0_W$である.
  よって, $\varphi(u)-\varphi(u')=0_W$であるから,
  $\varphi(u)=\varphi(u')$.
  したがって, $\Phi([u]_V)=\varphi(u)$
  と定めると,
  $\Phi$は$U/V$から$\Img(\varphi)$への写像となる.
  \begin{align*}
    \shazo{\Phi}{U/V}{\Img(\varphi)}
    {[u]_V}{\varphi(u)}
  \end{align*}
  が同型写像であることを示す.
  \paragraph{線型性}
  \begin{align*}
    \Phi([u]_V\plus [u']_V)&=\Phi([u\plus u']_V)=\varphi(u\plus u')=\varphi(u)\plus \varphi(u')\\
    \Phi([u]_V)\plus \Phi([u']_V)&=\varphi(u)\plus \varphi(u')\\
    \Phi(\alpha\act [u]_V)&=\Phi([\alpha\act u]_V)\varphi(\alpha\act u)=\alpha\act \varphi(u)\\
    \alpha\act \Phi([u]_V)&=\alpha\act \varphi(u)
  \end{align*}
  であるので, $\Phi$は線形写像.
  \paragraph{単射性}
  $\Phi([u]_V)=\Phi([u']_V)$とする.
  このとき, $\varphi(u)=\varphi(u')$であるので,
  $\varphi(u)-\varphi(u')=0_W$である.
  よって,
  $\varphi(u-u')=0_W$であるから,
  $u-u'\in \Ker(\varphi)=V$.
  したがって, $[u]_V=[u']_V$.
  
  \paragraph{全射性}
  $\varphi(u)\in \Img(\varphi)$とする.
  このとき, $\Phi([u]_V)=\varphi(u)$であるので,
  $\Phi$は全射である.
\end{proof}

\begin{cor}
$U=V\oplus W$
  であるとき, $U/V\simeq W$.
\end{cor}
\begin{proof}
$U=V\oplus W$であるので,
  $u\in U$に対し,
  $u=v+w$となる$v\in V$, $w\in W$がただ一組存在するので,
  この, $w$を$\varphi(u)$とおく.
  このとき,
  \begin{align*}
    \shazo{\varphi}{U}{W}{u}{\varphi(u)}
  \end{align*}
  は線形写像である.
  その定義から, $\Img(\varphi)=W$, $\Ker(\varphi)=V$であるので,
  \Cref{thm:fund:hom}より $U/V\simeq W$.
\end{proof}


\begin{cor}
  $V$を有限次元ベクトル空間とし,
  $\varphi\colon V\to W$を線形写像とする.
  このとき,
  $\dim_{\KK}(\Img(\varphi))+\dim_{\KK}(\Ker(\varphi))=\dim_{\KK}(V)$.
\end{cor}
\begin{proof}
  \Cref{thm:fund:hom}より $V/\Ker(\varphi) \simeq \Img(\varphi)$.
  したがって,
  $\dim_{\KK}(V/\Ker(\varphi))=\dim_{\KK}(\Img(\varphi))$.
  \Cref{thm:dim:quotient}より,
  $\dim_{\KK}(V/\Ker(\varphi))=\dim_{\KK}(V)-\dim_{\KK}(\Ker(\varphi))$
  であるので,
  $\dim_{\KK}(\Img(\varphi))+\dim_{\KK}(\Ker(\varphi))=\dim_{\KK}(V)$.
\end{proof}



\begin{prop}
  $U$をベクトル空間とし, $V$, $W$を$U$の部分空間とする.
  このとき,  $\dim_\KK(V+W)=\dim_\KK(V)+\dim_\KK(W) - \dim_\KK(W\cap V)$.
\end{prop}

\begin{cor}
  $U$をベクトル空間とし, $V$, $W$を$U$の部分空間とする.
  このとき, 以下は同値:
  \begin{enumerate}
  \item $V+W=V\oplus W$.
  \item $\dim_\KK(V+W)=\dim_\KK(V)+\dim_\KK(W)$.
  \end{enumerate}
\end{cor}

%% \begin{cor}
%%   $U$を$n$次元$\KK$線形空間とし,
%%   $U=V_1\oplus \cdots \oplus V_n$と
%%   $n$個の1次元部分空間の内部直和に分解されるとする.
%%   $v_i\in V_i \setminus \Set{0}$とすると,
%%   $(v_1,\ldots,v_n)$は$U$の基底.
%% \end{cor}


\begin{prop}
  $V$を$\KK$線形空間とし,
  $v_1,\ldots, v_n\in V$とする.
  また,
  $V_i=\Braket{v_i}_\KK=\Set{\alpha \act v_i|\alpha \in\KK}$とする.
  このとき, 以下は同値:
  \begin{enumerate}
  \item $(v_1,\ldots, v_n)$は$V$の生成系.
  \item $V=V_1+\cdots + V_k$.
  \end{enumerate}
\end{prop}

\begin{prop}
  $V$を$\KK$線形空間とし,
  $v_1,\ldots, v_n\in V\setminus\Set{0_V}$とする.
  また,
  $V_i=\Braket{v_i}_\KK=\Set{\alpha \act v_i|\alpha\in\KK}$とし,
  $U=V_1+\cdots + V_k$とする.
  このとき, 以下は同値:
  \begin{enumerate}
  \item $(v_1,\ldots, v_n)$は一次独立.
  \item $U$は$U=V_1\oplus\cdots \oplus V_k$と内部直和に分解される.
  \end{enumerate}
\end{prop}

\begin{prop}
  $V$を$\KK$線形空間とし,
  $v_1,\ldots, v_n\in V\setminus\Set{\zzero}$とする.
  また,
  $V_i=\Braket{v_i}_\KK=\Set{\alpha \act v_i|\alpha \in\KK}$とする.
  このとき, 以下は同値:
  \begin{enumerate}
  \item $(v_1,\ldots, v_n)$は$V$の基底.
  \item $V$は$V=V_1\oplus\cdots \oplus V_k$と内部直和に分解される.
  \end{enumerate}
\end{prop}

\sectionX{章末問題}
\begin{quiz}
  %\solvelater{quiz:1:1}
\end{quiz}




\chapter{表現行列}
\section{数ベクトル空間上の線形写像}
$\KK^n$から$\KK^m$への$\KK$-線形写像について考える.
%% \begin{lemma}
%%   $\varphi\colon \KK^n\to \KK^m$,
%%   $\psi\colon \KK^n\to \KK^m$を$\KK$-線形写像とする.
%%   すべての$i$に対し, $\varphi(\ee^{(n)}_i)=\psi(\ee^{(n)}_i)$とする.
%%   このとき,
%%   $\varphi=\psi$.
%% \end{lemma}
%% \begin{proof}
%%   \begin{align*}
%%     \aaa=\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}
%%     \in\KK^n
%% \end{align*}
%% とする. このとき, $\aaa=a_1\ee^{(n)}_1+\cdots+a_n\ee^{(n)}_n$である.
%%   \begin{align*}
%%     \varphi(\aaa)&=\varphi(a_1\ee^{(n)}_1+\cdots+a_n\ee^{(n)}_n)\\
%%     &=a_1\varphi(\ee^{(n)}_1)+\cdots+a_n\varphi(\ee^{(n)}_n).\\
%%     \psi(\aaa)
%%     &=\psi(a_1\ee^{(n)}_1+\cdots+a_n\ee^{(n)}_n)\\
%%     &=a_1\psi(\ee^{(n)}_1)+\cdots+a_n\psi(\ee^{(n)}_n).
%%   \end{align*}
%%   よって$\varphi(\aaa)=\psi(\aaa)$.
%% \end{proof}

%% \begin{lemma}
%%   $\aaa_1,\ldots,\aaa_n\in \KK^m$とする.
%%   このとき,
%%   \begin{align*}
%%     \shazo{\varphi}{\KK^n}{\KK^m}
%%           {\begin{pmatrix}x_1\\\vdots\\x_n\end{pmatrix}}
%%           {x_1\aaa_1+\cdots+x_n\aaa_n}
%%   \end{align*}
%%   とすると, これは線形写像.
%%   また, $A$を$\aaa_1,\ldots,\aaa_n$を並べた$(m,n)$-行列とする.
%%   つまり, $A=(\aaa_1|\cdots|\aaa_n)$とする.
%%   このとき, $\varphi(\xx)=A\xx$.
%% \end{lemma}
%% \begin{proof}\end{proof}

$A\in\KK^{m\times n}$に対して,
\begin{align*}
  \shazo{\mu_A}{\KK^n}{\KK^m}
        {\xx}
        {A\xx}
\end{align*}
とおくと, これは$\KK$-線形写像であった.
また, 線形写像$\varphi\colon \KK^n\to \KK^m$に対し,
$\varphi(e^{(n)}_1),\ldots,\varphi(e^{(n)}_n)\in\KK^m$を並べて得られる
行列を$A$と置くと,
$\varphi=\mu_A$であった.
よって, 
$\KK^n$から$\KK^m$への$\KK$-線形写像を考えるなら,
$A\in\KK^{m\times n}$に対して,
\begin{align*}
  \shazo{\mu_A}{\KK^n}{\KK^m}
        {\xx}
        {A\xx}
\end{align*}
を考えれば十分である.

\begin{prop}
  $A,A'\in \KK^{m\times n}$,
  $B\in\KK^{l\times m}$,
  $\alpha \in\KK$に対し, 以下が成り立つ:
  \begin{enumerate}
  \item $\mu_{A+A'}=\mu_A+\mu_{A'}$.
  \item $\mu_{\alpha A}=\alpha\mu_A$.
  \item $\mu_{BA}=\mu_B\circ\mu_{A}$.
  \item $\mu_{E_n}=\id_{\KK^n}$
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{cor}
  $A\in \KK^{n\times n}$とする.
  このとき,
  以下は同値:
  \begin{enumerate}
  \item $A$が正則
  \item $\mu_A$は同型写像.
  \end{enumerate}
\end{cor}
\begin{proof}\end{proof}


\begin{prop}
  $A\in\KK^{m\times n}$とする.
  $A=(\aaa_1|\cdots|\aaa_n)$とすると,
  以下が成り立つ:
  \begin{enumerate}
  \item $\Img(\mu_A)=\Braket{\aaa_1,\ldots,\aaa_n}_{\KK}$.
  \item $\Ker(\mu_A)=\Set{\xx\in\KK^n|A\xx=\zzero_m}$. つまり, $\Ker(\mu_A)$は,
    方程式$A\xx=\zzero_m$の解の空間.
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{cor}
  $\KK$を体とし,
  $A\in\KK^{m\times n}$とする.
  このとき,
  以下が成り立つ:
  \begin{enumerate}
  \item $\dim_\KK(\Img(\mu_A))=\rank(A)$.
  \item $\dim_\KK(\Ker(\mu_A))$は
    方程式$A\xx=\zzero_m$の解の自由度, つまり$n-\rank(A)$.
  \end{enumerate}
\end{cor}
\begin{proof}\end{proof}

\begin{cor}
  $\KK$を体とし,
  $A\in\KK^{m\times n}$とする.
  このとき,
  以下が成り立つ:
  \begin{enumerate}
  \item $\rank(A)=m \implies \mu_A$は全射.
  \item $\rank(A)=n \implies \mu_A$は単射.
  \item $\rank(A)=n=m\implies \mu_A$は同型写像.
  \end{enumerate}
\end{cor}
\begin{proof}\end{proof}



\section{表現行列}
$(V,\plus,\act)$を$\KK$-線形空間とし, $v_1,\ldots,v_n\in V$とする.
このとき,
\begin{align*}
    \shazo{\nu_{(v_1,\ldots,v_n)}}{\KK^n}{V}
          {\begin{pmatrix}x_1\\\vdots\\x_n\end{pmatrix}}
          {x_1\act v_1\plus \cdots\plus x_n\act v_n}
\end{align*}
とする.
$(v_1,\ldots,v_n)$が$V$の基底であるとき,
$\nu_{(v_1,\ldots,v_n)}$は同型写像である.

\begin{definition}
  $V$, $W$を$\KK$-線形空間とし,
  $D=(e_1,\ldots,e_n)$を$V$の基底,
  $B=(w_1,\ldots,w_m)$を$W$の基底とする.
  $\KK$-線形写像$\varphi\colon V\to W$に対し,
  $(\nu_B)^{-1}\circ \varphi\circ \nu_D$は,
  $\KK^n$から $\KK^m$への$\KK$-線形写像である.
  $\mu_A=(\nu_B)^{-1}\circ \varphi\circ \nu_D$
  を満たす$A\in\KK^{m\times n}$を$\varphi$の$D$, $B$に関する
  表現行列と呼ぶ.
\end{definition}
\begin{prop}
  $V$, $W$を$\KK$-線形空間とし,
  $D=(e_1,\ldots,e_n)$を$V$の基底,
  $B=(w_1,\ldots,w_m)$を$W$の基底とする.
  $\varphi\colon V\to W$を$\KK$-線形写像とし,
  $A\in\KK^{m\times n}$を$\varphi$の$D$, $B$に関する表現行列とする.
このとき,
\begin{align*}
  \varphi=\nu_B\circ \mu_A\circ (\nu_{D})^{-1}
\end{align*}
である.
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$, $W$を$\KK$-線形空間とし,
  $D=(e_1,\ldots,e_n)$を$V$の基底,
  $B=(w_1,\ldots,w_m)$を$W$の基底とする.
  $\varphi\colon V\to W$を$\KK$-線形写像とし,
  $A\in\KK^{m\times n}$を$\varphi$の$D$, $B$に関する表現行列とする.
  また,
  $\varphi(e_j)=\sum_{i=1}^m a_{i,j} w_i$
  とする.
  このとき,
\begin{align*}
  A=(a_{i,j})_{i\in I, j\in J}
\end{align*}
ただし,
$I=\Set{1,\ldots,m}$,
$J=\Set{1,\ldots,m}$.
\end{prop}
\begin{proof}\end{proof}


\begin{prop}
  $V$, $W$を$\KK$-線形空間とし,
  $D=(e_1,\ldots,e_n)$を$V$の基底,
  $B=(w_1,\ldots,w_m)$を$W$の基底とする.
  $\varphi\colon V\to W$を$\KK$-線形写像とし,
  $A\in\KK^{m\times n}$を$\varphi$の$D$, $B$に関する表現行列とする.
このとき,
\begin{align*}
  \varphi(e_j)=\sum_{i=1}^m a_{i,j}w_i
\end{align*}
である.
つまり,
\begin{align*}
  \varphi(\sum_{j=1}^n x_j e_j)
  &=\sum_{i=1}^m a_{i,j}x_jw_i.
\end{align*}
\end{prop}
\begin{proof}\end{proof}


\begin{prop}
  $V$, $W$, $U$を$\KK$-線形空間とし,
  $D=(e_1,\ldots,e_n)$を$V$の基底,
  $B=(w_1,\ldots,w_m)$を$W$の基底,
  $C=(u_1,\ldots,u_l)$を$U$の基底
  とする.
  $\varphi\colon V\to W$を$\KK$-線形写像とし,
  $F\in\KK^{m\times n}$を$\varphi$の$D$, $B$に関する表現行列とする.
  $\varphi'\colon V\to W$を$\KK$-線形写像とし,
  $F'\in\KK^{m\times n}$を$\varphi'$の$D$, $B$に関する表現行列とする.
  $\psi\colon W\to U$を$\KK$-線形写像とし,
  $G\in\KK^{m\times n}$を$\psi$の$B$, $C$に関する表現行列とする.
  $\alpha\in \KK$とする.
このとき,
\begin{enumerate}
  \item $\varphi+\varphi'$の$B$, $D$に関する表現行列は$F+F'$.
  \item $\alpha\varphi$の$B$, $D$に関する表現行列は$\alpha F$.
  \item $\psi\varphi'$の$B$, $C$に関する表現行列は$GF$.
\end{enumerate}
\end{prop}
\begin{proof}\end{proof}



\begin{prop}
  $V$, $W$を$\KK$-線形空間とし,
  $D=(e_1,\ldots,e_n)$を$V$の基底,
  $B=(w_1,\ldots,w_m)$を$W$の基底
  とする.
  $\varphi\colon V\to W$を$\KK$-線形写像とし,
  $A\in\KK^{m\times n}$を$\varphi$の$D$, $B$に関する表現行列とする.
  このとき,
\begin{enumerate}
  \item $\Img(\varphi)=\Set{\nu_B(\xx) |\xx\in \Img(\mu_A)}$.
  \item $\Ker(\varphi)=\Set{\nu_D(\xx) |\xx\in \Ker(\mu_A)}$.
\end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$, $W$を$\KK$-線形空間とし,
  $D=(e_1,\ldots,e_n)$を$V$の基底,
  $B=(w_1,\ldots,w_m)$を$W$の基底
  とする.
  $\varphi\colon V\to W$を$\KK$-線形写像とし,
  $A\in\KK^{m\times n}$を$\varphi$の$D$, $B$に関する表現行列とする.
  このとき,
\begin{enumerate}
  \item $\dim_\KK\Img(\varphi)=\rank(A)$.
  \item $\dim_\KK\Ker(\varphi)=n-\rank(A)$.
\end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $\KK$を体とし,
  $V$, $W$を$\KK$-ベクトル空間とし,
  $D=(e_1,\ldots,e_n)$を$V$の基底,
  $B=(w_1,\ldots,w_m)$を$W$の基底
  とする.
  $\varphi\colon V\to W$を$\KK$-線形写像とし,
  $A\in\KK^{m\times n}$を$\varphi$の$D$, $B$に関する表現行列とする.
  このとき,
\begin{enumerate}
  \item $\rank(A)=m\implies \varphi$は全射.
  \item $\rank(A)=n\implies \varphi$は単射.
  \item $\rank(A)=m=n\implies \varphi$は同型写像.
\end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\section{基底の変換行列と表現行列}

\begin{definition}
  $V$を$n$次元$\KK$-線形空間とする.
  $D,D'$を$V$の基底とする.
  このとき, $(\nu_{D'})^{-1}\circ\nu_{D}$は$\KK^n$から$\KK^n$への線形写像
  である.
  $\mu_T=(\nu_{D'})^{-1}\circ\nu_{D}$
  となる$T\in\KK^{n\times n}$を基底$D'$から基底$D$への変換行列と呼ぶ.
\end{definition}
\begin{remark}
  $T\in\KK^{n\times n}$を基底$D'$から基底$D$への変換行列とするとき,
  $\mu_T=(\nu_{D'})^{-1}\circ\nu_{D}=(\nu_{D'})^{-1}\circ\id_{V}\circ\nu_{D}$
  とかけるので,
  $T$は
  $\id_{V}\colon V\to V$の$D,D'$に関する表現行列である.
\end{remark}

\begin{remark}
  $V$の基底を与えることと同型写像$\varphi\colon \KK^n\to V$を与えること
  は同じことであった.
  $V$の基底$D$, $D'$が与えられたとき, $D'$から$D$への基底の変換行列$T$は
  $\mu_T=(\nu_{D'})^{-1}\circ\nu_{D}$を満たす.
  この条件は,
  $\nu_{D'}\circ\mu_T=\nu_{D}$と書き直すことができる.
  これは,
  基底$D'$を与える同型写像$\nu_{D'}$
  に, $D'$から$D$への基底の変換行列による線形写像$\mu_T$を合成すると,
  基底$D$を与える同型写像$\nu_{D}$が得られることを意味している.
\end{remark}
基底の変換行列の具体的な成分は以下のように計算できる.
\begin{prop}
  \label{thm:trasmat:description}
  $V$を$n$次元$\KK$-線形空間とする.
  $D=(e_1,\ldots, e_n)$,
  $D'=(e'_1,\ldots, e'_n)$を$V$の基底とし,
  $T=(t_{i,j})_{i\in I, j\in I}\in\KK^{n\times n}$を$D'$から$D$への変換行列とする.
  このとき,
  \begin{align*}
    e_j=\sum_{i=1}^n t_{i,j}e'_i.
  \end{align*}
  ただし, $I=\Set{1,\ldots, n} $.
  つまり,
  \begin{align*}
    (e_1,\ldots, e_n)=(e'_1,\ldots, e'_n)T.
  \end{align*}
\end{prop}
\begin{proof}
  $\ttt_j=((\nu_{D'})^{-1}\circ\nu_{D})(\ee^{(n)}_j)$とする.
  このとき,
  \begin{align*}
     \nu_{D'}(\ttt_j)
    &=(\nu_{D'}\circ(\nu_{D'})^{-1}\circ\nu_{D})(\ee^{(n)}_j))\\
    &=(\nu_{D}(v_j)\\
    &=v_j
  \end{align*}
  である.
  一方,
  \begin{align*}
    \ttt_j&=((\nu_{D'})^{-1}\circ\nu_{D})(\ee^{(n)}_j)\\
    &=T\ee^{(n)}_j\\
    &=\sum_{i=1}^n t_{i,j}\ee^{(n)}_j
  \end{align*}
  であるので,
  \begin{align*}
    \nu_{D'}(\ttt_j)
    &=\nu_{D'}(\sum_{i=1}^n t_{i,j}\ee^{(n)}_j)\\
    &=\sum_{i=1}^n t_{i,j}\nu_{D'}(\ee^{(n)}_j)\\
    &=\sum_{i=1}^n t_{i,j}v'_j.
  \end{align*}
\end{proof}

\begin{prop}
  $V$を$n$次元$\KK$-線形空間とする.
  $D=(e_1,\ldots, e_n),D'=(e'_1,\ldots, e'_n)$を$V$の基底とし,
  $T\in\KK^{n\times n}$を$D'$から$D$への変換行列とする.
  $e_j=\sum_{i=1}^n t_{i,j}e'_i$とすると,
  \begin{align*}
    T=(t_{i,j})_{i\in I, j\in I}.
  \end{align*}
  ただし, $I=\Set{1,\ldots, n} $.
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$を$n$次元$\KK$-線形空間とする.
  $D=(e_1,\ldots, e_n),D'=(e'_1,\ldots, e'_n)$を$V$の基底とし,
  $T\in\KK^{n\times n}$を$D'$から$D$への変換行列とする.
  このとき, $T$は正則である.
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$を$n$次元$\KK$-線形空間とする.
  $D'=(e'_1,\ldots, e'_n)$を$V$の基底とする.
  $T=(t_{i,j})_{i\in I, j\in I}$とし,
  $e_j=\sum_{i=1}^n t_{i,j}e'_i$とする.
  $T$が正則なら,
  $D=(e_1,\ldots, e_n)$は$V$の基底であり,
  $D'$から$D$への変換行列は$T$である.
\end{prop}
\begin{proof}\end{proof}


\begin{prop}
  $V$を$n$次元$\KK$-線形空間とする.
  $D=(e_1,\ldots, e_n),D'=(e'_1,\ldots, e'_n)$を$V$の基底とし,
  $T\in\KK^{n\times n}$を$D'$から$D$への変換行列とする.
  このとき, $T^{-1}$は$D$から$D'$への変換行列である.
\end{prop}
\begin{proof}\end{proof}



\begin{prop}
  $V$, $W$を$\KK$-線形空間とする.
  $D, D'$を$V$の基底とする.
  $B, B'$を$V$の基底とする.
  $T$を$D'$から$D$への変換行列とし,
  $F$を$B'$から$B$への変換行列とする.
  $\varphi\colon V\to W$を$\KK$-線形写像とする.
  $A$を$\varphi$の$D$, $B$に関する表現行列とする.
  $A'$を$\varphi'$の$D'$, $B'$に関する表現行列とする.
  このとき,
  $A'=F^{-1}AT$.
\end{prop}
\begin{proof}\end{proof}

\begin{remark}
  $V$, $W$を$\KK$-線形空間とする.
  $D$を$V$の基底,
  $B$を$V$の基底とする.
  $\varphi\colon V\to W$を$\KK$-線形写像とし,
  $A$を$\varphi$の$D$, $B$に関する表現行列とする.
  $D'$を$V$の基底とし,
  $T$を$D'$から$D$への変換行列とするとき,
  $\varphi$の$D'$, $B$に関する表現行列は,
  $AT$である.
  つまり, $V$の基底の取り換えは,
  表現行列の列基本変形に対応する.
  また,
  $B'$を$W$の基底とし,
  $F$を$B$から$B'$への変換行列とするとき,
  $\varphi$の$D$, $B'$に関する表現行列は,
  $FA$である.
  つまり, $W$の基底の取り換えは,
  表現行列の行基本変形に対応する.
\end{remark}


\begin{prop}
  $V$, $W$を$\KK$-線形空間とする.
  $D$を$V$の基底とする.
  $B$を$W$の基底とする.
  $A$を$\varphi$の$D$, $B$に関する表現行列とする.
  このとき,
  \begin{align*}
    \Set{A'|
\begin{array}{c}
\text{$D'$は$V$の基底.}\\
\text{$B'$は$W$の基底.}\\
\text{$\varphi$の基底$D'$, $B'$に関する表現行列.}
\end{array}}
    &=
    \Set{F^{-1}AT|\text{$F^{-1}$,$T$は正則}}.
  \end{align*}
\end{prop}
\begin{proof}\end{proof}


\section{線形変換の表現行列}
\begin{definition}
$V$を$\KK$線形空間とする.
線形写像$\varphi\colon V \to V$
を$V$上の線形変換と呼ぶ.
\end{definition}
$V$上の線形変換とは,
定義域も終域も
$V$であるような線形写像のことである.
このような場合
定義域と終域とで同一の基底をとるのが自然である.
\begin{definition}
$V$を$\KK$-線形空間とする.
  線形変換$\varphi\colon V\to V$
と
$V$の基底$D$
に対し,
$\varphi$の$D$, $D$に関する表現行列を,
$\varphi$の$D$に関する表現行列と呼ぶ.
\end{definition}
\begin{prop}
線形変換$\varphi\colon V\to V$の基底$D$に関する表現行列を$A$とする.
このとき,
\begin{align*}
\underbrace{\varphi\circ\cdots\circ\varphi}_n
\end{align*}
の基底$D$に関する表現行列は$A^n$である.
\end{prop}

\begin{prop}
  $V$を$\KK$-線形空間とする.
  $D, D'$を$V$の基底とする.
  $D$から$D'$への変換行列を$T$とする.
  $A$を$\varphi$の$D$に関する表現行列とする.
  $A'$を$\varphi$の$D'$に関する表現行列とする.
  このとき,
  \begin{align*}
    A'=T^{-1}AT.
  \end{align*}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$を$\KK$-線形空間とする.
  $D$を$V$の基底とする.
  $A$を$\varphi$の$D$に関する表現行列とする.
  このとき,
  \begin{align*}
    \Set{A'|
\begin{array}{c}
\text{$D'$は$V$の基底.}\\
\text{$\varphi$の$D'$に関する表現行列}
\end{array}}
    &=
    \Set{T^{-1}AT|\text{$T$は正則}}.
  \end{align*}
\end{prop}
\begin{proof}\end{proof}


\section{表現行列の例}
\begin{example}
  $V$を$n$次元$\KK$線形空間とし,
  $\lambda \in \KK$に対し,
  \begin{align*}
    \shazo{\varphi}{V}{V}
    {v}{\lambda v}
  \end{align*}
  という$V$上の線形変換を考える.
  このとき, $\varphi$の表現行列は,
  どの基底に対しても,
  $\lambda E_n$となる.
\end{example}

\sectionX{章末問題}
\begin{quiz}
  %\solvelater{quiz:1:1}
\end{quiz}




\chapter{行列式}
\section{交代的多重線形写像}
\begin{definition}
  $(V,\plus,\act)$, $(W,\pplus,\aact)$を$\KK$-線形空間とする.
  以下を満たすとき,
  写像
  \begin{align*}
    F\colon V\times V\times \cdots \times V\to W
  \end{align*}
  は,
  第$i$変数に関して, 
  線形であるという:
  \begin{enumerate}
  \item $v_1,\ldots,v_n,v'_i\in V$に対し
    \begin{align*}
      &F(v_1,\ldots,v_{i-1},v_i\plus v'_i,v_{i+1},\ldots,v_n)\\&=F(v_1,\ldots,v_{i-1},v_i,v_{i+1},\ldots,v_n)\pplus F(v_1,\ldots,v_{i-1},v'_i,v_{i+1},\ldots,v_n).
    \end{align*}
  \item $v_1,\ldots,v_n\in V$, $\alpha\in\KK$に対し,
    \begin{align*}
      F(v_1,\ldots,v_{i-1},\alpha\act v_i,v_{i+1},\ldots,v_n)=\alpha\aact F(v_1,\ldots,v_{i-1},v_i,v_{i+1},\ldots,v_n).
    \end{align*}
  \end{enumerate}
\end{definition}
\begin{remark}
  写像
  \begin{align*}
    F\colon V\times V\times \cdots \times V\to W
  \end{align*}
  に対して,
  $v_1,\ldots,v_{i-1},v_{i+1},\ldots,v_n\in V$
  ごとに,
  \begin{align*}
    \shazo{\varphi_{v_1,\ldots,v_{i-1},v_{i+1},\ldots,v_n}}{V}{W}
    {v}{F(v_1,\ldots,v_{i-1},v,v_{i+1},\ldots,v_n)}
  \end{align*}
  を考えることができる.
  この記号の下, 以下は同値である:
  \begin{enumerate}
  \item $F$が第$i$成分に関して線形.
  \item 任意の$v_1,\ldots,v_{i-1},v_{i+1},\ldots,v_n\in V$
    に対し, $\varphi_{v_1,\ldots,v_{i-1},v_{i+1},\ldots,v_n}$は線形.
  \end{enumerate}
\end{remark}
\begin{cor}
  $(V,\plus,\act,0_V)$, $(W,\pplus,\aact,0_W)$を$\KK$-線形空間とする.
  第$i$成分に関して線形な写像
  \begin{align*}
    F\colon V\times V\times \cdots \times V\to W
  \end{align*}
  に対して次が成り立つ:
  \begin{align*}
  v_i=0_V\implies F(v_1,\ldots,v_n)=0_W.
  \end{align*}
\end{cor}
\begin{definition}
  $V$, $W$を$\KK$-線形空間とする.
  次を満たすとき,
  写像
  \begin{align*}
    F\colon \underbrace{V\times V\times \cdots \times V}_n\to W
  \end{align*}
  は,
  $n$重線形であるという:
  \begin{enumerate}
  \item 任意の$i$に対し, $F$は第$i$変数に関して線形である.
  \end{enumerate}
\end{definition}

\begin{definition}
  $V$, $W$を$\KK$-線形空間とする.
  $i\neq j$とする.
  次を満たすとき,
  写像
  \begin{align*}
    F\colon \underbrace{V\times V\times \cdots \times V}_n\to W
  \end{align*}
  は,
  第$i$変数と第$j$変数に関して
  交代的であるという:
  \begin{enumerate}
      \item $v_i=v_j\implies F(v_1,\ldots,v_n)=0_W$.
  \end{enumerate}
\end{definition}
\begin{prop}
  $V$, $W$を$\KK$-線形空間とし,
  \begin{align*}
    F\colon \underbrace{V\times V\times \cdots \times V}_n\to W
  \end{align*}
  は
  第$i$変数と第$j$変数に関して
  交代的かつ線形であるとする.
  \begin{align*}
    &F(v_1,\ldots,v_{i-1};v_i;v_{i+1},\ldots,v_{j-1};v_j;v_{j+1},\ldots,v_n)\\
    =
    -&
F(v_1,\ldots,v_{i-1};v_j;v_{i+1},\ldots,v_{j-1};v_i;v_{j+1},\ldots,v_n)
  \end{align*}
\end{prop}
\begin{proof}\end{proof}
\begin{definition}
  $V$, $W$を$\KK$-線形空間とする.
  次を満たすとき,
  写像
  \begin{align*}
    F\colon \underbrace{V\times V\times \cdots \times V}_n\to W
  \end{align*}
  は,
  交代的であるという:
  \begin{enumerate}
  \item
    任意の$i<j$に対して第$i$変数と第$j$変数に関して交代的である.
  \end{enumerate}
\end{definition}
変数を入れ替えたときに符号がどうなるかについて考える.
$\Set{1,\ldots,n}$から$\Set{1,\ldots,n}$への全単射$\sigma$を
$\Set{1,\ldots,n}$上の順列と呼ぶ.
数列$[\sigma(1),\sigma(2),\ldots,\sigma(n)]$
は$\Set{1,\ldots,n}$がちょうど一度ずつ現れる数列である.
$S_n$で
$\Set{1,\ldots,n}$上の順列をすべて集めた集合とする.
$\sigma\in S_n$に対し,
\begin{align*}
  \Inv(\sigma)=\Set{(i,j)|i<j,\sigma(i)>\sigma(j)}
\end{align*}
とし,
\begin{align*}
 \sgn(\sigma) =(-1)^{\numof{\Inv(\sigma)}}
\end{align*}
とおく.

\begin{prop}
  $V$, $W$を$\KK$-線形空間とし,
  \begin{align*}
    F\colon \underbrace{V\times V\times \cdots \times V}_n\to W
  \end{align*}
  は
  交代的な$n$重線形写像とする.
  このとき, $v_1,\ldots,v_n\in V$, $\sigma\in S_n$に対し,
  \begin{align*}
    F(v_{\sigma(1)},\ldots,v_{\sigma(n)})
    =
    \sgn(\sigma)\act F(v_1,\ldots,v_n).
  \end{align*}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$, $W$を$\KK$-線形空間とし,
  \begin{align*}
    F\colon \underbrace{V\times V\times \cdots \times V}_n\to W
  \end{align*}
  は
  交代的な$n$重線形写像とする.
  $v_1,\ldots,v_n\in V$に対し,
  \begin{align*}
    u_j= a_{1,j}\act v_1\plus \cdots \plus a_{n,j}\act v_n
  \end{align*}
  とすると,
  \begin{align*}
    F(u_{1},\ldots,u_{n})
    =
    (\sum_{\sigma\in S_n} a_{1,\sigma(1)}\cdots a_{n,\sigma(n)})
    \act F(v_1,\ldots,v_n).
  \end{align*}
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$, $W$を$\KK$-線形空間とし,
  $(e_1,\ldots,e_n)$は$V$の基底であるとする.
  \begin{align*}
    F&\colon \underbrace{V\times V\times \cdots \times V}_n\to W\\
    F'&\colon \underbrace{V\times V\times \cdots \times V}_n\to W
  \end{align*}
  は
  交代的な$n$重線形写像とする.
  このとき,
  \begin{align*}
    F(e_1,\ldots,e_n)=F'(e_1,\ldots,e_n)
    \implies
    F=F'.
  \end{align*}
\end{prop}
\begin{proof}\end{proof}

\begin{example}
  $V$を$\KK$-線形空間とし,
  $B=(e_1,\ldots,e_n)$は$V$の基底であるとする.
  \begin{align*}
    u_j= a_{1,j}\act e_1\plus \cdots \plus a_{n,j}\act e_n
  \end{align*}
  に対して,
  \begin{align*}
    D_B(u_{1},\ldots,u_{n})
    =
    \sum_{\sigma\in S_n} \sgn(\sigma)a_{1,\sigma(1)}\cdots a_{n,\sigma(n)}.
  \end{align*}
  とおくと, $D_B\colon V\times \cdots \times V \to \KK$
  は交代的な$n$重線形写像である.
  とくに,
  \begin{align*}
    D_B(v_{1},\ldots,v_{n})=1
  \end{align*}
  である,
\end{example}

\section{行列式}

\begin{prop}
  \label{thm:universalprop:det}
  $V$を$n$次元$\KK$-線形空間とし,
  $\varphi\colon V \to V$を$\KK$-線形変換とする.
  このとき, 次を満たす$d\in\KK$がただ一つ存在する:
  \begin{enumerate}
  \item $W$が$\KK$-線形空間かつ$F\colon V\times\cdots \times V\to W$が交代的な$n$重線形写像ならば次を満たす:
    \begin{align*}
      v_1,\ldots, v_n \in V\implies F(\varphi(v_1),\ldots,\varphi(v_n))=d \act F(v_1,\ldots,v_n).
    \end{align*}
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{definition}
  $V$を$n$次元$\KK$-線形空間とし,
  $\varphi\colon V \to V$を$\KK$-線形変換とする.
  このとき,
  \Cref{thm:universalprop:det}における定数$d$を$\det(\varphi)$とおく.
\end{definition}

\begin{prop}
  $V$を$n$次元$\KK$-線形空間とする.
  このとき, $\det(\id_V)=1$
\end{prop}
\begin{proof}\end{proof}

\begin{lemma}
  $V$を$n$次元$\KK$-線形空間とし,
  $\varphi\colon V \to V$を$\KK$-線形変換とする.
  このとき,
  $\varphi$は単射でないならば$\det(\varphi)= 0$.
\end{lemma}
\begin{proof}\end{proof}


\begin{prop}
  $V$を$n$次元$\KK$-線形空間とし,
  $\varphi\colon V \to V$,
  $\psi\colon V \to V$,
  を$\KK$-線形変換とする.
  このとき,
  $\det(\psi\circ \varphi)=\det(\psi)\det(\varphi)$. 
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
  $V$を$n$次元$\KK$-線形空間とし,
  $\varphi\colon V \to V$
  を$\KK$-線形変換とする.
  このとき,
  以下は同値:
  \begin{enumerate}
  \item $\det(\varphi)$が逆数を持つ.
  \item $\varphi$は同型写像.
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}
\begin{remark}余因子行列を考えると構成的に示すことができる.\end{remark}


\begin{prop}
  $V$を$n$次元$\KK$-線形空間とし,
  $\varphi\colon V \to V$を$\KK$-線形変換とする.
  $B$を$V$の基底とし,
  $A$を$\varphi$の$B$に関する表現行列とする.
  このとき,
  $\det(\varphi)=\det(A)$. 
\end{prop}
\begin{proof}\end{proof}

\begin{cor}
  $A, P \in \KK^{n\times n}$とする.
  $P$が正則なら
  $\det(A)=\det(P^{-1}AP)$. 
\end{cor}
\begin{proof}\end{proof}


\sectionX{章末問題}
\begin{quiz}
  %\solvelater{quiz:1:1}
\end{quiz}

\chapter{固有空間と固有値}
\section{固有空間}

$V$を$\KK$-線形空間とし,
$\varphi\colon V\to V$を線形変換とする.
このとき, $\lambda\in \KK$
\begin{align*}
  \shazo{\lambda\id_V-\varphi}{V}{V}
  {v}{\lambda v-\varphi(v)}
\end{align*}
は線形変換である.
\begin{definition}
  $V$を$\KK$-線形空間とし,
  $\varphi\colon V\to V$を線形変換とする.
  $\lambda \in \KK$に対し,
  \begin{align*}
    E(\varphi,\lambda) = \Ker(\lambda\id_V-\varphi )
  \end{align*}
  とおく.
  $E(\varphi,\lambda)\neq \Set{0_V}$であるとき,
  \begin{enumerate}
  \item $\lambda$を$\varphi$の固有値と呼ぶ.
  \item $E(\varphi,\lambda)$を固有値$\lambda$に属する$\varphi$の固有空間と呼ぶ.
  \item $v\in E(\varphi,\lambda)\setminus\Set{0_V}$を固有値$\lambda$に属する$\varphi$の固有ベクトルと呼ぶ.
  \end{enumerate}
\end{definition}

\begin{remark}
  $V$を$\KK$-線形空間とし,
  $\varphi\colon V\to V$を線形変換とする.
  $\lambda \in \KK$に対し,
  $E(\varphi,\lambda)$は$V$の部分空間.
\end{remark}

\begin{remark}
  $V$を$\KK$-線形空間とし,
  $\varphi\colon V\to V$を線形変換とする.
  $\lambda \in \KK$に対し,
  \begin{align*}
    E(\varphi,\lambda) &= \Ker( \lambda\id_V - \varphi)\\
    &= \Set{v\in V|(\lambda\id_V-\varphi)(v)=0_V}\\
    &= \Set{v\in V|\lambda v-\varphi(v)  =0_V}\\
    &= \Set{v\in V|\varphi(v) = \lambda v }
  \end{align*}
  である.
  つまり, $v\in V\setminus\Set{0_V}$が
  固有値$\lambda$に属する$\varphi$の固有ベクトルであるというのは
  \begin{align*}
    \varphi(v)=\lambda v
  \end{align*}
  を満たすということである.
  特に, $v\in E(\varphi,\lambda)$に対し, $\varphi(v)\in E(\varphi,\lambda)$
  であるので,
  $E(\varphi,\lambda)$に制限し,
  \begin{align*}
    \shazo{\psi}{E(\varphi,\lambda)}{E(\varphi,\lambda)}
    {v}{\varphi(v)}
  \end{align*}
  を定義できる. 
  このとき, $\psi=\lambda \id_{E(\varphi,\lambda)}$である.
  $\dim_\KK(E(\varphi,\lambda))=l$とし, $B$を
  $E(\varphi,\lambda)$の基底すると,
  $\psi$の
  $B$に関する表現行列は$\lambda E_l$である.
\end{remark}
  

\begin{prop}
  $V$を$\KK$-線形空間とし,
  $\varphi\colon V\to V$を線形変換とする.
  $v_i$を固有値$\lambda_i$に属する$\varphi$の固有ベクトルとする.
  $\lambda_i$は相異なるとする.
  つまり, $i\neq j$ならば$\lambda_i \neq \lambda_j$を満たすとする.
  このとき,
  $(v_1,\ldots, v_l)$は一次独立.
\end{prop}
\begin{proof}\end{proof}

\begin{cor}
  $V$を$\KK$-線形空間とし,
  $\varphi\colon V\to V$を線形変換とする.
  $\lambda_i$を$\varphi$の相異なる固有値とする.
  このとき, 任意の$i$に対し,
  \begin{align*}
    E(\varphi,\lambda_i)\cap(E(\varphi,\lambda_1)+\cdots +E(\varphi,\lambda_{i-1})+E(\varphi,\lambda_i)+\cdots +E(\varphi,\lambda_{l}))=\Set{0_V}.
  \end{align*}
\end{cor}
\begin{proof}\end{proof}

\begin{cor}
  $V$を$\KK$-線形空間とし,
  $\varphi\colon V\to V$を線形変換とする.
  $\lambda_i$を$\varphi$の相異なる固有値とし,
  $U=E(\varphi,\lambda_1)+\cdots +E(\varphi,\lambda_{l})$
  とする.
  このとき, $U$は$U=E(\varphi,\lambda_1)\oplus \cdots \oplus E(\varphi,\lambda_{l})$と内部直和に分解される.
\end{cor}
\begin{proof}\end{proof}

\begin{prop}
  $V$を$\KK$-線形空間とし,
  $\varphi\colon V\to V$を線形変換とする.
  このとき, 以下は同値:
  \begin{enumerate}
  \item $\lambda$は$\varphi$の固有値である.
  \item $\dim_\KK(E(\varphi,\lambda))\geq 1$.
  \item $\varphi-\lambda\id_V$は単射でない.
  \item $\det(\varphi-\lambda\id_V)=0$.    
  \end{enumerate}
\end{prop}

\section{正方行列の固有値}
$A$を$n$次正方行列とし,
$V=\KK^n$とし,
\begin{align*}
  \shazo{\mu_A}{\KK^n}{\KK^n}
  {\xx}{A\xx}
\end{align*}
という線形変換を考え,
この線形変換の固有値や固有空間を$A$の固有値や固有空間と呼ぶ.
つまり, 以下のように定義する:
\begin{definition}
  $A\in\KK^{n\times n}$とする.
  $\lambda \in \KK$に対し,
  \begin{align*}
    E(\varphi,\lambda) = \Set{\xx\in\KK^n|(\lambda E_n-A)\xx=\zzero_n}
  \end{align*}
  とおく.
  $E(\varphi,\lambda)\neq \Set{\zzero_n}$であるとき,
  \begin{enumerate}
  \item $\lambda$を$A$の固有値と呼ぶ.
  \item $E(\varphi,\lambda)$を固有値$\lambda$に属する$A$の固有空間と呼ぶ.
  \item $v\in E(\varphi,\lambda)\setminus\Set{\zzero_n}$を固有値$\lambda$に属する$\varphi$の固有ベクトルと呼ぶ.
  \end{enumerate}
\end{definition}

固有値を求めるには次を利用することが多い:
\begin{prop}
\label{prop:mat:eignevalue:rootofcharpoly}
  $A\in\KK^{n\times n}$とする.
  $\lambda \in \KK$に対し, 以下は同値:
  \begin{enumerate}
  \item $\lambda$は$A$の固有値.
  \item $\det(\lambda E_n-A)=0$.
  \end{enumerate}
\end{prop}

正方行列$A$が与えられたとき,
$\lambda$に関する方程式
\begin{align*}
\det(\lambda E_n-A)=0
\end{align*}
を考えると,
一般に$n$次方程式である.
この方程式を解が求められれば,
その解は
\Cref{prop:mat:eignevalue:rootofcharpoly}
より,
$A$の固有値である.

この方程式には名前がついている.

\begin{definition}
$A\in\KK^{n\times n}$
とする.
$t$に関する$n$次多項式
$\det(t E_n-A)$
を$A$の固有多項式と呼ぶ.
また,
$t$に関する方程式
$\det(t E_n-A)=0$
を$A$の固有方程式と呼ぶ.
\end{definition}
\begin{remark}
$A\in\KK^{n\times n}$
とし, 
$\det(t E_n-A)=c_0+c_1t+\cdots +c_nt^n$
とする.
このとき,
\begin{align*}
c_n&=1,\\
c_{n-1}&=-\tr(A)=\tr(-A)=-(a_{1,1}+a_{2,2}+\cdots+a_{n,n}),\\
c_0&=(-1)^{n}\det(A)=\det(-A).
\end{align*}
\end{remark}

$\lambda$が正方行列$A$の固有値であるとき,
固有値$\lambda$に属する$A$の固有空間
$E(\varphi,\lambda)$は,
\begin{align*}
    E(\varphi,\lambda) = \Set{\xx\in\KK^n|(\lambda E_n-A)\xx=\zzero_n}
\end{align*}
である.
これは,
係数行列が$\lambda E_n-A$である斉次連立一次方程式の解空間そのものである.
この斉次連立一次方程式の解空間は,
$\lambda E_n-A$を行基本変形するなどして求める
(つまり, 基底を与える) ことができる.
%基底を書くことができる.

\sectionX{章末問題}
\begin{quiz}
  %\solvelater{quiz:1:1}
\end{quiz}



\chapter{対角化と直和分解}
\section{線形写像の直和}
$V$, $U$を$\KK$線形空間とし,
$V=V_1\oplus V_2$,
$U=U_1\oplus U_2$と内部直和に分解されているとする.
$\varphi_1\colon V_1\to U_1$,
$\varphi_2\colon V_2\to U_2$
を線形写像とする.
このとき,
$v_1\in V_1$, $v_2\in V_2$
に対し,
$\varphi(v_1+v_2)=\varphi_1(v_1)+\varphi_2(v_2)$
とおくと,
線形写像
$\varphi\colon V\to U$
が定義できる.
この線形写像$\varphi$を$\varphi_1\oplus \varphi_2$と書く.
$D_1=(e_1,\ldots,e_n)$を$V_1$の基底,
$D_2=(e'_1,\ldots,e'_{n'})$を$V_2$の基底,
とすると,
$D=(e_1,\ldots,e_n,e'_1,\ldots,e'_{n'})$は$V$の基底である.
$B_1=(u_1,\ldots,u_m)$を$U_1$の基底,
$B_2=(u'_1,\ldots,u'_{m'})$を$U_2$の基底
とすると,
$B=(u_1,\ldots,u_m,u'_1,\ldots,u'_{m'})$は$U$の基底である.
$\varphi_1$の$D_1$, $B_1$に関する表現行列を$A_1$,
$\varphi_2$の$D_2$, $B_2$に関する表現行列を$A_2$とする.
このとき,
$\varphi_1\oplus \varphi_2$の$D$, $B$に関する表現行列は
\begin{align*}
  \begin{pmatrix}A_1&O_{m,n'}\\O_{m',n}&A_2\end{pmatrix}
\end{align*}
である.

より一般に
$V=V_1\oplus \cdots \oplus V_l$,
$U=U_1\oplus \cdots \oplus U_l$
の様に$l$個の空間に直和分解されているとき,
同様に線形写像$\varphi_i\colon V_i\to U_i$の
直和$\varphi_1\oplus \cdots \oplus \varphi_l$を考えることができる.
各$V_i$や$U_i$の基底を合わせて$V$や$U$の基底を使った基底を考えるとき,
この基底に関する$\varphi_1\oplus \cdots \oplus \varphi_l$の表現行列は,
同様にブロック対角となる.


$\varphi\colon V\to W$を線形写像とする.
\begin{align*}
V&=V_1\oplus \cdots \oplus V_l\\
W&=W_1\oplus \cdots \oplus W_l
\end{align*}
と内部直和に分解されており,
\begin{align*}
v\in V_i\implies \varphi(v) \in W_i
\end{align*}
を満たすとする.
このとき,
\begin{align*}
\shazo{\varphi_i}{V_i}{W_i}
{v}{\varphi(v)}
\end{align*}
とおくと,
\begin{align*}
\varphi=\varphi_1\oplus\cdots\oplus \varphi_l
\end{align*}
となる.
このとき, $V_i$の基底を合わせて得られる$V$の基底$D$と,
$W_i$の基底を合わせてた$W$の基底$B$を考えると,
$\varphi$の$D$, $B$に関する表現行列はブロック対角である.
このとき, $\varphi$は基底$D$, $B$でブロック対角可能であるという.

体$\KK$上の行列$A$は行基本変形と列基本変形を用いることで,
\begin{align*}
\begin{pmatrix}E_r&O\\O&O\end{pmatrix}
\end{align*}
という形に変形できる.
このとき$r=\rank(A)$である.
この形を$A$の階数標準形とか体$\KK$上のスミス標準形と呼ぶことがある.
表現行列に対する列基本変形は定義域の基底の取り換え,
行基本変形は終域の基底の取り換えに対応していたので,
線形写像$\varphi\colon V\to W$に対し,
$V$の基底$D=(e_1,\ldots,e_n)$,
$W$の基底$B=(w_1,\ldots,W_m)$
で,
$\varphi$の$D$, $B$に関する表現行列が,
\begin{align*}
\begin{pmatrix}E_r&O\\O&O\end{pmatrix}
\end{align*}
となるものが取れる.
このとき,
\begin{align*}
V_1&=\Braket{e_1}_\KK,
&&\ldots,&V_r&=\Braket{e_r}_\KK,&
V'&=\Braket{e_{r+1},\ldots,e_{n}}_\KK\\
W_1&=\Braket{w_1}_\KK,
&&\ldots,&W_r&=\Braket{w_r}_\KK,&
W'&=\Braket{w_{r+1},\ldots,w_{n}}_\KK
\end{align*}
とおくと,
$V=V_1\oplus\cdots\oplus V_r\oplus V'$,
$W=W_1\oplus\cdots\oplus W_r\oplus W'$,
であり,
\begin{align*}
\shazo{\varphi_i}{V_i}{W_i}
{ce_i}{cw_i}
&&
\shazo{\varphi'}{V'}{W'}
{v}{0_W}
\end{align*}
とおくと,
$\varphi=\varphi_1\oplus\cdots\oplus\varphi_r\oplus \varphi'$
である.

\section{線形変換の対角化}

\begin{definition}
  $V$を$\KK$線形空間とし,
  $\varphi\colon V\to V$を線形変換とする.
  $B$に関する$\varphi$の表現行列が対角行列となるような$V$の基底$B$が存在するとき,
  $\varphi$は対角化可能であるという.
\end{definition}
\begin{remark}
  どんな線形変換も対角化可能であるわけではない.
\end{remark}

\begin{lemma}
  $V$を$\KK$線形空間とし,
  $\lambda\in\KK$とする.
  線形変換
  \begin{align*}
    \shazo{\varphi}{V}{V}
    {v}{\lambda\act v}
  \end{align*}
  は対角化可能.
\end{lemma}
\begin{proof}\end{proof}

$V$上の線形変換について考える.
$V$を$\KK$線形空間とし,
$V=V_1\oplus \cdots \oplus V_k$と内部直和に分解されているとする.
このとき, 線形変換$\varphi\colon V\to V$が,
\begin{align*}
\Set{\varphi(v)|v\in V_i}\subset V_i
\end{align*}
を満たすならば,
線形変換
\begin{align*}
  \shazo{\varphi_i}{V_i}{V_i}
  {v}{\varphi(v)}
\end{align*}
を定義できる.
定義から, $\varphi=\varphi_1\oplus \cdots \oplus \varphi_k$
である.
したがって, $V_i$の基底を合わせて$V$の基底にしたものを考えると,
$\varphi$のこの基底に関する表現行列はブロック対角となる.
特に$\dim_\KK(V)=n$で, 
$V=V_1\oplus \cdots V_n$と1次元部分空間$V_i$の内部直和に分解されているならば,
$e_i\in V_i\setminus \Set{0_V}$とすると,
$B=(e_1,\ldots,e_n)$は$V$の基底となり,
この基底$B$に関する
$\varphi$の表現行列は対角行列となる.
表現行列が,
\begin{align*}
\begin{pmatrix}\lambda_1&&\\&\ddots&\\&&\lambda_n\end{pmatrix}
\end{align*}
となっているとき, $\varphi(e_i)=\lambda_i\act e_i$となるので,
$e_i$は固有値$\lambda_i$に属する固有ベクトルである.

\begin{lemma}
  $V$を$\KK$線形空間とし,
  $\varphi\colon V\to V$を線形変換とする.
  $\varphi$の固有値$\lambda$に対し,
  線形変換
  \begin{align*}
    \shazo{\varphi}{E(\varphi,\lambda)}{E(\varphi,\lambda)}
    {v}{\varphi(v)}
  \end{align*}
  は対角化可能.
\end{lemma}
\begin{proof}\end{proof}
\begin{prop}
  $V$を有限次元$\KK$線形空間とし,
  $\varphi\colon V\to V$を線形変換とする.
  $\lambda_1,\ldots,\lambda_l$を$\varphi$の相異なる固有値とし,
  $\varphi$の固有値はこれで全てであるとする.
  このとき, 以下は同値:
  \begin{enumerate}
  \item $\varphi$は対角化可能.
  \item $V=E(\varphi,\lambda_1)+\cdots+ E(\varphi,\lambda_l)$.
  \item $V$は$V=E(\varphi,\lambda_1)\oplus\cdots \oplus E(\varphi,\lambda_l)$
    と内部直和に分解される.
  \item $\dim_\KK(V)=\sum_{i=1}^{l} \dim_{\KK}(E(\varphi,\lambda_i))$.
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{cor}
  $V$を$n$次元$\KK$線形空間とし,
  $\varphi\colon V\to V$を線形変換とする.
  $\lambda_1,\ldots,\lambda_n$が$\varphi$の相異なる固有値であるなら,
  $\varphi$は対角化可能.  
\end{cor}

\section{行列の対角化}
$A$を$n$次正方行列とする.
$V=\KK^n$とし, 線形変換
\begin{align*}
  \shazo{\mu_A}{V}{V}
  {\xx}{A\xx}
\end{align*}
を考える.
この線形変換$\mu_A$が対角化可能であるとき,
行列$A$は対角化可能であるという.
$\mu_A$の標準基底に関する表現行列は$A$自身であり,
基底を取り替えることは,
表現行列に対し正則行列$P$で$P^{-1}AP$という操作を行うことであるので,
以下のように定義できる:
\begin{definition}
  次を満たすとき$A\in \KK^{n\times n}$は対角化可能であるという:
  \begin{enumerate}
  \item 次の条件を満たす正則行列$P$と$\lambda_1,\ldots,\lambda_n\in\KK$が存在する:
    \begin{align*}
      P^{-1}AP=
      \begin{pmatrix}\lambda_1&&\\&\ddots&\\&&\lambda_n\end{pmatrix}
    \end{align*}
  \end{enumerate}
\end{definition}
\begin{remark}
  $A$が正則行列$P$と対角行列$D$に対し, $P^{-1}AP=D$となっているとき,
  $A$は$P$によって$D$に対角化されるという.
  また, このような$P$と$D$を求めることを$A$を対角化するということがある.
\end{remark}

\begin{lemma}
  $A,P\in\KK^{n\times n}$が
    \begin{align*}
      P^{-1}AP=
      \begin{pmatrix}\lambda_1&&\\&\ddots&\\&&\lambda_n\end{pmatrix}
    \end{align*}
    を満たしているとき,
    $P(\ee^{(n)}_i)$は固有値$\lambda_i$に属する$A$の固有ベクトルである.
\end{lemma}
\begin{proof}\end{proof}

\begin{lemma}
  $A\in\KK^{n\times n}$とし,
  $v_i$を固有値$\lambda_i$に属する$A$の固有ベクトルとする.
  $P$を$v_i$を並べて得られる$n$次正方行列とする.
  つまり$P=(v_1|\cdots | v_n)$とする.
  $P$が正則ならば
    \begin{align*}
      P^{-1}AP=
      \begin{pmatrix}\lambda_1&&\\&\ddots&\\&&\lambda_n\end{pmatrix}
    \end{align*}
    である.
\end{lemma}
\begin{proof}\end{proof}


\begin{prop}
  $A\in\KK^{n\times n}$とする.
  このとき, 以下は同値:
  \begin{enumerate}
  \item $A$が対角化可能.
  \item
    以下の条件を満たす$\vv_1,\ldots,\vv_n$が存在する.
\begin{enumerate}
\item $(\vv_1,\ldots,\vv_n)$が一次独立
\item  各$v_j$は$A$の固有ベクトル
  \end{enumerate}
  \end{enumerate}
\end{prop}
\begin{proof}\end{proof}

\begin{remark}
具体的に与えられた正方行列を対角化するには,
その固有空間を調べればよい.
\end{remark}

\section{同時対角化}
\begin{definition}
$V$を$\KK$-線形空間とし,
$B$を$V$の基底とする.
$V$上の線形変換
$\varphi\colon V\to V$と$\psi\colon V\to V$の
$B$に関する表現行列がどちらも対角行列であるとき,
$\varphi$と$\psi$は基底$B$によって同時対角化されるという.
\end{definition}

\begin{prop}
$V$を$\KK$-線形空間とし,
線形変換$\varphi\colon V\to V$,
$\psi\colon V\to V$は
どちらも対角可能であるとする.
以下は同値:
\begin{enumerate}
\item $\varphi$と$\psi$は同時対角化可能.
\item $\varphi\circ\psi=\psi\circ\varphi$.
\end{enumerate}
\end{prop}
\begin{proof}\end{proof}


これは, 行列の言葉で言い換えると以下の様になる:
\begin{definition}
$A,B\in\KK^{n\times n}$とする.
$P^{-1}AP$, $P^{-1}BP$がどちらも対角行列となるような
正則行列$P$が存在するとき,
$A$と$B$は$P$により同時対角化されるという.
\end{definition}
\begin{prop}
$A,B\in\KK^{n\times n}$とし,
どちらも対角可能であるとする.
以下は同値:
\begin{enumerate}
\item $A$と$B$は同時対角化可能.
\item $A$と$B$は可換. つまり$AB=BA$.
\end{enumerate}
\end{prop}

\sectionX{章末問題}
\begin{quiz}
  %\solvelater{quiz:1:1}
\end{quiz}

\chapter{上半三角化とケーリーハミルトンの定理}

\section{上半三角化}

\begin{definition}
$V$を$\KK$-線形空間とし,
$\varphi\colon V\to V$を$\KK$-線形変換とする.
$V$の基底$B=(e_1,\ldots,e_n)$が以下の条件を満たすとき,
$\varphi$は$V$によって(上半)三角化されるという:
\begin{enumerate}
\item
$i\in\Set{1,\ldots,n}$に対し,
以下を満たす$a_{i,j}\in\KK$がとれる:
\begin{align*}
\varphi(e_j)=\sum_{i\colon i\leq j }a_{i,j}\act e_i.
\end{align*}
\end{enumerate}
\end{definition}
$\varphi$が$B$によって三角化されるとき,
$B$に関する表現行列は三角行列である.
正方行列$A$に対しても三角化という用語を導入する:
\begin{definition}
$A\in \KK^{n\times n}$とする.
正則行列$P$で$T=P^{-1}AP$が上半三角行列であるとき,
$A$は$P$で$T$に(上半)三角化されるという.
\end{definition}

\begin{prop}
$A\in \KK^{n\times n}$とする.
$\det(tE_n-A)=\prod_{i=1}^n (t-\lambda_i)$
と因数分解できるとき,
$A$は対角成分が$\lambda_1,\ldots,\lambda_n$である三角行列に対角化される.
\end{prop}
\begin{proof}
$n$に関する数学的帰納法で示す.
\paragraph{Base Case}
\paragraph{Induction Step}
\end{proof}


\section{ケーリーハミルトンの定理}

\begin{prop}
\label{prop:chthm}
$A\in \KK^{n\times n}$とし,
$\det(tE_n-A)=a_0t^0+a_1t+a_2t^2\cdots+a_{n-1}t^{n-1}+t^n$
とする.
このとき,
\begin{align*}
a_0E_n+a_1A+a_2A^2+\cdots+a_{n-1}A^{n-1}+A^n=O_{n,n}.
\end{align*}
\end{prop}
\begin{proof}
$\det(tE_n-A)=\prod_{i=1}^n (t-\lambda_i)$
と因数分解できるときのみについて,
ここでは証明する.
\end{proof}
\begin{remark}
例えば,
体として$\RR$を考えている場合には,
$\det(tE_n-A)$は一次式の積には因数分解できないかもしれない.
しかしならが,
$\RR\subset\CC$であり,
体として$\CC$を考えれば,
必ず一次式の積に分解できる.
したがって,
$\RR$の場合でも,
一旦$\CC$で考えることで
この証明が適用でき,
\Cref{prop:chthm}が
成り立つ.
\end{remark}
$a_0t^0+a_1t+a_2t^2\cdots+a_{n-1}t^{n-1}+t^n$
の$t$に$A$を代入したもの, つまり, $t^k$を$A^k$に, $t^0$を$E_n$に置き換えたもの,
$a_0E_n+a_1A+a_2A^2+\cdots+a_{n-1}A^{n-1}+A^n$
は,
多項式が固有多項式であるとき, $O_{n,n}$になる.
同様に$A$を代入すると$O_{n,n}$となる多項式について考える.
\begin{definition}
$A\in\KK^{n\times n}$とする.
以下を満たすとき,
多項式
$a_0t^0+a_1t+a_2t^2\cdots+a_{m}t^{m}$
を$A$の零化多項式と呼ぶ:
\begin{align*}
a_0E_n+a_1A+a_2A^2+\cdots+a_mA^m=O_{n,n}.
\end{align*}
\end{definition}

$\KK$を体とする.
$A\in\KK^{n\times n}$とする.
$I$を$A$の零化多項式をすべて集めた集合とする.
$A$の固有多項式は$I$の元である.
$I$に含まれる$0$ではない多項式の次数のうち最小のものを$d$とおく.
つまり,
$d=\min\Set{ \deg(f) |f \in I\setminus\Set{0}}$.
$A$の固有多項式は$n$次多項式であるから,
$0<d\leq n$である.
$d$次多項式$f$
と
$m$次多項式$g$
がともに, $I$の元とする.
$d$は最小の次数であるから,
$d\leq m$である.
このとき,
$g$を$f$で割ったあまりを考えると,
$g=pf+q$とかけるが,
あまりの定義から$q\neq 0$であれば, $1\leq \deg(q)<\deg(f)=d$
である.
$g=pf+q$の, $pf$を移項すると$g-pf=q$である.
$g,f\in I$であるから, $g,f$に$A$を代入すると$O_{n,n}$である.
したがって,
$g-pf$の$t$に$A$を代入すると$O_{n,n}$になるので,
$g-pf\in I$である.
したがって, $q\in I$である.
$I$に含まれる$0$でない多項式の次数は$d$以上であるから,
$q\neq 0$となることはない.
よって$q=0$である.
つまり, $f$は$g$を割り切る.
さらに, $f$も$g$も$I$の元であり$\deg(f)=\deg(g)=d$であるとすると,
$f$は$g$を割り切り, $g$も$f$を割り切ることから,
$f=cg$を満たす$c\in\KK$がとれる.
したがって,
$I$に含まれる多項式で最高次数係数が$1$であるものはただ一つに定まる.
これを$A$の最小多項式と呼ぶ.

\begin{definition}
$A\in\KK^{n\times n}$とする.
最高次の係数が$1$である$A$の零化多項式のうち, 
次数が最も低いものを,
$A$の最小多項式と呼ぶ.
\end{definition}

\begin{cor}
$A\in\KK^{n\times n}$とする.
$A$の最小多項式は$A$の固有多項式を割り切る.
\end{cor}
\begin{prop}
$A\in\KK^{n\times n}$とし,
$a_0+a_1t+\cdots+a_mt^m$を$A$の零化多項式とする.
$\lambda$が$A$の固有値ならば,
$a_0+a_1\lambda+\cdots+a_m\lambda^m=0$,
\end{prop}
\begin{cor}
$A\in\KK^{n\times n}$とする.
このとき, 以下は同値:
\begin{enumerate}
\item $\lambda$は$A$の固有値.
\item $\lambda$は$A$の固有多項式の根.
(つまり, $\lambda$は$A$の固有方程式の解)
\item $\lambda$は$A$の最小多項式の根.
(つまり, $f(t)$を$A$の最小多項式とすると,
$\lambda$は$t$に関する方程式$f(t)=0$の解.)
\end{enumerate}
\end{cor}

\begin{prop}
$A\in\KK^{n\times n}$とする.
$A$が対角化可能ならば,
$A$の最小多項式は重根を持たない.
\end{prop}
\begin{proof}\end{proof}

\begin{prop}
$A\in\KK^{n\times n}$とする.
$\det(tE_n-A)=(t-\lambda_1)^{n_1}\cdots(t-\lambda_r)^{n_r}$
と因数分解できているとする.
ただし, $\lambda_1,\ldots,\lambda_r\in\KK$は相異なるとする.
$A$の最小多項式が重根を持たない,
つまり,
$A$の最小多項式が
$(t-\lambda_1)\cdots(t-\lambda_r)$に等しいならば,
$A$は対角化可能.
\end{prop}
\begin{proof}\end{proof}
\begin{note}
証明において最大公約数が$1$であることは
それほど重要ではない.
$0$でない定数$a$であれば,
$\sum_{i}f_ig_i=a$
となるものが取れるので,
$v\in V$に対し,
$av=v_1+\cdots$
と書ける.
したがって,
$V'=\set{a v|v\in V}$が内部直和に分解する.
よって,
\begin{align*}
\shazo{\varphi}{V'}{V'}
{v}{Av}
\end{align*}
は対角化可能である.
$V'=\Set{av|v\in V}\simeq \KK^n$であれば,
$n$この基底がとれるので,
$A$自体が対角化可能である.
\end{note}

\sectionX{章末問題}
\begin{quiz}
  %\solvelater{quiz:1:1}
\end{quiz}






\chapter{余談}
\section{内部直和と外部直和}
\begin{prop}
  $U=V\oplus W$とする.
  $v\in V$, $w\in W$ならば,
  $(v,w)$は一次独立.
\end{prop}

\section{無限次元ベクトル空間の基底と多項式環.}

\section{行列の冪と指数関数}
\sectionX{章末問題}
\begin{quiz}
  %\solvelater{quiz:1:1}
\end{quiz}


\chapter{}
\sectionX{章末問題}
\begin{quiz}
  %\solvelater{quiz:1:1}
\end{quiz}


